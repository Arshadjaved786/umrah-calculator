{"ast":null,"code":"// src/services/pdfService.js\n// High-quality single-page A4 PDF exporter using html2canvas + jsPDF.\n// Produces PNG (lossless) image embed and can return Blob instead of auto-save.\nimport jsPDF from\"jspdf\";import html2canvas from\"html2canvas\";/**\r\n * exportPdf\r\n * Renders element to a single A4 page, high quality.\r\n *\r\n * options:\r\n *  - format: 'a4' (default)\r\n *  - unit: 'mm' (default)\r\n *  - orientation: 'portrait'|'landscape' (default 'portrait')\r\n *  - margin: number mm (default 8)\r\n *  - scale: html2canvas scale (default 3) — increase for sharper images (costs memory/time)\r\n *  - backgroundColor: canvas background (default '#ffffff')\r\n *  - imageType: 'png'|'jpeg' (default 'png')\r\n *  - imageQuality: number 0..1 (jpeg only)\r\n *  - skipSave: boolean (if true, don't call pdf.save; return Blob)\r\n *  - returnBlob: boolean (alias for skipSave)\r\n *\r\n * Returns:\r\n *  - If skipSave/returnBlob true => resolves to PDF Blob\r\n *  - Otherwise resolves to true (after saving file)\r\n */export async function exportPdf(element){let fileName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"document.pdf\";let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!element)throw new Error(\"exportPdf: element is required\");const{format=\"a4\",unit=\"mm\",orientation=\"portrait\",margin=8,scale=3,backgroundColor=\"#ffffff\",imageType=\"png\",imageQuality=0.95,skipSave=false,returnBlob=false}=options||{};// Create PDF\nconst pdf=new jsPDF({unit,format,orientation});// Page size in mm\nconst pageWidthMm=pdf.internal.pageSize.getWidth();const pageHeightMm=pdf.internal.pageSize.getHeight();// Render element with html2canvas\nconst canvas=await html2canvas(element,{scale:scale,backgroundColor:backgroundColor,useCORS:true,logging:false,// ⭐⭐ ROOT FIX ⭐⭐\nonclone:clonedDoc=>{// PDF ke liye gradient-text ko normal text bana do\nclonedDoc.querySelectorAll(\".bg-clip-text\").forEach(el=>{el.classList.remove(\"bg-clip-text\",\"text-transparent\");el.style.color=\"#6d28d9\";// purple-700\nel.style.background=\"none\";});}});// Prefer PNG for lossless quality; JPEG only if explicitly requested\nconst outType=(imageType||\"png\").toLowerCase();const mime=outType===\"jpeg\"||outType===\"jpg\"?\"image/jpeg\":\"image/png\";const dataUrl=mime===\"image/png\"?canvas.toDataURL(\"image/png\"):canvas.toDataURL(\"image/jpeg\",imageQuality);const imgWidthPx=canvas.width;const imgHeightPx=canvas.height;// Convert page inner area (minus margins) to px (approx 96 DPI)\nconst innerWidthMm=pageWidthMm-2*margin;const innerHeightMm=pageHeightMm-2*margin;const pageWidthPx=Math.round(innerWidthMm*96/25.4);const pageHeightPx=Math.round(innerHeightMm*96/25.4);// Compute scale to fit entire canvas into one page\nconst finalScale=Math.min(pageWidthPx/imgWidthPx,1);// Calculate final dimensions in mm for pdf.addImage\nconst finalWidthMm=imgWidthPx*finalScale*25.4/96;const finalHeightMm=imgHeightPx*finalScale*25.4/96;// center horizontally, top margin for vertical centering optional (we keep top margin)\nconst x=margin;const y=margin+Math.max(0,(innerHeightMm-finalHeightMm)/6);// small top offset for balance\n// Add image to PDF\n// jsPDF supports 'PNG' and 'JPEG'\npdf.addImage(dataUrl,mime===\"image/png\"?\"PNG\":\"JPEG\",x,y,finalWidthMm,finalHeightMm);// If user requested Blob back (for opening in new tab / print), return Blob\nif(skipSave||returnBlob){// return Blob for further handling\nconst blob=pdf.output(\"blob\");return blob;}// Otherwise save file and return true\npdf.save(fileName);return true;}export default{exportPdf};","map":{"version":3,"names":["jsPDF","html2canvas","exportPdf","element","fileName","arguments","length","undefined","options","Error","format","unit","orientation","margin","scale","backgroundColor","imageType","imageQuality","skipSave","returnBlob","pdf","pageWidthMm","internal","pageSize","getWidth","pageHeightMm","getHeight","canvas","useCORS","logging","onclone","clonedDoc","querySelectorAll","forEach","el","classList","remove","style","color","background","outType","toLowerCase","mime","dataUrl","toDataURL","imgWidthPx","width","imgHeightPx","height","innerWidthMm","innerHeightMm","pageWidthPx","Math","round","pageHeightPx","finalScale","min","finalWidthMm","finalHeightMm","x","y","max","addImage","blob","output","save"],"sources":["C:/Users/Taj Tech/Downloads/umrah-calculator/src/services/pdfService.js"],"sourcesContent":["// src/services/pdfService.js\r\n// High-quality single-page A4 PDF exporter using html2canvas + jsPDF.\r\n// Produces PNG (lossless) image embed and can return Blob instead of auto-save.\r\n\r\nimport jsPDF from \"jspdf\";\r\nimport html2canvas from \"html2canvas\";\r\n\r\n/**\r\n * exportPdf\r\n * Renders element to a single A4 page, high quality.\r\n *\r\n * options:\r\n *  - format: 'a4' (default)\r\n *  - unit: 'mm' (default)\r\n *  - orientation: 'portrait'|'landscape' (default 'portrait')\r\n *  - margin: number mm (default 8)\r\n *  - scale: html2canvas scale (default 3) — increase for sharper images (costs memory/time)\r\n *  - backgroundColor: canvas background (default '#ffffff')\r\n *  - imageType: 'png'|'jpeg' (default 'png')\r\n *  - imageQuality: number 0..1 (jpeg only)\r\n *  - skipSave: boolean (if true, don't call pdf.save; return Blob)\r\n *  - returnBlob: boolean (alias for skipSave)\r\n *\r\n * Returns:\r\n *  - If skipSave/returnBlob true => resolves to PDF Blob\r\n *  - Otherwise resolves to true (after saving file)\r\n */\r\nexport async function exportPdf(\r\n  element,\r\n  fileName = \"document.pdf\",\r\n  options = {}\r\n) {\r\n  if (!element) throw new Error(\"exportPdf: element is required\");\r\n\r\n  const {\r\n    format = \"a4\",\r\n    unit = \"mm\",\r\n    orientation = \"portrait\",\r\n    margin = 8,\r\n    scale = 3,\r\n    backgroundColor = \"#ffffff\",\r\n    imageType = \"png\",\r\n    imageQuality = 0.95,\r\n    skipSave = false,\r\n    returnBlob = false,\r\n  } = options || {};\r\n\r\n  // Create PDF\r\n  const pdf = new jsPDF({ unit, format, orientation });\r\n\r\n  // Page size in mm\r\n  const pageWidthMm = pdf.internal.pageSize.getWidth();\r\n  const pageHeightMm = pdf.internal.pageSize.getHeight();\r\n\r\n  // Render element with html2canvas\r\n  const canvas = await html2canvas(element, {\r\n    scale: scale,\r\n    backgroundColor: backgroundColor,\r\n    useCORS: true,\r\n    logging: false,\r\n\r\n    // ⭐⭐ ROOT FIX ⭐⭐\r\n    onclone: (clonedDoc) => {\r\n      // PDF ke liye gradient-text ko normal text bana do\r\n      clonedDoc.querySelectorAll(\".bg-clip-text\").forEach((el) => {\r\n        el.classList.remove(\"bg-clip-text\", \"text-transparent\");\r\n        el.style.color = \"#6d28d9\"; // purple-700\r\n\r\n        el.style.background = \"none\";\r\n      });\r\n    },\r\n  });\r\n\r\n  // Prefer PNG for lossless quality; JPEG only if explicitly requested\r\n  const outType = (imageType || \"png\").toLowerCase();\r\n  const mime =\r\n    outType === \"jpeg\" || outType === \"jpg\" ? \"image/jpeg\" : \"image/png\";\r\n  const dataUrl =\r\n    mime === \"image/png\"\r\n      ? canvas.toDataURL(\"image/png\")\r\n      : canvas.toDataURL(\"image/jpeg\", imageQuality);\r\n\r\n  const imgWidthPx = canvas.width;\r\n  const imgHeightPx = canvas.height;\r\n\r\n  // Convert page inner area (minus margins) to px (approx 96 DPI)\r\n  const innerWidthMm = pageWidthMm - 2 * margin;\r\n  const innerHeightMm = pageHeightMm - 2 * margin;\r\n  const pageWidthPx = Math.round((innerWidthMm * 96) / 25.4);\r\n  const pageHeightPx = Math.round((innerHeightMm * 96) / 25.4);\r\n\r\n  // Compute scale to fit entire canvas into one page\r\n  const finalScale = Math.min(pageWidthPx / imgWidthPx, 1);\r\n\r\n  // Calculate final dimensions in mm for pdf.addImage\r\n  const finalWidthMm = (imgWidthPx * finalScale * 25.4) / 96;\r\n  const finalHeightMm = (imgHeightPx * finalScale * 25.4) / 96;\r\n\r\n  // center horizontally, top margin for vertical centering optional (we keep top margin)\r\n  const x = margin;\r\n\r\n  const y = margin + Math.max(0, (innerHeightMm - finalHeightMm) / 6); // small top offset for balance\r\n\r\n  // Add image to PDF\r\n  // jsPDF supports 'PNG' and 'JPEG'\r\n  pdf.addImage(\r\n    dataUrl,\r\n    mime === \"image/png\" ? \"PNG\" : \"JPEG\",\r\n    x,\r\n    y,\r\n    finalWidthMm,\r\n    finalHeightMm\r\n  );\r\n\r\n  // If user requested Blob back (for opening in new tab / print), return Blob\r\n  if (skipSave || returnBlob) {\r\n    // return Blob for further handling\r\n    const blob = pdf.output(\"blob\");\r\n    return blob;\r\n  }\r\n\r\n  // Otherwise save file and return true\r\n  pdf.save(fileName);\r\n  return true;\r\n}\r\n\r\nexport default {\r\n  exportPdf,\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}