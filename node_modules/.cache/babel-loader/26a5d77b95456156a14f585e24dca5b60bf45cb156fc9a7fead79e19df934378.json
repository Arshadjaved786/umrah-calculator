{"ast":null,"code":"import _objectSpread from\"C:/Users/Taj Tech/Downloads/umrah-calculator/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/pages/TripPlanner.jsx\nimport React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import{generateItinerary}from\"../utils/dateHelpers\";import TripSummaryCard from\"../components/TripPlanner/TripSummaryCard\";import{adjustStaysManually}from\"../utils/manualAdjuster\";/**\r\n * TripPlanner page (UI)\r\n * - Supports exclude first/last night and shows counted dates in calendar (display).\r\n * - Shows notes about original dates when excluded.\r\n * - Mark weekend nights (Thu + Fri) based on counted nights.\r\n * - Removes Jeddah option from city dropdown.\r\n *\r\n * Important:\r\n * - generateItinerary remains core calculation.\r\n * - This UI builds adjustedResult from core result and toggles, and updates displayed dates.\r\n *//* Safe ISO helpers: avoid timezone shifts by splitting */import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function isoToDate(iso){if(!iso)return null;const parts=String(iso).split(\"-\");const yyyy=Number(parts[0]);const mm=Number(parts[1])-1;const dd=Number(parts[2]);return new Date(yyyy,mm,dd);}function dateToIso(d){if(!d)return\"\";const yyyy=d.getFullYear();const mm=String(d.getMonth()+1).padStart(2,\"0\");const dd=String(d.getDate()).padStart(2,\"0\");return\"\".concat(yyyy,\"-\").concat(mm,\"-\").concat(dd);}function addDaysIso(iso,n){const dt=isoToDate(iso);if(!dt)return iso;const d=new Date(dt.getFullYear(),dt.getMonth(),dt.getDate());d.setDate(d.getDate()+n);return dateToIso(d);}/**\r\n * ðŸ” Recalculate preview stays dates\r\n * based on MANUAL counted days\r\n *\r\n * Live preview ONLY â€” final commit on Accept\r\n */function rebuildPreviewFromManual(adjustedResult,manualStays){var _manualStays$,_next$adjustedStays$;if(!adjustedResult||!manualStays)return adjustedResult;const next=JSON.parse(JSON.stringify(adjustedResult));let cursor=((_manualStays$=manualStays[0])===null||_manualStays$===void 0?void 0:_manualStays$.isoCheckIn)||((_next$adjustedStays$=next.adjustedStays[0])===null||_next$adjustedStays$===void 0?void 0:_next$adjustedStays$.countedCheckInIso);next.adjustedStays.forEach((s,i)=>{const m=manualStays[i];const nights=m.displayDays;s.countedDays=nights;s.countedCheckInIso=cursor;const lastNight=addDaysIso(cursor,nights-1);s.countedLastNightIso=lastNight;cursor=addDaysIso(lastNight,1);});return next;}/**\r\n * ðŸ” Build adjustedSegments from adjustedStays\r\n * So UI dates (check-in / check-out / travel)\r\n * update immediately on manual + / âˆ’\r\n */function rebuildSegmentsFromStays(adjustedResult){if(!adjustedResult||!adjustedResult.adjustedStays)return adjustedResult;const next=JSON.parse(JSON.stringify(adjustedResult));const segments=[];next.adjustedStays.forEach((s,i)=>{// stay segment (FULL SHAPE)\nsegments.push({type:\"stay\",city:s.city,originalDays:s.originalDays,countedDays:s.countedDays,// calendar dates (original)\ncheckIn:s.checkIn,checkOut:s.checkOut,isoCheckIn:s.isoCheckIn,isoCheckOut:s.isoCheckOut,isoLastNight:s.isoLastNight,// counted dates (manual/exclude aware)\ncountedCheckInIso:s.countedCheckInIso,countedLastNightIso:s.countedLastNightIso,countedNights:s.countedNights||[],weekendDates:s.weekendDates||[]});// travel segment\nif(i<next.adjustedStays.length-1){const travelIso=addDaysIso(s.countedLastNightIso,1);segments.push({type:\"travel\",iso:travelIso,date:{iso:travelIso,human:travelIso?(()=>{const d=isoToDate(travelIso);const days=[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"];const mon=d.toLocaleString(\"en-US\",{month:\"short\"});return\"\".concat(String(d.getDate()).padStart(2,\"0\"),\" \").concat(mon,\" (\").concat(days[d.getDay()],\")\");})():\"â€”\"}});}});next.adjustedSegments=segments;return next;}/**\r\n * Build adjusted result for UI:\r\n * - applies excludeArrival/excludeExit\r\n * - computes countedCheckInIso / countedLastNightIso per stay\r\n * - computes weekendDates per stay (Thu+Fri) based on counted nights\r\n */function buildAdjustedResult(result,excludeArrival,excludeExit,markWeekend){if(!result)return null;const segs=JSON.parse(JSON.stringify(result.segments||[]));// stays only\nconst stays=segs.filter(s=>s.type===\"stay\");// create adjusted stays\nconst adjustedStays=stays.map((s,idx)=>{var _s$checkIn,_s$displayDays,_ref,_s$displayDays2,_s$displayDays3;const isoCheckIn=s.isoCheckIn||((_s$checkIn=s.checkIn)===null||_s$checkIn===void 0?void 0:_s$checkIn.iso);const isoLastNight=s.lastNight&&(s.lastNight.iso||s.lastNight)||addDaysIso(isoCheckIn,((_s$displayDays=s.displayDays)!==null&&_s$displayDays!==void 0?_s$displayDays:s.days)-1);let countedDays=Number((_ref=(_s$displayDays2=s.displayDays)!==null&&_s$displayDays2!==void 0?_s$displayDays2:s.days)!==null&&_ref!==void 0?_ref:0);if(excludeArrival&&idx===0){countedDays=Math.max(0,countedDays-1);}if(excludeExit&&idx===stays.length-1){countedDays=Math.max(0,countedDays-1);}const countedCheckInIso=excludeArrival&&idx===0?addDaysIso(isoCheckIn,1):isoCheckIn;const countedLastNightIso=(()=>{if(excludeExit&&idx===stays.length-1){// if exclude last night, move lastNight back one day\nreturn addDaysIso(isoLastNight,-1);}// otherwise count from countedCheckInIso + (countedDays - 1)\nreturn addDaysIso(countedCheckInIso,Math.max(0,countedDays-1));})();// build counted nights array for this stay (every counted night iso)\nconst countedNights=[];if(countedDays>0){let cur=isoToDate(countedCheckInIso);const last=isoToDate(countedLastNightIso);while(cur&&last&&cur<=last){countedNights.push(dateToIso(cur));cur.setDate(cur.getDate()+1);}}// weekend detection (Thu=4, Fri=5)\nconst weekendDates=[];if(markWeekend&&countedNights.length>0){countedNights.forEach(iso=>{const d=isoToDate(iso);const day=d.getDay();if(day===4||day===5)weekendDates.push(iso);});}return _objectSpread(_objectSpread({},s),{},{countedDays,countedCheckInIso,countedLastNightIso,countedNights,weekendDates,originalDays:(_s$displayDays3=s.displayDays)!==null&&_s$displayDays3!==void 0?_s$displayDays3:s.days});});// build adjusted segments (stay + travel) for display\nconst adjustedSegments=[];for(let i=0;i<adjustedStays.length;i++){const s=adjustedStays[i];adjustedSegments.push({type:\"stay\",city:s.city,originalDays:s.originalDays,countedDays:s.countedDays,checkIn:s.checkIn,// original formatted\ncheckOut:s.checkOut,// original formatted (we keep)\nisoCheckIn:s.isoCheckIn,isoCheckOut:s.isoCheckOut,countedCheckInIso:s.countedCheckInIso,countedLastNightIso:s.countedLastNightIso,countedNights:s.countedNights,weekendDates:s.weekendDates});if(i<adjustedStays.length-1){var _s$checkOut;// find corresponding travel seg (fallback to s.checkOut)\nadjustedSegments.push({type:\"travel\",date:s.checkOut,iso:s.isoCheckOut||((_s$checkOut=s.checkOut)===null||_s$checkOut===void 0?void 0:_s$checkOut.iso)});}}// compute per-city totals (based on countedNights)\nlet makkahNights=0,madinahNights=0,countedTotal=0;adjustedStays.forEach(s=>{var _s$countedDays;const d=(_s$countedDays=s.countedDays)!==null&&_s$countedDays!==void 0?_s$countedDays:0;countedTotal+=d;if(s.city===\"makkah\")makkahNights+=d;if(s.city===\"madinah\")madinahNights+=d;});return _objectSpread(_objectSpread({},result),{},{adjustedSegments,adjustedStays,countedTotal,makkahNights,madinahNights});}export default function TripPlanner(){const now=new Date();const localToday=\"\".concat(now.getFullYear(),\"-\").concat(String(now.getMonth()+1).padStart(2,\"0\"),\"-\").concat(String(now.getDate()).padStart(2,\"0\"));// original values (what user inputs)\nconst[originalDeparture,setOriginalDeparture]=useState(localToday);const[originalExitDate,setOriginalExitDate]=useState(\"\");// displayed calendar values (may be adjusted when excludes used)\nconst[displayDeparture,setDisplayDeparture]=useState(localToday);const[displayExit,setDisplayExit]=useState(\"\");const[totalDays,setTotalDays]=useState(15);const[useCustomTotal,setUseCustomTotal]=useState(false);const[customTotal,setCustomTotal]=useState(15);const[useExitDate,setUseExitDate]=useState(false);const[exitDateInput,setExitDateInput]=useState(\"\");const[startCity,setStartCity]=useState(\"makkah\");const[exitCity,setExitCity]=useState(\"makkah\");const[maxMadinah,setMaxMadinah]=useState(false);// NEW UI flags:\nconst[excludeArrival,setExcludeArrival]=useState(false);const[excludeExit,setExcludeExit]=useState(false);const[markWeekend,setMarkWeekend]=useState(false);// Thu+Fri\nconst[result,setResult]=useState(null);const[adjustedResult,setAdjustedResult]=useState(null);const[note,setNote]=useState(\"\");// Manual adjustment state\nconst[manualStays,setManualStays]=useState(null);const[manualFridayWarning,setManualFridayWarning]=useState(false);const[theme,setTheme]=useState(\"bg-teal-600\");const navigate=useNavigate();// normalize helpers: ensure passing YYYY-MM-DD to core\nfunction toLocalIso(val){if(!val)return val;if(/^\\d{4}-\\d{2}-\\d{2}$/.test(val))return val;const d=new Date(val);if(isNaN(d.getTime()))return val;return\"\".concat(d.getFullYear(),\"-\").concat(String(d.getMonth()+1).padStart(2,\"0\"),\"-\").concat(String(d.getDate()).padStart(2,\"0\"));}// When user changes the departure input, keep original and display in sync\nfunction onDepartureChange(v){setOriginalDeparture(v);setDisplayDeparture(v);}function onExitChange(v){setOriginalExitDate(v);setDisplayExit(v);setExitDateInput(v);}// Create itinerary\nfunction onGenerate(e){var _e$preventDefault,_coreLastStay$checkOu;e===null||e===void 0?void 0:(_e$preventDefault=e.preventDefault)===null||_e$preventDefault===void 0?void 0:_e$preventDefault.call(e);setNote(\"\");const opts={departureDate:toLocalIso(originalDeparture),startCity,exitCity,maxMadinah};if(useExitDate&&exitDateInput){opts.exitDate=toLocalIso(exitDateInput);}else if(useCustomTotal){opts.totalDays=Number(customTotal);}else{opts.totalDays=Number(totalDays);}const res=generateItinerary(opts);if(res.error){setNote(res.error);setResult(null);setAdjustedResult(null);return;}setResult(res);// build adjusted result based on UI flags\nconst adj=buildAdjustedResult(res,excludeArrival,excludeExit,markWeekend);setAdjustedResult(adj);// initialize manual stays from adjusted stays\nif(adj!==null&&adj!==void 0&&adj.adjustedStays){setManualStays(adj.adjustedStays.map(s=>{var _ref2,_s$originalDays;return{city:s.city,// âœ… IMPORTANT:\n// Manual system ab COUNTED nights se start karega\ndisplayDays:typeof s.countedDays===\"number\"?s.countedDays:(_ref2=(_s$originalDays=s.originalDays)!==null&&_s$originalDays!==void 0?_s$originalDays:s.displayDays)!==null&&_ref2!==void 0?_ref2:s.days,isoCheckIn:s.countedCheckInIso||s.isoCheckIn,locked:false};}));setManualFridayWarning(false);}// Update displayed calendar values depending on exclude flags:\n// Display departure as countedCheckIn of first stay if excludeArrival, else originalDeparture (or core departure iso)\nconst firstStay=adj&&adj.adjustedStays&&adj.adjustedStays[0]||null;if(firstStay){if(excludeArrival){setDisplayDeparture(firstStay.countedCheckInIso||firstStay.isoCheckIn||originalDeparture);}else{// Use originalDeparture (user-chosen) or normalized core departure\nsetDisplayDeparture(toLocalIso(originalDeparture));}}// Compute original exit iso from core result (last stay lastNight)\nconst coreLastStay=res.segments?res.segments.filter(s=>s.type===\"stay\").slice(-1)[0]:null;// UPDATED: prefer last night as exit date for form\nconst coreExitIso=coreLastStay?coreLastStay.isoLastNight||coreLastStay.isoCheckOutDay||((_coreLastStay$checkOu=coreLastStay.checkOut)===null||_coreLastStay$checkOu===void 0?void 0:_coreLastStay$checkOu.iso)||\"\":\"\";// For displayExit: if excludeExit true -> show countedLastNight of last adjusted stay\nconst lastAdjStay=adj&&adj.adjustedStays&&adj.adjustedStays.slice(-1)[0]||null;if(lastAdjStay){if(excludeExit){setDisplayExit(lastAdjStay.countedLastNightIso||lastAdjStay.isoCheckOut||coreExitIso);}else{// show original exit (from core)\nsetDisplayExit(coreExitIso||toLocalIso(originalExitDate)||\"\");}}else{setDisplayExit(coreExitIso||toLocalIso(originalExitDate)||\"\");}setNote(\"Itinerary generated successfully.\");}// recompute adjusted result and update display when toggles change\nuseEffect(()=>{var _coreLastStay$checkOu2;if(!result)return;const adj=buildAdjustedResult(result,excludeArrival,excludeExit,markWeekend);setAdjustedResult(adj);// update display departure/exit based on current toggles\nconst firstStay=adj&&adj.adjustedStays&&adj.adjustedStays[0]||null;if(firstStay){if(excludeArrival)setDisplayDeparture(firstStay.countedCheckInIso||firstStay.isoCheckIn);else setDisplayDeparture(toLocalIso(originalDeparture));}const lastAdjStay=adj&&adj.adjustedStays&&adj.adjustedStays.slice(-1)[0]||null;const coreLastStay=result.segments?result.segments.filter(s=>s.type===\"stay\").slice(-1)[0]:null;// UPDATED: prefer last night as exit date for form\nconst coreExitIso=coreLastStay?coreLastStay.isoLastNight||coreLastStay.isoCheckOutDay||((_coreLastStay$checkOu2=coreLastStay.checkOut)===null||_coreLastStay$checkOu2===void 0?void 0:_coreLastStay$checkOu2.iso)||\"\":\"\";if(lastAdjStay){if(excludeExit)setDisplayExit(lastAdjStay.countedLastNightIso||lastAdjStay.isoCheckOut||coreExitIso);else setDisplayExit(coreExitIso||toLocalIso(originalExitDate)||\"\");}else{setDisplayExit(coreExitIso||toLocalIso(originalExitDate)||\"\");}// recompute note cleared/updated\n},[excludeArrival,excludeExit,markWeekend,result]);// eslint-disable-line\nfunction onManualAdjust(stayIndex,delta){var _newAdjusted$adjusted;if(!manualStays||!adjustedResult)return;const{stays,fridayWarning,balanceWarning}=adjustStaysManually(manualStays,stayIndex,delta);setManualStays(stays);setManualFridayWarning(fridayWarning);if(balanceWarning)return;// -------------------------------\n// ðŸ” Rebuild adjustedResult dates\n// based on MANUAL counted days\n// -------------------------------\nconst newAdjusted=JSON.parse(JSON.stringify(adjustedResult));let cursor=stays[0].isoCheckIn||((_newAdjusted$adjusted=newAdjusted.adjustedStays[0])===null||_newAdjusted$adjusted===void 0?void 0:_newAdjusted$adjusted.countedCheckInIso);newAdjusted.adjustedStays.forEach((s,i)=>{const manual=stays[i];const nights=manual.displayDays;s.countedDays=nights;s.countedCheckInIso=cursor;// last night = checkin + (nights - 1)\nconst lastNight=addDaysIso(cursor,nights-1);s.countedLastNightIso=lastNight;// âœ… weekend nights ONLY if feature is ON\nlet weekendDates=[];if(markWeekend){let d=isoToDate(s.countedCheckInIso);const end=isoToDate(s.countedLastNightIso);while(d&&end&&d<=end){const day=d.getDay();// Thu=4, Fri=5\nif(day===4||day===5){weekendDates.push(dateToIso(d));}d.setDate(d.getDate()+1);}}s.weekendDates=weekendDates;// next checkin = last night + 1\ncursor=addDaysIso(lastNight,1);});// ðŸ” Live preview: rebuild stays + segments\nconst previewStays=rebuildPreviewFromManual(newAdjusted,stays);const previewFinal=rebuildSegmentsFromStays(previewStays);setAdjustedResult(previewFinal);}// Accept & Send to Hotels (save adjusted values) â€” COMPLETE REPLACEMENT\nfunction onAccept(){try{const toSave=adjustedResult&&adjustedResult.adjustedSegments?_objectSpread(_objectSpread({},adjustedResult),{},{// âœ… FINAL CANONICAL SEGMENTS (SCREEN = SAVE)\nsegments:adjustedResult.adjustedSegments.map(s=>{if(s.type!==\"stay\")return s;const checkInIso=s.countedCheckInIso;const checkOutIso=s.countedLastNightIso?addDaysIso(s.countedLastNightIso,1):s.isoCheckOut;return _objectSpread(_objectSpread({},s),{},{// ðŸ”¥ overwrite auto planner dates\nisoCheckIn:checkInIso,isoCheckOut:checkOutIso,checkIn:_objectSpread(_objectSpread({},s.checkIn||{}),{},{iso:checkInIso}),checkOut:_objectSpread(_objectSpread({},s.checkOut||{}),{},{iso:checkOutIso})});})}):result;if(!toSave){setNote(\"No itinerary to save.\");return;}// Save full plan for reference\nlocalStorage.setItem(\"umrah_last_plan\",JSON.stringify(toSave));// Build staysList from adjustedStays if present, otherwise from segments\nlet staysList=[];if(Array.isArray(toSave.adjustedStays)&&toSave.adjustedStays.length>0){staysList=toSave.adjustedStays;}else if(Array.isArray(toSave.adjustedSegments)&&toSave.adjustedSegments.length>0){staysList=toSave.adjustedSegments.filter(s=>s.type===\"stay\");}else{staysList=(toSave.segments||[]).filter(s=>s.type===\"stay\");}// Aggregate totals across stays (countedDays) for backward-compat total\nconst totalMakkah=staysList.filter(s=>String(s.city).toLowerCase()===\"makkah\").reduce((acc,s)=>{var _ref3,_ref4,_s$countedDays2;return acc+Number((_ref3=(_ref4=(_s$countedDays2=s.countedDays)!==null&&_s$countedDays2!==void 0?_s$countedDays2:s.displayDays)!==null&&_ref4!==void 0?_ref4:s.days)!==null&&_ref3!==void 0?_ref3:0);},0);const totalMadinah=staysList.filter(s=>String(s.city).toLowerCase()===\"madinah\").reduce((acc,s)=>{var _ref5,_ref6,_s$countedDays3;return acc+Number((_ref5=(_ref6=(_s$countedDays3=s.countedDays)!==null&&_s$countedDays3!==void 0?_s$countedDays3:s.displayDays)!==null&&_ref6!==void 0?_ref6:s.days)!==null&&_ref5!==void 0?_ref5:0);},0);// Save backward-compatible overall totals (counted nights)\nlocalStorage.setItem(\"umrah_makkah_nights\",String(totalMakkah));localStorage.setItem(\"umrah_madinah_nights\",String(totalMadinah));// Group stays per city\nconst makkahStays=staysList.filter(s=>String(s.city).toLowerCase()===\"makkah\");const madinahStays=staysList.filter(s=>String(s.city).toLowerCase()===\"madinah\");// Helper: compute totals from an array of stays\nconst computeTotals=arr=>{let totalNights=0;let weekendNights=0;arr.forEach(s=>{var _ref7,_ref8,_s$countedDays4;// prefer countedNights array length if present\nconst t=Array.isArray(s.countedNights)?s.countedNights.length:Number((_ref7=(_ref8=(_s$countedDays4=s.countedDays)!==null&&_s$countedDays4!==void 0?_s$countedDays4:s.displayDays)!==null&&_ref8!==void 0?_ref8:s.days)!==null&&_ref7!==void 0?_ref7:0);const w=Array.isArray(s.weekendDates)?s.weekendDates.length:0;totalNights+=Number(t||0);weekendNights+=Number(w||0);});return{totalNights,weekendNights};};const makkahTotals=computeTotals(makkahStays);const madinahTotals=computeTotals(madinahStays);// Save aggregated values in the shape Manage Hotels expects:\n// - <prefix>_nights  => weeknights (total minus weekend)\n// - <prefix>_weekend_nights => weekend nights\nconst saveAggregated=(prefix,totals)=>{const totalN=totals.totalNights||0;const weekendN=totals.weekendNights||0;const weekN=Math.max(0,totalN-weekendN);localStorage.setItem(\"\".concat(prefix,\"_nights\"),String(weekN));localStorage.setItem(\"\".concat(prefix,\"_weekend_nights\"),String(weekendN));};saveAggregated(\"umrah_makkah\",makkahTotals);saveAggregated(\"umrah_madinah\",madinahTotals);// Also save representative price and weekend price if present (take from first stay that has it)\nconst pickPrice=arr=>{for(let s of arr){if(s.pricePerNight!==undefined&&s.pricePerNight!==\"\")return s.pricePerNight;if(s.countedPrice!==undefined&&s.countedPrice!==\"\")return s.countedPrice;}return null;};const pickWeekendPrice=arr=>{for(let s of arr){if(s.weekendPrice!==undefined&&s.weekendPrice!==\"\")return s.weekendPrice;}return null;};const mPrice=pickPrice(makkahStays);const mWeekendPrice=pickWeekendPrice(makkahStays);if(mPrice!==null)localStorage.setItem(\"umrah_makkah_price\",String(mPrice));if(mWeekendPrice!==null)localStorage.setItem(\"umrah_makkah_weekend_price\",String(mWeekendPrice));const dPrice=pickPrice(madinahStays);const dWeekendPrice=pickWeekendPrice(madinahStays);if(dPrice!==null)localStorage.setItem(\"umrah_madinah_price\",String(dPrice));if(dWeekendPrice!==null)localStorage.setItem(\"umrah_madinah_weekend_price\",String(dWeekendPrice));// Save checkin/checkout ISO for each city (use first stay as representative)\nif(makkahStays.length>0){var _s$checkIn2,_s$checkOut2;const s=makkahStays[0];const isoIn=s.countedCheckInIso||s.isoCheckIn||((_s$checkIn2=s.checkIn)===null||_s$checkIn2===void 0?void 0:_s$checkIn2.iso);const isoOut=s.countedLastNightIso?addDaysIso(s.countedLastNightIso,1):s.isoCheckOut||((_s$checkOut2=s.checkOut)===null||_s$checkOut2===void 0?void 0:_s$checkOut2.iso);if(isoIn)localStorage.setItem(\"umrah_makkah_checkin\",isoIn);if(isoOut)localStorage.setItem(\"umrah_makkah_checkout\",isoOut);}else{// remove stale keys if no stay\nlocalStorage.removeItem(\"umrah_makkah_checkin\");localStorage.removeItem(\"umrah_makkah_checkout\");}if(madinahStays.length>0){var _s$checkIn3,_s$checkOut3;const s=madinahStays[0];const isoIn=s.countedCheckInIso||s.isoCheckIn||((_s$checkIn3=s.checkIn)===null||_s$checkIn3===void 0?void 0:_s$checkIn3.iso);const isoOut=s.countedLastNightIso?addDaysIso(s.countedLastNightIso,1):s.isoCheckOut||((_s$checkOut3=s.checkOut)===null||_s$checkOut3===void 0?void 0:_s$checkOut3.iso);if(isoIn)localStorage.setItem(\"umrah_madinah_checkin\",isoIn);if(isoOut)localStorage.setItem(\"umrah_madinah_checkout\",isoOut);}else{localStorage.removeItem(\"umrah_madinah_checkin\");localStorage.removeItem(\"umrah_madinah_checkout\");}// Navigate back to Umrah Calculator\nnavigate(\"/umrah-calculator\");}catch(err){console.error(\"Save plan failed:\",err);setNote(\"Failed to save plan. LocalStorage may be full.\");}}// Reset display when user manually edits dates\nuseEffect(()=>{// if user edits originalDeparture we want displayDeparture to follow until generate is pressed\nsetDisplayDeparture(originalDeparture);},[originalDeparture]);// eslint-disable-line\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-b from-white to-gray-50 p-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(-1),className:\"inline-flex items-center gap-2 px-4 py-2 mb-4 bg-gray-200 hover:bg-gray-300 rounded-md text-sm\",children:\"\\u2190 Back\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-extrabold bg-gradient-to-r from-teal-600 to-indigo-600 bg-clip-text text-transparent\",children:\"Trip Planner\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-indigo-600 font-medium mt-1\",children:\"Create your complete Makkah + Madinah itinerary\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-sm px-3 py-2 rounded-md text-white bg-gradient-to-r from-indigo-500 to-teal-500 shadow\",children:\"Smart Auto Planner\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded shadow p-6\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:onGenerate,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Departure Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:displayDeparture,onChange:e=>{// when user edits the date manually in input, treat it as changing original\nonDepartureChange(e.target.value);},className:\"mt-1 block w-full border rounded p-2\"}),excludeArrival&&originalDeparture&&originalDeparture!==displayDeparture&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 text-sm bg-gradient-to-r from-red-500 via-red-600 to-rose-600 text-white p-2 rounded\",children:[\"Note: The original check-in date was\",\" \",/*#__PURE__*/_jsx(\"strong\",{children:originalDeparture}),\" \\u2014 the first night was excluded; the current check-in will be counted:\",\" \",/*#__PURE__*/_jsx(\"strong\",{children:displayDeparture})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Preset Days\"}),/*#__PURE__*/_jsxs(\"select\",{value:totalDays,onChange:e=>setTotalDays(e.target.value),disabled:useCustomTotal||useExitDate,className:\"mt-1 block w-full border rounded p-2\",children:[/*#__PURE__*/_jsx(\"option\",{value:15,children:\"15 Days\"}),/*#__PURE__*/_jsx(\"option\",{value:21,children:\"21 Days\"}),/*#__PURE__*/_jsx(\"option\",{value:28,children:\"28 Days\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Custom Total Days\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mt-1 gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:useCustomTotal,onChange:e=>{setUseCustomTotal(e.target.checked);if(e.target.checked)setUseExitDate(false);}}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:1,value:customTotal,onChange:e=>setCustomTotal(e.target.value),disabled:!useCustomTotal,className:\"border rounded p-2 w-full\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Set Exit Date\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mt-1 gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:useExitDate,onChange:e=>{setUseExitDate(e.target.checked);if(e.target.checked)setUseCustomTotal(false);}}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:displayExit||exitDateInput,onChange:e=>{setExitDateInput(e.target.value);onExitChange(e.target.value);},disabled:!useExitDate,className:\"border rounded p-2 w-full\"})]}),excludeExit&&displayExit&&originalExitDate&&displayExit!==originalExitDate&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 text-sm bg-gradient-to-r from-red-500 via-red-600 to-rose-600 text-white p-2 rounded\",children:[\"Note: The original departure date was\",\" \",/*#__PURE__*/_jsx(\"strong\",{children:originalExitDate||displayExit}),\" \\u2014 the last night was counted; Counted last night:\",\" \",/*#__PURE__*/_jsx(\"strong\",{children:displayExit})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Start City\"}),/*#__PURE__*/_jsxs(\"select\",{value:startCity,onChange:e=>setStartCity(e.target.value),className:\"mt-1 block w-full border rounded p-2\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"makkah\",children:\"Makkah\"}),/*#__PURE__*/_jsx(\"option\",{value:\"madinah\",children:\"Madinah\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Exit City\"}),/*#__PURE__*/_jsxs(\"select\",{value:exitCity,onChange:e=>setExitCity(e.target.value),className:\"mt-1 block w-full border rounded p-2\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"makkah\",children:\"Makkah\"}),/*#__PURE__*/_jsx(\"option\",{value:\"madinah\",children:\"Madinah\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Max MED Nights\"}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:maxMadinah,onChange:e=>setMaxMadinah(e.target.checked),className:\"mt-2\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"\\r flex flex-col\\r sm:flex-row\\r sm:items-center\\r gap-2 sm:gap-6\\r text-sm\\r \",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:excludeArrival,onChange:e=>setExcludeArrival(e.target.checked)}),\"Exclude arrival night\"]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:excludeExit,onChange:e=>setExcludeExit(e.target.checked)}),\"Exclude Exit night\"]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:markWeekend,onChange:e=>setMarkWeekend(e.target.checked)}),\"Mark weekend nights\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Theme Color\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mt-2\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setTheme(\"bg-teal-600\"),className:\"w-8 h-8 rounded bg-teal-600 border-2\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setTheme(\"bg-indigo-600\"),className:\"w-8 h-8 rounded bg-indigo-600 border-2\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setTheme(\"bg-rose-500\"),className:\"w-8 h-8 rounded bg-rose-500 border-2\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setTheme(\"bg-amber-500\"),className:\"w-8 h-8 rounded bg-amber-500 border-2\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"px-4 py-2 bg-indigo-600 text-white rounded\",children:\"Generate Itinerary\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setResult(null);setAdjustedResult(null);setNote(\"\");setUseCustomTotal(false);setUseExitDate(false);setOriginalDeparture(localToday);setDisplayDeparture(localToday);setOriginalExitDate(\"\");setDisplayExit(\"\");setExitDateInput(\"\");setExcludeArrival(false);setExcludeExit(false);setMarkWeekend(false);},className:\"px-4 py-2 border rounded\",children:\"Reset\"})]}),note&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-sm bg-yellow-50 p-2 rounded text-gray-700\",children:note})]})}),manualStays&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 bg-white rounded shadow p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-semibold mb-3\",children:\"Manual Days Adjustment\"}),manualStays.map((s,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between border-b py-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"capitalize flex items-center gap-2\",children:[s.city,\" stay \",i+1,manualStays.length===3&&/*#__PURE__*/_jsxs(\"label\",{className:\"text-xs flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:s.locked,onChange:()=>{setManualStays(prev=>prev.map((x,idx)=>idx===i?_objectSpread(_objectSpread({},x),{},{locked:!x.locked}):x));}}),\"Lock\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>onManualAdjust(i,-1),className:\"px-2 py-1 border rounded\",children:\"\\u2212\"}),/*#__PURE__*/_jsx(\"span\",{className:\"w-6 text-center\",children:s.displayDays}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onManualAdjust(i,+1),className:\"px-2 py-1 border rounded\",children:\"+\"})]})]},i)),manualFridayWarning&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 p-2 text-sm rounded bg-red-100 text-red-700\",children:\"\\u26A0\\uFE0F Manual adjustment ki wajah se travel day Friday ban raha hai. Barah-e-karam aik din kam ya zyada karein.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6\",children:result?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(TripSummaryCard,{data:adjustedResult||result,raw:result,excludeArrival:excludeArrival,excludeExit:excludeExit,markWeekend:markWeekend,themeClass:theme,onAccept:()=>onAccept()})})}):/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto p-6 text-center text-gray-600\",children:\"Generate a plan to see results here.\"})})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useNavigate","generateItinerary","TripSummaryCard","adjustStaysManually","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","isoToDate","iso","parts","String","split","yyyy","Number","mm","dd","Date","dateToIso","d","getFullYear","getMonth","padStart","getDate","concat","addDaysIso","n","dt","setDate","rebuildPreviewFromManual","adjustedResult","manualStays","_manualStays$","_next$adjustedStays$","next","JSON","parse","stringify","cursor","isoCheckIn","adjustedStays","countedCheckInIso","forEach","s","i","m","nights","displayDays","countedDays","lastNight","countedLastNightIso","rebuildSegmentsFromStays","segments","push","type","city","originalDays","checkIn","checkOut","isoCheckOut","isoLastNight","countedNights","weekendDates","length","travelIso","date","human","days","mon","toLocaleString","month","getDay","adjustedSegments","buildAdjustedResult","result","excludeArrival","excludeExit","markWeekend","segs","stays","filter","map","idx","_s$checkIn","_s$displayDays","_ref","_s$displayDays2","_s$displayDays3","Math","max","cur","last","day","_objectSpread","_s$checkOut","makkahNights","madinahNights","countedTotal","_s$countedDays","TripPlanner","now","localToday","originalDeparture","setOriginalDeparture","originalExitDate","setOriginalExitDate","displayDeparture","setDisplayDeparture","displayExit","setDisplayExit","totalDays","setTotalDays","useCustomTotal","setUseCustomTotal","customTotal","setCustomTotal","useExitDate","setUseExitDate","exitDateInput","setExitDateInput","startCity","setStartCity","exitCity","setExitCity","maxMadinah","setMaxMadinah","setExcludeArrival","setExcludeExit","setMarkWeekend","setResult","setAdjustedResult","note","setNote","setManualStays","manualFridayWarning","setManualFridayWarning","theme","setTheme","navigate","toLocalIso","val","test","isNaN","getTime","onDepartureChange","v","onExitChange","onGenerate","e","_e$preventDefault","_coreLastStay$checkOu","preventDefault","call","opts","departureDate","exitDate","res","error","adj","_ref2","_s$originalDays","locked","firstStay","coreLastStay","slice","coreExitIso","isoCheckOutDay","lastAdjStay","_coreLastStay$checkOu2","onManualAdjust","stayIndex","delta","_newAdjusted$adjusted","fridayWarning","balanceWarning","newAdjusted","manual","end","previewStays","previewFinal","onAccept","toSave","checkInIso","checkOutIso","localStorage","setItem","staysList","Array","isArray","totalMakkah","toLowerCase","reduce","acc","_ref3","_ref4","_s$countedDays2","totalMadinah","_ref5","_ref6","_s$countedDays3","makkahStays","madinahStays","computeTotals","arr","totalNights","weekendNights","_ref7","_ref8","_s$countedDays4","t","w","makkahTotals","madinahTotals","saveAggregated","prefix","totals","totalN","weekendN","weekN","pickPrice","pricePerNight","undefined","countedPrice","pickWeekendPrice","weekendPrice","mPrice","mWeekendPrice","dPrice","dWeekendPrice","_s$checkIn2","_s$checkOut2","isoIn","isoOut","removeItem","_s$checkIn3","_s$checkOut3","err","console","className","children","onClick","onSubmit","value","onChange","target","disabled","checked","min","prev","x","data","raw","themeClass"],"sources":["C:/Users/Taj Tech/Downloads/umrah-calculator/src/pages/TripPlanner.jsx"],"sourcesContent":["// src/pages/TripPlanner.jsx\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { generateItinerary } from \"../utils/dateHelpers\";\r\nimport TripSummaryCard from \"../components/TripPlanner/TripSummaryCard\";\r\nimport { adjustStaysManually } from \"../utils/manualAdjuster\";\r\n\r\n/**\r\n * TripPlanner page (UI)\r\n * - Supports exclude first/last night and shows counted dates in calendar (display).\r\n * - Shows notes about original dates when excluded.\r\n * - Mark weekend nights (Thu + Fri) based on counted nights.\r\n * - Removes Jeddah option from city dropdown.\r\n *\r\n * Important:\r\n * - generateItinerary remains core calculation.\r\n * - This UI builds adjustedResult from core result and toggles, and updates displayed dates.\r\n */\r\n\r\n/* Safe ISO helpers: avoid timezone shifts by splitting */\r\nfunction isoToDate(iso) {\r\n  if (!iso) return null;\r\n  const parts = String(iso).split(\"-\");\r\n  const yyyy = Number(parts[0]);\r\n  const mm = Number(parts[1]) - 1;\r\n  const dd = Number(parts[2]);\r\n  return new Date(yyyy, mm, dd);\r\n}\r\n\r\nfunction dateToIso(d) {\r\n  if (!d) return \"\";\r\n  const yyyy = d.getFullYear();\r\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n  const dd = String(d.getDate()).padStart(2, \"0\");\r\n  return `${yyyy}-${mm}-${dd}`;\r\n}\r\n\r\nfunction addDaysIso(iso, n) {\r\n  const dt = isoToDate(iso);\r\n  if (!dt) return iso;\r\n  const d = new Date(dt.getFullYear(), dt.getMonth(), dt.getDate());\r\n  d.setDate(d.getDate() + n);\r\n  return dateToIso(d);\r\n}\r\n/**\r\n * ðŸ” Recalculate preview stays dates\r\n * based on MANUAL counted days\r\n *\r\n * Live preview ONLY â€” final commit on Accept\r\n */\r\nfunction rebuildPreviewFromManual(adjustedResult, manualStays) {\r\n  if (!adjustedResult || !manualStays) return adjustedResult;\r\n\r\n  const next = JSON.parse(JSON.stringify(adjustedResult));\r\n\r\n  let cursor =\r\n    manualStays[0]?.isoCheckIn || next.adjustedStays[0]?.countedCheckInIso;\r\n\r\n  next.adjustedStays.forEach((s, i) => {\r\n    const m = manualStays[i];\r\n    const nights = m.displayDays;\r\n\r\n    s.countedDays = nights;\r\n    s.countedCheckInIso = cursor;\r\n\r\n    const lastNight = addDaysIso(cursor, nights - 1);\r\n    s.countedLastNightIso = lastNight;\r\n\r\n    cursor = addDaysIso(lastNight, 1);\r\n  });\r\n\r\n  return next;\r\n}\r\n\r\n/**\r\n * ðŸ” Build adjustedSegments from adjustedStays\r\n * So UI dates (check-in / check-out / travel)\r\n * update immediately on manual + / âˆ’\r\n */\r\nfunction rebuildSegmentsFromStays(adjustedResult) {\r\n  if (!adjustedResult || !adjustedResult.adjustedStays) return adjustedResult;\r\n\r\n  const next = JSON.parse(JSON.stringify(adjustedResult));\r\n  const segments = [];\r\n\r\n  next.adjustedStays.forEach((s, i) => {\r\n    // stay segment (FULL SHAPE)\r\n    segments.push({\r\n      type: \"stay\",\r\n      city: s.city,\r\n\r\n      originalDays: s.originalDays,\r\n      countedDays: s.countedDays,\r\n\r\n      // calendar dates (original)\r\n      checkIn: s.checkIn,\r\n      checkOut: s.checkOut,\r\n\r\n      isoCheckIn: s.isoCheckIn,\r\n      isoCheckOut: s.isoCheckOut,\r\n      isoLastNight: s.isoLastNight,\r\n\r\n      // counted dates (manual/exclude aware)\r\n      countedCheckInIso: s.countedCheckInIso,\r\n      countedLastNightIso: s.countedLastNightIso,\r\n\r\n      countedNights: s.countedNights || [],\r\n      weekendDates: s.weekendDates || [],\r\n    });\r\n\r\n    // travel segment\r\n    if (i < next.adjustedStays.length - 1) {\r\n      const travelIso = addDaysIso(s.countedLastNightIso, 1);\r\n      segments.push({\r\n        type: \"travel\",\r\n        iso: travelIso,\r\n        date: {\r\n          iso: travelIso,\r\n          human: travelIso\r\n            ? (() => {\r\n                const d = isoToDate(travelIso);\r\n                const days = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\r\n                const mon = d.toLocaleString(\"en-US\", { month: \"short\" });\r\n                return `${String(d.getDate()).padStart(2, \"0\")} ${mon} (${\r\n                  days[d.getDay()]\r\n                })`;\r\n              })()\r\n            : \"â€”\",\r\n        },\r\n      });\r\n    }\r\n  });\r\n\r\n  next.adjustedSegments = segments;\r\n  return next;\r\n}\r\n\r\n/**\r\n * Build adjusted result for UI:\r\n * - applies excludeArrival/excludeExit\r\n * - computes countedCheckInIso / countedLastNightIso per stay\r\n * - computes weekendDates per stay (Thu+Fri) based on counted nights\r\n */\r\nfunction buildAdjustedResult(result, excludeArrival, excludeExit, markWeekend) {\r\n  if (!result) return null;\r\n  const segs = JSON.parse(JSON.stringify(result.segments || []));\r\n\r\n  // stays only\r\n  const stays = segs.filter((s) => s.type === \"stay\");\r\n\r\n  // create adjusted stays\r\n  const adjustedStays = stays.map((s, idx) => {\r\n    const isoCheckIn = s.isoCheckIn || s.checkIn?.iso;\r\n    const isoLastNight =\r\n      (s.lastNight && (s.lastNight.iso || s.lastNight)) ||\r\n      addDaysIso(isoCheckIn, (s.displayDays ?? s.days) - 1);\r\n\r\n    let countedDays = Number(s.displayDays ?? s.days ?? 0);\r\n\r\n    if (excludeArrival && idx === 0) {\r\n      countedDays = Math.max(0, countedDays - 1);\r\n    }\r\n    if (excludeExit && idx === stays.length - 1) {\r\n      countedDays = Math.max(0, countedDays - 1);\r\n    }\r\n\r\n    const countedCheckInIso =\r\n      excludeArrival && idx === 0 ? addDaysIso(isoCheckIn, 1) : isoCheckIn;\r\n\r\n    const countedLastNightIso = (() => {\r\n      if (excludeExit && idx === stays.length - 1) {\r\n        // if exclude last night, move lastNight back one day\r\n        return addDaysIso(isoLastNight, -1);\r\n      }\r\n      // otherwise count from countedCheckInIso + (countedDays - 1)\r\n      return addDaysIso(countedCheckInIso, Math.max(0, countedDays - 1));\r\n    })();\r\n\r\n    // build counted nights array for this stay (every counted night iso)\r\n    const countedNights = [];\r\n    if (countedDays > 0) {\r\n      let cur = isoToDate(countedCheckInIso);\r\n      const last = isoToDate(countedLastNightIso);\r\n      while (cur && last && cur <= last) {\r\n        countedNights.push(dateToIso(cur));\r\n        cur.setDate(cur.getDate() + 1);\r\n      }\r\n    }\r\n\r\n    // weekend detection (Thu=4, Fri=5)\r\n    const weekendDates = [];\r\n    if (markWeekend && countedNights.length > 0) {\r\n      countedNights.forEach((iso) => {\r\n        const d = isoToDate(iso);\r\n        const day = d.getDay();\r\n        if (day === 4 || day === 5) weekendDates.push(iso);\r\n      });\r\n    }\r\n\r\n    return {\r\n      ...s,\r\n      countedDays,\r\n      countedCheckInIso,\r\n      countedLastNightIso,\r\n      countedNights,\r\n      weekendDates,\r\n      originalDays: s.displayDays ?? s.days,\r\n    };\r\n  });\r\n\r\n  // build adjusted segments (stay + travel) for display\r\n  const adjustedSegments = [];\r\n  for (let i = 0; i < adjustedStays.length; i++) {\r\n    const s = adjustedStays[i];\r\n    adjustedSegments.push({\r\n      type: \"stay\",\r\n      city: s.city,\r\n      originalDays: s.originalDays,\r\n      countedDays: s.countedDays,\r\n      checkIn: s.checkIn, // original formatted\r\n      checkOut: s.checkOut, // original formatted (we keep)\r\n      isoCheckIn: s.isoCheckIn,\r\n      isoCheckOut: s.isoCheckOut,\r\n      countedCheckInIso: s.countedCheckInIso,\r\n      countedLastNightIso: s.countedLastNightIso,\r\n      countedNights: s.countedNights,\r\n      weekendDates: s.weekendDates,\r\n    });\r\n    if (i < adjustedStays.length - 1) {\r\n      // find corresponding travel seg (fallback to s.checkOut)\r\n      adjustedSegments.push({\r\n        type: \"travel\",\r\n        date: s.checkOut,\r\n        iso: s.isoCheckOut || s.checkOut?.iso,\r\n      });\r\n    }\r\n  }\r\n\r\n  // compute per-city totals (based on countedNights)\r\n  let makkahNights = 0,\r\n    madinahNights = 0,\r\n    countedTotal = 0;\r\n  adjustedStays.forEach((s) => {\r\n    const d = s.countedDays ?? 0;\r\n    countedTotal += d;\r\n    if (s.city === \"makkah\") makkahNights += d;\r\n    if (s.city === \"madinah\") madinahNights += d;\r\n  });\r\n\r\n  return {\r\n    ...result,\r\n    adjustedSegments,\r\n    adjustedStays,\r\n    countedTotal,\r\n    makkahNights,\r\n    madinahNights,\r\n  };\r\n}\r\n\r\nexport default function TripPlanner() {\r\n  const now = new Date();\r\n  const localToday = `${now.getFullYear()}-${String(\r\n    now.getMonth() + 1\r\n  ).padStart(2, \"0\")}-${String(now.getDate()).padStart(2, \"0\")}`;\r\n\r\n  // original values (what user inputs)\r\n  const [originalDeparture, setOriginalDeparture] = useState(localToday);\r\n  const [originalExitDate, setOriginalExitDate] = useState(\"\");\r\n\r\n  // displayed calendar values (may be adjusted when excludes used)\r\n  const [displayDeparture, setDisplayDeparture] = useState(localToday);\r\n  const [displayExit, setDisplayExit] = useState(\"\");\r\n\r\n  const [totalDays, setTotalDays] = useState(15);\r\n  const [useCustomTotal, setUseCustomTotal] = useState(false);\r\n  const [customTotal, setCustomTotal] = useState(15);\r\n  const [useExitDate, setUseExitDate] = useState(false);\r\n  const [exitDateInput, setExitDateInput] = useState(\"\");\r\n\r\n  const [startCity, setStartCity] = useState(\"makkah\");\r\n  const [exitCity, setExitCity] = useState(\"makkah\");\r\n  const [maxMadinah, setMaxMadinah] = useState(false);\r\n\r\n  // NEW UI flags:\r\n  const [excludeArrival, setExcludeArrival] = useState(false);\r\n  const [excludeExit, setExcludeExit] = useState(false);\r\n  const [markWeekend, setMarkWeekend] = useState(false); // Thu+Fri\r\n\r\n  const [result, setResult] = useState(null);\r\n  const [adjustedResult, setAdjustedResult] = useState(null);\r\n  const [note, setNote] = useState(\"\");\r\n  // Manual adjustment state\r\n  const [manualStays, setManualStays] = useState(null);\r\n  const [manualFridayWarning, setManualFridayWarning] = useState(false);\r\n\r\n  const [theme, setTheme] = useState(\"bg-teal-600\");\r\n  const navigate = useNavigate();\r\n\r\n  // normalize helpers: ensure passing YYYY-MM-DD to core\r\n  function toLocalIso(val) {\r\n    if (!val) return val;\r\n    if (/^\\d{4}-\\d{2}-\\d{2}$/.test(val)) return val;\r\n    const d = new Date(val);\r\n    if (isNaN(d.getTime())) return val;\r\n    return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(\r\n      2,\r\n      \"0\"\r\n    )}-${String(d.getDate()).padStart(2, \"0\")}`;\r\n  }\r\n\r\n  // When user changes the departure input, keep original and display in sync\r\n  function onDepartureChange(v) {\r\n    setOriginalDeparture(v);\r\n    setDisplayDeparture(v);\r\n  }\r\n  function onExitChange(v) {\r\n    setOriginalExitDate(v);\r\n    setDisplayExit(v);\r\n    setExitDateInput(v);\r\n  }\r\n\r\n  // Create itinerary\r\n  function onGenerate(e) {\r\n    e?.preventDefault?.();\r\n    setNote(\"\");\r\n\r\n    const opts = {\r\n      departureDate: toLocalIso(originalDeparture),\r\n      startCity,\r\n      exitCity,\r\n      maxMadinah,\r\n    };\r\n\r\n    if (useExitDate && exitDateInput) {\r\n      opts.exitDate = toLocalIso(exitDateInput);\r\n    } else if (useCustomTotal) {\r\n      opts.totalDays = Number(customTotal);\r\n    } else {\r\n      opts.totalDays = Number(totalDays);\r\n    }\r\n\r\n    const res = generateItinerary(opts);\r\n\r\n    if (res.error) {\r\n      setNote(res.error);\r\n      setResult(null);\r\n      setAdjustedResult(null);\r\n      return;\r\n    }\r\n\r\n    setResult(res);\r\n\r\n    // build adjusted result based on UI flags\r\n    const adj = buildAdjustedResult(\r\n      res,\r\n      excludeArrival,\r\n      excludeExit,\r\n      markWeekend\r\n    );\r\n    setAdjustedResult(adj);\r\n    // initialize manual stays from adjusted stays\r\n    if (adj?.adjustedStays) {\r\n      setManualStays(\r\n        adj.adjustedStays.map((s) => ({\r\n          city: s.city,\r\n\r\n          // âœ… IMPORTANT:\r\n          // Manual system ab COUNTED nights se start karega\r\n          displayDays:\r\n            typeof s.countedDays === \"number\"\r\n              ? s.countedDays\r\n              : s.originalDays ?? s.displayDays ?? s.days,\r\n\r\n          isoCheckIn: s.countedCheckInIso || s.isoCheckIn,\r\n          locked: false,\r\n        }))\r\n      );\r\n\r\n      setManualFridayWarning(false);\r\n    }\r\n\r\n    // Update displayed calendar values depending on exclude flags:\r\n    // Display departure as countedCheckIn of first stay if excludeArrival, else originalDeparture (or core departure iso)\r\n    const firstStay =\r\n      (adj && adj.adjustedStays && adj.adjustedStays[0]) || null;\r\n    if (firstStay) {\r\n      if (excludeArrival) {\r\n        setDisplayDeparture(\r\n          firstStay.countedCheckInIso ||\r\n            firstStay.isoCheckIn ||\r\n            originalDeparture\r\n        );\r\n      } else {\r\n        // Use originalDeparture (user-chosen) or normalized core departure\r\n        setDisplayDeparture(toLocalIso(originalDeparture));\r\n      }\r\n    }\r\n\r\n    // Compute original exit iso from core result (last stay lastNight)\r\n    const coreLastStay = res.segments\r\n      ? res.segments.filter((s) => s.type === \"stay\").slice(-1)[0]\r\n      : null;\r\n\r\n    // UPDATED: prefer last night as exit date for form\r\n    const coreExitIso = coreLastStay\r\n      ? coreLastStay.isoLastNight ||\r\n        coreLastStay.isoCheckOutDay ||\r\n        coreLastStay.checkOut?.iso ||\r\n        \"\"\r\n      : \"\";\r\n\r\n    // For displayExit: if excludeExit true -> show countedLastNight of last adjusted stay\r\n    const lastAdjStay =\r\n      (adj && adj.adjustedStays && adj.adjustedStays.slice(-1)[0]) || null;\r\n    if (lastAdjStay) {\r\n      if (excludeExit) {\r\n        setDisplayExit(\r\n          lastAdjStay.countedLastNightIso ||\r\n            lastAdjStay.isoCheckOut ||\r\n            coreExitIso\r\n        );\r\n      } else {\r\n        // show original exit (from core)\r\n        setDisplayExit(coreExitIso || toLocalIso(originalExitDate) || \"\");\r\n      }\r\n    } else {\r\n      setDisplayExit(coreExitIso || toLocalIso(originalExitDate) || \"\");\r\n    }\r\n\r\n    setNote(\"Itinerary generated successfully.\");\r\n  }\r\n\r\n  // recompute adjusted result and update display when toggles change\r\n  useEffect(() => {\r\n    if (!result) return;\r\n    const adj = buildAdjustedResult(\r\n      result,\r\n      excludeArrival,\r\n      excludeExit,\r\n      markWeekend\r\n    );\r\n    setAdjustedResult(adj);\r\n\r\n    // update display departure/exit based on current toggles\r\n    const firstStay =\r\n      (adj && adj.adjustedStays && adj.adjustedStays[0]) || null;\r\n    if (firstStay) {\r\n      if (excludeArrival)\r\n        setDisplayDeparture(\r\n          firstStay.countedCheckInIso || firstStay.isoCheckIn\r\n        );\r\n      else setDisplayDeparture(toLocalIso(originalDeparture));\r\n    }\r\n    const lastAdjStay =\r\n      (adj && adj.adjustedStays && adj.adjustedStays.slice(-1)[0]) || null;\r\n    const coreLastStay = result.segments\r\n      ? result.segments.filter((s) => s.type === \"stay\").slice(-1)[0]\r\n      : null;\r\n\r\n    // UPDATED: prefer last night as exit date for form\r\n    const coreExitIso = coreLastStay\r\n      ? coreLastStay.isoLastNight ||\r\n        coreLastStay.isoCheckOutDay ||\r\n        coreLastStay.checkOut?.iso ||\r\n        \"\"\r\n      : \"\";\r\n\r\n    if (lastAdjStay) {\r\n      if (excludeExit)\r\n        setDisplayExit(\r\n          lastAdjStay.countedLastNightIso ||\r\n            lastAdjStay.isoCheckOut ||\r\n            coreExitIso\r\n        );\r\n      else setDisplayExit(coreExitIso || toLocalIso(originalExitDate) || \"\");\r\n    } else {\r\n      setDisplayExit(coreExitIso || toLocalIso(originalExitDate) || \"\");\r\n    }\r\n    // recompute note cleared/updated\r\n  }, [excludeArrival, excludeExit, markWeekend, result]); // eslint-disable-line\r\n\r\n  function onManualAdjust(stayIndex, delta) {\r\n    if (!manualStays || !adjustedResult) return;\r\n\r\n    const { stays, fridayWarning, balanceWarning } = adjustStaysManually(\r\n      manualStays,\r\n      stayIndex,\r\n      delta\r\n    );\r\n\r\n    setManualStays(stays);\r\n    setManualFridayWarning(fridayWarning);\r\n\r\n    if (balanceWarning) return;\r\n\r\n    // -------------------------------\r\n    // ðŸ” Rebuild adjustedResult dates\r\n    // based on MANUAL counted days\r\n    // -------------------------------\r\n    const newAdjusted = JSON.parse(JSON.stringify(adjustedResult));\r\n\r\n    let cursor =\r\n      stays[0].isoCheckIn || newAdjusted.adjustedStays[0]?.countedCheckInIso;\r\n\r\n    newAdjusted.adjustedStays.forEach((s, i) => {\r\n      const manual = stays[i];\r\n      const nights = manual.displayDays;\r\n\r\n      s.countedDays = nights;\r\n      s.countedCheckInIso = cursor;\r\n\r\n      // last night = checkin + (nights - 1)\r\n      const lastNight = addDaysIso(cursor, nights - 1);\r\n      s.countedLastNightIso = lastNight;\r\n\r\n      // âœ… weekend nights ONLY if feature is ON\r\n      let weekendDates = [];\r\n\r\n      if (markWeekend) {\r\n        let d = isoToDate(s.countedCheckInIso);\r\n        const end = isoToDate(s.countedLastNightIso);\r\n\r\n        while (d && end && d <= end) {\r\n          const day = d.getDay(); // Thu=4, Fri=5\r\n          if (day === 4 || day === 5) {\r\n            weekendDates.push(dateToIso(d));\r\n          }\r\n          d.setDate(d.getDate() + 1);\r\n        }\r\n      }\r\n\r\n      s.weekendDates = weekendDates;\r\n\r\n      // next checkin = last night + 1\r\n      cursor = addDaysIso(lastNight, 1);\r\n    });\r\n\r\n    // ðŸ” Live preview: rebuild stays + segments\r\n    const previewStays = rebuildPreviewFromManual(newAdjusted, stays);\r\n    const previewFinal = rebuildSegmentsFromStays(previewStays);\r\n\r\n    setAdjustedResult(previewFinal);\r\n  }\r\n\r\n  // Accept & Send to Hotels (save adjusted values) â€” COMPLETE REPLACEMENT\r\n\r\n  function onAccept() {\r\n    try {\r\n      const toSave =\r\n        adjustedResult && adjustedResult.adjustedSegments\r\n          ? {\r\n              ...adjustedResult,\r\n\r\n              // âœ… FINAL CANONICAL SEGMENTS (SCREEN = SAVE)\r\n              segments: adjustedResult.adjustedSegments.map((s) => {\r\n                if (s.type !== \"stay\") return s;\r\n\r\n                const checkInIso = s.countedCheckInIso;\r\n                const checkOutIso = s.countedLastNightIso\r\n                  ? addDaysIso(s.countedLastNightIso, 1)\r\n                  : s.isoCheckOut;\r\n\r\n                return {\r\n                  ...s,\r\n\r\n                  // ðŸ”¥ overwrite auto planner dates\r\n                  isoCheckIn: checkInIso,\r\n                  isoCheckOut: checkOutIso,\r\n\r\n                  checkIn: {\r\n                    ...(s.checkIn || {}),\r\n                    iso: checkInIso,\r\n                  },\r\n                  checkOut: {\r\n                    ...(s.checkOut || {}),\r\n                    iso: checkOutIso,\r\n                  },\r\n                };\r\n              }),\r\n            }\r\n          : result;\r\n\r\n      if (!toSave) {\r\n        setNote(\"No itinerary to save.\");\r\n        return;\r\n      }\r\n\r\n      // Save full plan for reference\r\n      localStorage.setItem(\"umrah_last_plan\", JSON.stringify(toSave));\r\n\r\n      // Build staysList from adjustedStays if present, otherwise from segments\r\n      let staysList = [];\r\n\r\n      if (\r\n        Array.isArray(toSave.adjustedStays) &&\r\n        toSave.adjustedStays.length > 0\r\n      ) {\r\n        staysList = toSave.adjustedStays;\r\n      } else if (\r\n        Array.isArray(toSave.adjustedSegments) &&\r\n        toSave.adjustedSegments.length > 0\r\n      ) {\r\n        staysList = toSave.adjustedSegments.filter((s) => s.type === \"stay\");\r\n      } else {\r\n        staysList = (toSave.segments || []).filter((s) => s.type === \"stay\");\r\n      }\r\n\r\n      // Aggregate totals across stays (countedDays) for backward-compat total\r\n      const totalMakkah = staysList\r\n        .filter((s) => String(s.city).toLowerCase() === \"makkah\")\r\n        .reduce(\r\n          (acc, s) =>\r\n            acc + Number(s.countedDays ?? s.displayDays ?? s.days ?? 0),\r\n          0\r\n        );\r\n\r\n      const totalMadinah = staysList\r\n        .filter((s) => String(s.city).toLowerCase() === \"madinah\")\r\n        .reduce(\r\n          (acc, s) =>\r\n            acc + Number(s.countedDays ?? s.displayDays ?? s.days ?? 0),\r\n          0\r\n        );\r\n\r\n      // Save backward-compatible overall totals (counted nights)\r\n      localStorage.setItem(\"umrah_makkah_nights\", String(totalMakkah));\r\n      localStorage.setItem(\"umrah_madinah_nights\", String(totalMadinah));\r\n\r\n      // Group stays per city\r\n      const makkahStays = staysList.filter(\r\n        (s) => String(s.city).toLowerCase() === \"makkah\"\r\n      );\r\n      const madinahStays = staysList.filter(\r\n        (s) => String(s.city).toLowerCase() === \"madinah\"\r\n      );\r\n\r\n      // Helper: compute totals from an array of stays\r\n      const computeTotals = (arr) => {\r\n        let totalNights = 0;\r\n        let weekendNights = 0;\r\n        arr.forEach((s) => {\r\n          // prefer countedNights array length if present\r\n          const t = Array.isArray(s.countedNights)\r\n            ? s.countedNights.length\r\n            : Number(s.countedDays ?? s.displayDays ?? s.days ?? 0);\r\n          const w = Array.isArray(s.weekendDates) ? s.weekendDates.length : 0;\r\n          totalNights += Number(t || 0);\r\n          weekendNights += Number(w || 0);\r\n        });\r\n        return { totalNights, weekendNights };\r\n      };\r\n\r\n      const makkahTotals = computeTotals(makkahStays);\r\n      const madinahTotals = computeTotals(madinahStays);\r\n\r\n      // Save aggregated values in the shape Manage Hotels expects:\r\n      // - <prefix>_nights  => weeknights (total minus weekend)\r\n      // - <prefix>_weekend_nights => weekend nights\r\n      const saveAggregated = (prefix, totals) => {\r\n        const totalN = totals.totalNights || 0;\r\n        const weekendN = totals.weekendNights || 0;\r\n        const weekN = Math.max(0, totalN - weekendN);\r\n\r\n        localStorage.setItem(`${prefix}_nights`, String(weekN));\r\n        localStorage.setItem(`${prefix}_weekend_nights`, String(weekendN));\r\n      };\r\n\r\n      saveAggregated(\"umrah_makkah\", makkahTotals);\r\n      saveAggregated(\"umrah_madinah\", madinahTotals);\r\n\r\n      // Also save representative price and weekend price if present (take from first stay that has it)\r\n      const pickPrice = (arr) => {\r\n        for (let s of arr) {\r\n          if (s.pricePerNight !== undefined && s.pricePerNight !== \"\")\r\n            return s.pricePerNight;\r\n          if (s.countedPrice !== undefined && s.countedPrice !== \"\")\r\n            return s.countedPrice;\r\n        }\r\n        return null;\r\n      };\r\n      const pickWeekendPrice = (arr) => {\r\n        for (let s of arr) {\r\n          if (s.weekendPrice !== undefined && s.weekendPrice !== \"\")\r\n            return s.weekendPrice;\r\n        }\r\n        return null;\r\n      };\r\n\r\n      const mPrice = pickPrice(makkahStays);\r\n      const mWeekendPrice = pickWeekendPrice(makkahStays);\r\n      if (mPrice !== null)\r\n        localStorage.setItem(\"umrah_makkah_price\", String(mPrice));\r\n      if (mWeekendPrice !== null)\r\n        localStorage.setItem(\r\n          \"umrah_makkah_weekend_price\",\r\n          String(mWeekendPrice)\r\n        );\r\n\r\n      const dPrice = pickPrice(madinahStays);\r\n      const dWeekendPrice = pickWeekendPrice(madinahStays);\r\n      if (dPrice !== null)\r\n        localStorage.setItem(\"umrah_madinah_price\", String(dPrice));\r\n      if (dWeekendPrice !== null)\r\n        localStorage.setItem(\r\n          \"umrah_madinah_weekend_price\",\r\n          String(dWeekendPrice)\r\n        );\r\n\r\n      // Save checkin/checkout ISO for each city (use first stay as representative)\r\n      if (makkahStays.length > 0) {\r\n        const s = makkahStays[0];\r\n        const isoIn = s.countedCheckInIso || s.isoCheckIn || s.checkIn?.iso;\r\n        const isoOut = s.countedLastNightIso\r\n          ? addDaysIso(s.countedLastNightIso, 1)\r\n          : s.isoCheckOut || s.checkOut?.iso;\r\n        if (isoIn) localStorage.setItem(\"umrah_makkah_checkin\", isoIn);\r\n        if (isoOut) localStorage.setItem(\"umrah_makkah_checkout\", isoOut);\r\n      } else {\r\n        // remove stale keys if no stay\r\n        localStorage.removeItem(\"umrah_makkah_checkin\");\r\n        localStorage.removeItem(\"umrah_makkah_checkout\");\r\n      }\r\n\r\n      if (madinahStays.length > 0) {\r\n        const s = madinahStays[0];\r\n        const isoIn = s.countedCheckInIso || s.isoCheckIn || s.checkIn?.iso;\r\n        const isoOut = s.countedLastNightIso\r\n          ? addDaysIso(s.countedLastNightIso, 1)\r\n          : s.isoCheckOut || s.checkOut?.iso;\r\n        if (isoIn) localStorage.setItem(\"umrah_madinah_checkin\", isoIn);\r\n        if (isoOut) localStorage.setItem(\"umrah_madinah_checkout\", isoOut);\r\n      } else {\r\n        localStorage.removeItem(\"umrah_madinah_checkin\");\r\n        localStorage.removeItem(\"umrah_madinah_checkout\");\r\n      }\r\n\r\n      // Navigate back to Umrah Calculator\r\n      navigate(\"/umrah-calculator\");\r\n    } catch (err) {\r\n      console.error(\"Save plan failed:\", err);\r\n      setNote(\"Failed to save plan. LocalStorage may be full.\");\r\n    }\r\n  }\r\n\r\n  // Reset display when user manually edits dates\r\n  useEffect(() => {\r\n    // if user edits originalDeparture we want displayDeparture to follow until generate is pressed\r\n    setDisplayDeparture(originalDeparture);\r\n  }, [originalDeparture]); // eslint-disable-line\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-b from-white to-gray-50 p-6\">\r\n      {/* Back Button */}\r\n      <button\r\n        onClick={() => navigate(-1)}\r\n        className=\"inline-flex items-center gap-2 px-4 py-2 mb-4 bg-gray-200 hover:bg-gray-300 rounded-md text-sm\"\r\n      >\r\n        â† Back\r\n      </button>\r\n\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        {/* Page header */}\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div>\r\n            <h1 className=\"text-3xl font-extrabold bg-gradient-to-r from-teal-600 to-indigo-600 bg-clip-text text-transparent\">\r\n              Trip Planner\r\n            </h1>\r\n            <p className=\"text-sm text-indigo-600 font-medium mt-1\">\r\n              Create your complete Makkah + Madinah itinerary\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"text-sm px-3 py-2 rounded-md text-white bg-gradient-to-r from-indigo-500 to-teal-500 shadow\">\r\n              Smart Auto Planner\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Form Card */}\r\n        <div className=\"bg-white rounded shadow p-6\">\r\n          <form onSubmit={onGenerate} className=\"space-y-4\">\r\n            {/* Departure Date (original vs displayed) */}\r\n            <div>\r\n              <label className=\"block text-sm font-semibold text-gray-700\">\r\n                Departure Date\r\n              </label>\r\n              <input\r\n                type=\"date\"\r\n                value={displayDeparture}\r\n                onChange={(e) => {\r\n                  // when user edits the date manually in input, treat it as changing original\r\n                  onDepartureChange(e.target.value);\r\n                }}\r\n                className=\"mt-1 block w-full border rounded p-2\"\r\n              />\r\n              {/* Note area: show original if different and excluded */}\r\n              {excludeArrival &&\r\n                originalDeparture &&\r\n                originalDeparture !== displayDeparture && (\r\n                  <div className=\"mt-1 text-sm bg-gradient-to-r from-red-500 via-red-600 to-rose-600 text-white p-2 rounded\">\r\n                    Note: The original check-in date was{\" \"}\r\n                    <strong>{originalDeparture}</strong> â€” the first night was\r\n                    excluded; the current check-in will be counted:{\" \"}\r\n                    <strong>{displayDeparture}</strong>\r\n                  </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Days Options */}\r\n            <div className=\"grid grid-cols-3 gap-3\">\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700\">\r\n                  Preset Days\r\n                </label>\r\n                <select\r\n                  value={totalDays}\r\n                  onChange={(e) => setTotalDays(e.target.value)}\r\n                  disabled={useCustomTotal || useExitDate}\r\n                  className=\"mt-1 block w-full border rounded p-2\"\r\n                >\r\n                  <option value={15}>15 Days</option>\r\n                  <option value={21}>21 Days</option>\r\n                  <option value={28}>28 Days</option>\r\n                </select>\r\n              </div>\r\n\r\n              {/* Custom Days */}\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700\">\r\n                  Custom Total Days\r\n                </label>\r\n                <div className=\"flex items-center mt-1 gap-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={useCustomTotal}\r\n                    onChange={(e) => {\r\n                      setUseCustomTotal(e.target.checked);\r\n                      if (e.target.checked) setUseExitDate(false);\r\n                    }}\r\n                  />\r\n                  <input\r\n                    type=\"number\"\r\n                    min={1}\r\n                    value={customTotal}\r\n                    onChange={(e) => setCustomTotal(e.target.value)}\r\n                    disabled={!useCustomTotal}\r\n                    className=\"border rounded p-2 w-full\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Exit Date */}\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700\">\r\n                  Set Exit Date\r\n                </label>\r\n                <div className=\"flex items-center mt-1 gap-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={useExitDate}\r\n                    onChange={(e) => {\r\n                      setUseExitDate(e.target.checked);\r\n                      if (e.target.checked) setUseCustomTotal(false);\r\n                    }}\r\n                  />\r\n                  <input\r\n                    type=\"date\"\r\n                    value={displayExit || exitDateInput}\r\n                    onChange={(e) => {\r\n                      setExitDateInput(e.target.value);\r\n                      onExitChange(e.target.value);\r\n                    }}\r\n                    disabled={!useExitDate}\r\n                    className=\"border rounded p-2 w-full\"\r\n                  />\r\n                </div>\r\n\r\n                {excludeExit &&\r\n                  displayExit &&\r\n                  originalExitDate &&\r\n                  displayExit !== originalExitDate && (\r\n                    <div className=\"mt-1 text-sm bg-gradient-to-r from-red-500 via-red-600 to-rose-600 text-white p-2 rounded\">\r\n                      Note: The original departure date was{\" \"}\r\n                      <strong>{originalExitDate || displayExit}</strong> â€” the\r\n                      last night was counted; Counted last night:{\" \"}\r\n                      <strong>{displayExit}</strong>\r\n                    </div>\r\n                  )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Cities */}\r\n            <div className=\"grid grid-cols-3 gap-3\">\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700\">\r\n                  Start City\r\n                </label>\r\n                <select\r\n                  value={startCity}\r\n                  onChange={(e) => setStartCity(e.target.value)}\r\n                  className=\"mt-1 block w-full border rounded p-2\"\r\n                >\r\n                  <option value=\"makkah\">Makkah</option>\r\n                  <option value=\"madinah\">Madinah</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700\">\r\n                  Exit City\r\n                </label>\r\n                <select\r\n                  value={exitCity}\r\n                  onChange={(e) => setExitCity(e.target.value)}\r\n                  className=\"mt-1 block w-full border rounded p-2\"\r\n                >\r\n                  <option value=\"makkah\">Makkah</option>\r\n                  <option value=\"madinah\">Madinah</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700\">\r\n                  Max MED Nights\r\n                </label>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={maxMadinah}\r\n                  onChange={(e) => setMaxMadinah(e.target.checked)}\r\n                  className=\"mt-2\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* NEW UI: exclude arrival/exit and weekend */}\r\n            <div\r\n              className=\"\r\n    flex flex-col\r\n    sm:flex-row\r\n    sm:items-center\r\n    gap-2 sm:gap-6\r\n    text-sm\r\n  \"\r\n            >\r\n              <label className=\"flex items-center gap-2\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={excludeArrival}\r\n                  onChange={(e) => setExcludeArrival(e.target.checked)}\r\n                />\r\n                Exclude arrival night\r\n              </label>\r\n\r\n              <label className=\"flex items-center gap-2\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={excludeExit}\r\n                  onChange={(e) => setExcludeExit(e.target.checked)}\r\n                />\r\n                Exclude Exit night\r\n              </label>\r\n\r\n              <label className=\"flex items-center gap-2\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={markWeekend}\r\n                  onChange={(e) => setMarkWeekend(e.target.checked)}\r\n                />\r\n                Mark weekend nights\r\n              </label>\r\n            </div>\r\n\r\n            {/* Theme */}\r\n            <div>\r\n              <label className=\"block text-sm font-semibold text-gray-700\">\r\n                Theme Color\r\n              </label>\r\n              <div className=\"flex items-center gap-2 mt-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setTheme(\"bg-teal-600\")}\r\n                  className=\"w-8 h-8 rounded bg-teal-600 border-2\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setTheme(\"bg-indigo-600\")}\r\n                  className=\"w-8 h-8 rounded bg-indigo-600 border-2\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setTheme(\"bg-rose-500\")}\r\n                  className=\"w-8 h-8 rounded bg-rose-500 border-2\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setTheme(\"bg-amber-500\")}\r\n                  className=\"w-8 h-8 rounded bg-amber-500 border-2\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Buttons */}\r\n            <div className=\"flex space-x-3\">\r\n              <button\r\n                type=\"submit\"\r\n                className=\"px-4 py-2 bg-indigo-600 text-white rounded\"\r\n              >\r\n                Generate Itinerary\r\n              </button>\r\n\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  setResult(null);\r\n                  setAdjustedResult(null);\r\n                  setNote(\"\");\r\n                  setUseCustomTotal(false);\r\n                  setUseExitDate(false);\r\n                  setOriginalDeparture(localToday);\r\n                  setDisplayDeparture(localToday);\r\n                  setOriginalExitDate(\"\");\r\n                  setDisplayExit(\"\");\r\n                  setExitDateInput(\"\");\r\n                  setExcludeArrival(false);\r\n                  setExcludeExit(false);\r\n                  setMarkWeekend(false);\r\n                }}\r\n                className=\"px-4 py-2 border rounded\"\r\n              >\r\n                Reset\r\n              </button>\r\n            </div>\r\n\r\n            {note && (\r\n              <div className=\"mt-2 text-sm bg-yellow-50 p-2 rounded text-gray-700\">\r\n                {note}\r\n              </div>\r\n            )}\r\n          </form>\r\n        </div>\r\n        {manualStays && (\r\n          <div className=\"mb-4 bg-white rounded shadow p-4\">\r\n            <h3 className=\"text-sm font-semibold mb-3\">\r\n              Manual Days Adjustment\r\n            </h3>\r\n\r\n            {manualStays.map((s, i) => (\r\n              <div\r\n                key={i}\r\n                className=\"flex items-center justify-between border-b py-2\"\r\n              >\r\n                <div className=\"capitalize flex items-center gap-2\">\r\n                  {s.city} stay {i + 1}\r\n                  {manualStays.length === 3 && (\r\n                    <label className=\"text-xs flex items-center gap-1\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={s.locked}\r\n                        onChange={() => {\r\n                          setManualStays((prev) =>\r\n                            prev.map((x, idx) =>\r\n                              idx === i ? { ...x, locked: !x.locked } : x\r\n                            )\r\n                          );\r\n                        }}\r\n                      />\r\n                      Lock\r\n                    </label>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-3\">\r\n                  <button\r\n                    onClick={() => onManualAdjust(i, -1)}\r\n                    className=\"px-2 py-1 border rounded\"\r\n                  >\r\n                    âˆ’\r\n                  </button>\r\n                  <span className=\"w-6 text-center\">{s.displayDays}</span>\r\n                  <button\r\n                    onClick={() => onManualAdjust(i, +1)}\r\n                    className=\"px-2 py-1 border rounded\"\r\n                  >\r\n                    +\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n\r\n            {manualFridayWarning && (\r\n              <div className=\"mt-3 p-2 text-sm rounded bg-red-100 text-red-700\">\r\n                âš ï¸ Manual adjustment ki wajah se travel day Friday ban raha hai.\r\n                Barah-e-karam aik din kam ya zyada karein.\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Results */}\r\n        <div className=\"mt-6\">\r\n          {result ? (\r\n            <>\r\n              <div className=\"mb-4\">\r\n                <TripSummaryCard\r\n                  data={adjustedResult || result}\r\n                  raw={result}\r\n                  excludeArrival={excludeArrival}\r\n                  excludeExit={excludeExit}\r\n                  markWeekend={markWeekend}\r\n                  themeClass={theme}\r\n                  onAccept={() => onAccept()}\r\n                />\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <div className=\"max-w-4xl mx-auto p-6 text-center text-gray-600\">\r\n              Generate a plan to see results here.\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"iIAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,iBAAiB,KAAQ,sBAAsB,CACxD,MAAO,CAAAC,eAAe,KAAM,2CAA2C,CACvE,OAASC,mBAAmB,KAAQ,yBAAyB,CAE7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAEA,iEAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBACA,QAAS,CAAAC,SAASA,CAACC,GAAG,CAAE,CACtB,GAAI,CAACA,GAAG,CAAE,MAAO,KAAI,CACrB,KAAM,CAAAC,KAAK,CAAGC,MAAM,CAACF,GAAG,CAAC,CAACG,KAAK,CAAC,GAAG,CAAC,CACpC,KAAM,CAAAC,IAAI,CAAGC,MAAM,CAACJ,KAAK,CAAC,CAAC,CAAC,CAAC,CAC7B,KAAM,CAAAK,EAAE,CAAGD,MAAM,CAACJ,KAAK,CAAC,CAAC,CAAC,CAAC,CAAG,CAAC,CAC/B,KAAM,CAAAM,EAAE,CAAGF,MAAM,CAACJ,KAAK,CAAC,CAAC,CAAC,CAAC,CAC3B,MAAO,IAAI,CAAAO,IAAI,CAACJ,IAAI,CAAEE,EAAE,CAAEC,EAAE,CAAC,CAC/B,CAEA,QAAS,CAAAE,SAASA,CAACC,CAAC,CAAE,CACpB,GAAI,CAACA,CAAC,CAAE,MAAO,EAAE,CACjB,KAAM,CAAAN,IAAI,CAAGM,CAAC,CAACC,WAAW,CAAC,CAAC,CAC5B,KAAM,CAAAL,EAAE,CAAGJ,MAAM,CAACQ,CAAC,CAACE,QAAQ,CAAC,CAAC,CAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,CACpD,KAAM,CAAAN,EAAE,CAAGL,MAAM,CAACQ,CAAC,CAACI,OAAO,CAAC,CAAC,CAAC,CAACD,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,CAC/C,SAAAE,MAAA,CAAUX,IAAI,MAAAW,MAAA,CAAIT,EAAE,MAAAS,MAAA,CAAIR,EAAE,EAC5B,CAEA,QAAS,CAAAS,UAAUA,CAAChB,GAAG,CAAEiB,CAAC,CAAE,CAC1B,KAAM,CAAAC,EAAE,CAAGnB,SAAS,CAACC,GAAG,CAAC,CACzB,GAAI,CAACkB,EAAE,CAAE,MAAO,CAAAlB,GAAG,CACnB,KAAM,CAAAU,CAAC,CAAG,GAAI,CAAAF,IAAI,CAACU,EAAE,CAACP,WAAW,CAAC,CAAC,CAAEO,EAAE,CAACN,QAAQ,CAAC,CAAC,CAAEM,EAAE,CAACJ,OAAO,CAAC,CAAC,CAAC,CACjEJ,CAAC,CAACS,OAAO,CAACT,CAAC,CAACI,OAAO,CAAC,CAAC,CAAGG,CAAC,CAAC,CAC1B,MAAO,CAAAR,SAAS,CAACC,CAAC,CAAC,CACrB,CACA;AACA;AACA;AACA;AACA;AACA,GACA,QAAS,CAAAU,wBAAwBA,CAACC,cAAc,CAAEC,WAAW,CAAE,KAAAC,aAAA,CAAAC,oBAAA,CAC7D,GAAI,CAACH,cAAc,EAAI,CAACC,WAAW,CAAE,MAAO,CAAAD,cAAc,CAE1D,KAAM,CAAAI,IAAI,CAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACP,cAAc,CAAC,CAAC,CAEvD,GAAI,CAAAQ,MAAM,CACR,EAAAN,aAAA,CAAAD,WAAW,CAAC,CAAC,CAAC,UAAAC,aAAA,iBAAdA,aAAA,CAAgBO,UAAU,KAAAN,oBAAA,CAAIC,IAAI,CAACM,aAAa,CAAC,CAAC,CAAC,UAAAP,oBAAA,iBAArBA,oBAAA,CAAuBQ,iBAAiB,EAExEP,IAAI,CAACM,aAAa,CAACE,OAAO,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAK,CACnC,KAAM,CAAAC,CAAC,CAAGd,WAAW,CAACa,CAAC,CAAC,CACxB,KAAM,CAAAE,MAAM,CAAGD,CAAC,CAACE,WAAW,CAE5BJ,CAAC,CAACK,WAAW,CAAGF,MAAM,CACtBH,CAAC,CAACF,iBAAiB,CAAGH,MAAM,CAE5B,KAAM,CAAAW,SAAS,CAAGxB,UAAU,CAACa,MAAM,CAAEQ,MAAM,CAAG,CAAC,CAAC,CAChDH,CAAC,CAACO,mBAAmB,CAAGD,SAAS,CAEjCX,MAAM,CAAGb,UAAU,CAACwB,SAAS,CAAE,CAAC,CAAC,CACnC,CAAC,CAAC,CAEF,MAAO,CAAAf,IAAI,CACb,CAEA;AACA;AACA;AACA;AACA,GACA,QAAS,CAAAiB,wBAAwBA,CAACrB,cAAc,CAAE,CAChD,GAAI,CAACA,cAAc,EAAI,CAACA,cAAc,CAACU,aAAa,CAAE,MAAO,CAAAV,cAAc,CAE3E,KAAM,CAAAI,IAAI,CAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACP,cAAc,CAAC,CAAC,CACvD,KAAM,CAAAsB,QAAQ,CAAG,EAAE,CAEnBlB,IAAI,CAACM,aAAa,CAACE,OAAO,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAK,CACnC;AACAQ,QAAQ,CAACC,IAAI,CAAC,CACZC,IAAI,CAAE,MAAM,CACZC,IAAI,CAAEZ,CAAC,CAACY,IAAI,CAEZC,YAAY,CAAEb,CAAC,CAACa,YAAY,CAC5BR,WAAW,CAAEL,CAAC,CAACK,WAAW,CAE1B;AACAS,OAAO,CAAEd,CAAC,CAACc,OAAO,CAClBC,QAAQ,CAAEf,CAAC,CAACe,QAAQ,CAEpBnB,UAAU,CAAEI,CAAC,CAACJ,UAAU,CACxBoB,WAAW,CAAEhB,CAAC,CAACgB,WAAW,CAC1BC,YAAY,CAAEjB,CAAC,CAACiB,YAAY,CAE5B;AACAnB,iBAAiB,CAAEE,CAAC,CAACF,iBAAiB,CACtCS,mBAAmB,CAAEP,CAAC,CAACO,mBAAmB,CAE1CW,aAAa,CAAElB,CAAC,CAACkB,aAAa,EAAI,EAAE,CACpCC,YAAY,CAAEnB,CAAC,CAACmB,YAAY,EAAI,EAClC,CAAC,CAAC,CAEF;AACA,GAAIlB,CAAC,CAAGV,IAAI,CAACM,aAAa,CAACuB,MAAM,CAAG,CAAC,CAAE,CACrC,KAAM,CAAAC,SAAS,CAAGvC,UAAU,CAACkB,CAAC,CAACO,mBAAmB,CAAE,CAAC,CAAC,CACtDE,QAAQ,CAACC,IAAI,CAAC,CACZC,IAAI,CAAE,QAAQ,CACd7C,GAAG,CAAEuD,SAAS,CACdC,IAAI,CAAE,CACJxD,GAAG,CAAEuD,SAAS,CACdE,KAAK,CAAEF,SAAS,CACZ,CAAC,IAAM,CACL,KAAM,CAAA7C,CAAC,CAAGX,SAAS,CAACwD,SAAS,CAAC,CAC9B,KAAM,CAAAG,IAAI,CAAG,CAAC,KAAK,CAAE,KAAK,CAAE,KAAK,CAAE,KAAK,CAAE,KAAK,CAAE,KAAK,CAAE,KAAK,CAAC,CAC9D,KAAM,CAAAC,GAAG,CAAGjD,CAAC,CAACkD,cAAc,CAAC,OAAO,CAAE,CAAEC,KAAK,CAAE,OAAQ,CAAC,CAAC,CACzD,SAAA9C,MAAA,CAAUb,MAAM,CAACQ,CAAC,CAACI,OAAO,CAAC,CAAC,CAAC,CAACD,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,MAAAE,MAAA,CAAI4C,GAAG,OAAA5C,MAAA,CACnD2C,IAAI,CAAChD,CAAC,CAACoD,MAAM,CAAC,CAAC,CAAC,MAEpB,CAAC,EAAE,CAAC,CACJ,GACN,CACF,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,CAEFrC,IAAI,CAACsC,gBAAgB,CAAGpB,QAAQ,CAChC,MAAO,CAAAlB,IAAI,CACb,CAEA;AACA;AACA;AACA;AACA;AACA,GACA,QAAS,CAAAuC,mBAAmBA,CAACC,MAAM,CAAEC,cAAc,CAAEC,WAAW,CAAEC,WAAW,CAAE,CAC7E,GAAI,CAACH,MAAM,CAAE,MAAO,KAAI,CACxB,KAAM,CAAAI,IAAI,CAAG3C,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACqC,MAAM,CAACtB,QAAQ,EAAI,EAAE,CAAC,CAAC,CAE9D;AACA,KAAM,CAAA2B,KAAK,CAAGD,IAAI,CAACE,MAAM,CAAErC,CAAC,EAAKA,CAAC,CAACW,IAAI,GAAK,MAAM,CAAC,CAEnD;AACA,KAAM,CAAAd,aAAa,CAAGuC,KAAK,CAACE,GAAG,CAAC,CAACtC,CAAC,CAAEuC,GAAG,GAAK,KAAAC,UAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAC,eAAA,CAAAC,eAAA,CAC1C,KAAM,CAAAhD,UAAU,CAAGI,CAAC,CAACJ,UAAU,IAAA4C,UAAA,CAAIxC,CAAC,CAACc,OAAO,UAAA0B,UAAA,iBAATA,UAAA,CAAW1E,GAAG,EACjD,KAAM,CAAAmD,YAAY,CACfjB,CAAC,CAACM,SAAS,GAAKN,CAAC,CAACM,SAAS,CAACxC,GAAG,EAAIkC,CAAC,CAACM,SAAS,CAAC,EAChDxB,UAAU,CAACc,UAAU,CAAE,EAAA6C,cAAA,CAACzC,CAAC,CAACI,WAAW,UAAAqC,cAAA,UAAAA,cAAA,CAAIzC,CAAC,CAACwB,IAAI,EAAI,CAAC,CAAC,CAEvD,GAAI,CAAAnB,WAAW,CAAGlC,MAAM,EAAAuE,IAAA,EAAAC,eAAA,CAAC3C,CAAC,CAACI,WAAW,UAAAuC,eAAA,UAAAA,eAAA,CAAI3C,CAAC,CAACwB,IAAI,UAAAkB,IAAA,UAAAA,IAAA,CAAI,CAAC,CAAC,CAEtD,GAAIV,cAAc,EAAIO,GAAG,GAAK,CAAC,CAAE,CAC/BlC,WAAW,CAAGwC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEzC,WAAW,CAAG,CAAC,CAAC,CAC5C,CACA,GAAI4B,WAAW,EAAIM,GAAG,GAAKH,KAAK,CAAChB,MAAM,CAAG,CAAC,CAAE,CAC3Cf,WAAW,CAAGwC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEzC,WAAW,CAAG,CAAC,CAAC,CAC5C,CAEA,KAAM,CAAAP,iBAAiB,CACrBkC,cAAc,EAAIO,GAAG,GAAK,CAAC,CAAGzD,UAAU,CAACc,UAAU,CAAE,CAAC,CAAC,CAAGA,UAAU,CAEtE,KAAM,CAAAW,mBAAmB,CAAG,CAAC,IAAM,CACjC,GAAI0B,WAAW,EAAIM,GAAG,GAAKH,KAAK,CAAChB,MAAM,CAAG,CAAC,CAAE,CAC3C;AACA,MAAO,CAAAtC,UAAU,CAACmC,YAAY,CAAE,CAAC,CAAC,CAAC,CACrC,CACA;AACA,MAAO,CAAAnC,UAAU,CAACgB,iBAAiB,CAAE+C,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEzC,WAAW,CAAG,CAAC,CAAC,CAAC,CACpE,CAAC,EAAE,CAAC,CAEJ;AACA,KAAM,CAAAa,aAAa,CAAG,EAAE,CACxB,GAAIb,WAAW,CAAG,CAAC,CAAE,CACnB,GAAI,CAAA0C,GAAG,CAAGlF,SAAS,CAACiC,iBAAiB,CAAC,CACtC,KAAM,CAAAkD,IAAI,CAAGnF,SAAS,CAAC0C,mBAAmB,CAAC,CAC3C,MAAOwC,GAAG,EAAIC,IAAI,EAAID,GAAG,EAAIC,IAAI,CAAE,CACjC9B,aAAa,CAACR,IAAI,CAACnC,SAAS,CAACwE,GAAG,CAAC,CAAC,CAClCA,GAAG,CAAC9D,OAAO,CAAC8D,GAAG,CAACnE,OAAO,CAAC,CAAC,CAAG,CAAC,CAAC,CAChC,CACF,CAEA;AACA,KAAM,CAAAuC,YAAY,CAAG,EAAE,CACvB,GAAIe,WAAW,EAAIhB,aAAa,CAACE,MAAM,CAAG,CAAC,CAAE,CAC3CF,aAAa,CAACnB,OAAO,CAAEjC,GAAG,EAAK,CAC7B,KAAM,CAAAU,CAAC,CAAGX,SAAS,CAACC,GAAG,CAAC,CACxB,KAAM,CAAAmF,GAAG,CAAGzE,CAAC,CAACoD,MAAM,CAAC,CAAC,CACtB,GAAIqB,GAAG,GAAK,CAAC,EAAIA,GAAG,GAAK,CAAC,CAAE9B,YAAY,CAACT,IAAI,CAAC5C,GAAG,CAAC,CACpD,CAAC,CAAC,CACJ,CAEA,OAAAoF,aAAA,CAAAA,aAAA,IACKlD,CAAC,MACJK,WAAW,CACXP,iBAAiB,CACjBS,mBAAmB,CACnBW,aAAa,CACbC,YAAY,CACZN,YAAY,EAAA+B,eAAA,CAAE5C,CAAC,CAACI,WAAW,UAAAwC,eAAA,UAAAA,eAAA,CAAI5C,CAAC,CAACwB,IAAI,GAEzC,CAAC,CAAC,CAEF;AACA,KAAM,CAAAK,gBAAgB,CAAG,EAAE,CAC3B,IAAK,GAAI,CAAA5B,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGJ,aAAa,CAACuB,MAAM,CAAEnB,CAAC,EAAE,CAAE,CAC7C,KAAM,CAAAD,CAAC,CAAGH,aAAa,CAACI,CAAC,CAAC,CAC1B4B,gBAAgB,CAACnB,IAAI,CAAC,CACpBC,IAAI,CAAE,MAAM,CACZC,IAAI,CAAEZ,CAAC,CAACY,IAAI,CACZC,YAAY,CAAEb,CAAC,CAACa,YAAY,CAC5BR,WAAW,CAAEL,CAAC,CAACK,WAAW,CAC1BS,OAAO,CAAEd,CAAC,CAACc,OAAO,CAAE;AACpBC,QAAQ,CAAEf,CAAC,CAACe,QAAQ,CAAE;AACtBnB,UAAU,CAAEI,CAAC,CAACJ,UAAU,CACxBoB,WAAW,CAAEhB,CAAC,CAACgB,WAAW,CAC1BlB,iBAAiB,CAAEE,CAAC,CAACF,iBAAiB,CACtCS,mBAAmB,CAAEP,CAAC,CAACO,mBAAmB,CAC1CW,aAAa,CAAElB,CAAC,CAACkB,aAAa,CAC9BC,YAAY,CAAEnB,CAAC,CAACmB,YAClB,CAAC,CAAC,CACF,GAAIlB,CAAC,CAAGJ,aAAa,CAACuB,MAAM,CAAG,CAAC,CAAE,KAAA+B,WAAA,CAChC;AACAtB,gBAAgB,CAACnB,IAAI,CAAC,CACpBC,IAAI,CAAE,QAAQ,CACdW,IAAI,CAAEtB,CAAC,CAACe,QAAQ,CAChBjD,GAAG,CAAEkC,CAAC,CAACgB,WAAW,IAAAmC,WAAA,CAAInD,CAAC,CAACe,QAAQ,UAAAoC,WAAA,iBAAVA,WAAA,CAAYrF,GAAG,CACvC,CAAC,CAAC,CACJ,CACF,CAEA;AACA,GAAI,CAAAsF,YAAY,CAAG,CAAC,CAClBC,aAAa,CAAG,CAAC,CACjBC,YAAY,CAAG,CAAC,CAClBzD,aAAa,CAACE,OAAO,CAAEC,CAAC,EAAK,KAAAuD,cAAA,CAC3B,KAAM,CAAA/E,CAAC,EAAA+E,cAAA,CAAGvD,CAAC,CAACK,WAAW,UAAAkD,cAAA,UAAAA,cAAA,CAAI,CAAC,CAC5BD,YAAY,EAAI9E,CAAC,CACjB,GAAIwB,CAAC,CAACY,IAAI,GAAK,QAAQ,CAAEwC,YAAY,EAAI5E,CAAC,CAC1C,GAAIwB,CAAC,CAACY,IAAI,GAAK,SAAS,CAAEyC,aAAa,EAAI7E,CAAC,CAC9C,CAAC,CAAC,CAEF,OAAA0E,aAAA,CAAAA,aAAA,IACKnB,MAAM,MACTF,gBAAgB,CAChBhC,aAAa,CACbyD,YAAY,CACZF,YAAY,CACZC,aAAa,GAEjB,CAEA,cAAe,SAAS,CAAAG,WAAWA,CAAA,CAAG,CACpC,KAAM,CAAAC,GAAG,CAAG,GAAI,CAAAnF,IAAI,CAAC,CAAC,CACtB,KAAM,CAAAoF,UAAU,IAAA7E,MAAA,CAAM4E,GAAG,CAAChF,WAAW,CAAC,CAAC,MAAAI,MAAA,CAAIb,MAAM,CAC/CyF,GAAG,CAAC/E,QAAQ,CAAC,CAAC,CAAG,CACnB,CAAC,CAACC,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,MAAAE,MAAA,CAAIb,MAAM,CAACyF,GAAG,CAAC7E,OAAO,CAAC,CAAC,CAAC,CAACD,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,CAAE,CAE9D;AACA,KAAM,CAACgF,iBAAiB,CAAEC,oBAAoB,CAAC,CAAG3G,QAAQ,CAACyG,UAAU,CAAC,CACtE,KAAM,CAACG,gBAAgB,CAAEC,mBAAmB,CAAC,CAAG7G,QAAQ,CAAC,EAAE,CAAC,CAE5D;AACA,KAAM,CAAC8G,gBAAgB,CAAEC,mBAAmB,CAAC,CAAG/G,QAAQ,CAACyG,UAAU,CAAC,CACpE,KAAM,CAACO,WAAW,CAAEC,cAAc,CAAC,CAAGjH,QAAQ,CAAC,EAAE,CAAC,CAElD,KAAM,CAACkH,SAAS,CAAEC,YAAY,CAAC,CAAGnH,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACoH,cAAc,CAAEC,iBAAiB,CAAC,CAAGrH,QAAQ,CAAC,KAAK,CAAC,CAC3D,KAAM,CAACsH,WAAW,CAAEC,cAAc,CAAC,CAAGvH,QAAQ,CAAC,EAAE,CAAC,CAClD,KAAM,CAACwH,WAAW,CAAEC,cAAc,CAAC,CAAGzH,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAAC0H,aAAa,CAAEC,gBAAgB,CAAC,CAAG3H,QAAQ,CAAC,EAAE,CAAC,CAEtD,KAAM,CAAC4H,SAAS,CAAEC,YAAY,CAAC,CAAG7H,QAAQ,CAAC,QAAQ,CAAC,CACpD,KAAM,CAAC8H,QAAQ,CAAEC,WAAW,CAAC,CAAG/H,QAAQ,CAAC,QAAQ,CAAC,CAClD,KAAM,CAACgI,UAAU,CAAEC,aAAa,CAAC,CAAGjI,QAAQ,CAAC,KAAK,CAAC,CAEnD;AACA,KAAM,CAAC+E,cAAc,CAAEmD,iBAAiB,CAAC,CAAGlI,QAAQ,CAAC,KAAK,CAAC,CAC3D,KAAM,CAACgF,WAAW,CAAEmD,cAAc,CAAC,CAAGnI,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAACiF,WAAW,CAAEmD,cAAc,CAAC,CAAGpI,QAAQ,CAAC,KAAK,CAAC,CAAE;AAEvD,KAAM,CAAC8E,MAAM,CAAEuD,SAAS,CAAC,CAAGrI,QAAQ,CAAC,IAAI,CAAC,CAC1C,KAAM,CAACkC,cAAc,CAAEoG,iBAAiB,CAAC,CAAGtI,QAAQ,CAAC,IAAI,CAAC,CAC1D,KAAM,CAACuI,IAAI,CAAEC,OAAO,CAAC,CAAGxI,QAAQ,CAAC,EAAE,CAAC,CACpC;AACA,KAAM,CAACmC,WAAW,CAAEsG,cAAc,CAAC,CAAGzI,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAAC0I,mBAAmB,CAAEC,sBAAsB,CAAC,CAAG3I,QAAQ,CAAC,KAAK,CAAC,CAErE,KAAM,CAAC4I,KAAK,CAAEC,QAAQ,CAAC,CAAG7I,QAAQ,CAAC,aAAa,CAAC,CACjD,KAAM,CAAA8I,QAAQ,CAAG5I,WAAW,CAAC,CAAC,CAE9B;AACA,QAAS,CAAA6I,UAAUA,CAACC,GAAG,CAAE,CACvB,GAAI,CAACA,GAAG,CAAE,MAAO,CAAAA,GAAG,CACpB,GAAI,qBAAqB,CAACC,IAAI,CAACD,GAAG,CAAC,CAAE,MAAO,CAAAA,GAAG,CAC/C,KAAM,CAAAzH,CAAC,CAAG,GAAI,CAAAF,IAAI,CAAC2H,GAAG,CAAC,CACvB,GAAIE,KAAK,CAAC3H,CAAC,CAAC4H,OAAO,CAAC,CAAC,CAAC,CAAE,MAAO,CAAAH,GAAG,CAClC,SAAApH,MAAA,CAAUL,CAAC,CAACC,WAAW,CAAC,CAAC,MAAAI,MAAA,CAAIb,MAAM,CAACQ,CAAC,CAACE,QAAQ,CAAC,CAAC,CAAG,CAAC,CAAC,CAACC,QAAQ,CAC5D,CAAC,CACD,GACF,CAAC,MAAAE,MAAA,CAAIb,MAAM,CAACQ,CAAC,CAACI,OAAO,CAAC,CAAC,CAAC,CAACD,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,EAC3C,CAEA;AACA,QAAS,CAAA0H,iBAAiBA,CAACC,CAAC,CAAE,CAC5B1C,oBAAoB,CAAC0C,CAAC,CAAC,CACvBtC,mBAAmB,CAACsC,CAAC,CAAC,CACxB,CACA,QAAS,CAAAC,YAAYA,CAACD,CAAC,CAAE,CACvBxC,mBAAmB,CAACwC,CAAC,CAAC,CACtBpC,cAAc,CAACoC,CAAC,CAAC,CACjB1B,gBAAgB,CAAC0B,CAAC,CAAC,CACrB,CAEA;AACA,QAAS,CAAAE,UAAUA,CAACC,CAAC,CAAE,KAAAC,iBAAA,CAAAC,qBAAA,CACrBF,CAAC,SAADA,CAAC,kBAAAC,iBAAA,CAADD,CAAC,CAAEG,cAAc,UAAAF,iBAAA,iBAAjBA,iBAAA,CAAAG,IAAA,CAAAJ,CAAoB,CAAC,CACrBhB,OAAO,CAAC,EAAE,CAAC,CAEX,KAAM,CAAAqB,IAAI,CAAG,CACXC,aAAa,CAAEf,UAAU,CAACrC,iBAAiB,CAAC,CAC5CkB,SAAS,CACTE,QAAQ,CACRE,UACF,CAAC,CAED,GAAIR,WAAW,EAAIE,aAAa,CAAE,CAChCmC,IAAI,CAACE,QAAQ,CAAGhB,UAAU,CAACrB,aAAa,CAAC,CAC3C,CAAC,IAAM,IAAIN,cAAc,CAAE,CACzByC,IAAI,CAAC3C,SAAS,CAAGhG,MAAM,CAACoG,WAAW,CAAC,CACtC,CAAC,IAAM,CACLuC,IAAI,CAAC3C,SAAS,CAAGhG,MAAM,CAACgG,SAAS,CAAC,CACpC,CAEA,KAAM,CAAA8C,GAAG,CAAG7J,iBAAiB,CAAC0J,IAAI,CAAC,CAEnC,GAAIG,GAAG,CAACC,KAAK,CAAE,CACbzB,OAAO,CAACwB,GAAG,CAACC,KAAK,CAAC,CAClB5B,SAAS,CAAC,IAAI,CAAC,CACfC,iBAAiB,CAAC,IAAI,CAAC,CACvB,OACF,CAEAD,SAAS,CAAC2B,GAAG,CAAC,CAEd;AACA,KAAM,CAAAE,GAAG,CAAGrF,mBAAmB,CAC7BmF,GAAG,CACHjF,cAAc,CACdC,WAAW,CACXC,WACF,CAAC,CACDqD,iBAAiB,CAAC4B,GAAG,CAAC,CACtB;AACA,GAAIA,GAAG,SAAHA,GAAG,WAAHA,GAAG,CAAEtH,aAAa,CAAE,CACtB6F,cAAc,CACZyB,GAAG,CAACtH,aAAa,CAACyC,GAAG,CAAEtC,CAAC,OAAAoH,KAAA,CAAAC,eAAA,OAAM,CAC5BzG,IAAI,CAAEZ,CAAC,CAACY,IAAI,CAEZ;AACA;AACAR,WAAW,CACT,MAAO,CAAAJ,CAAC,CAACK,WAAW,GAAK,QAAQ,CAC7BL,CAAC,CAACK,WAAW,EAAA+G,KAAA,EAAAC,eAAA,CACbrH,CAAC,CAACa,YAAY,UAAAwG,eAAA,UAAAA,eAAA,CAAIrH,CAAC,CAACI,WAAW,UAAAgH,KAAA,UAAAA,KAAA,CAAIpH,CAAC,CAACwB,IAAI,CAE/C5B,UAAU,CAAEI,CAAC,CAACF,iBAAiB,EAAIE,CAAC,CAACJ,UAAU,CAC/C0H,MAAM,CAAE,KACV,CAAC,EAAC,CACJ,CAAC,CAED1B,sBAAsB,CAAC,KAAK,CAAC,CAC/B,CAEA;AACA;AACA,KAAM,CAAA2B,SAAS,CACZJ,GAAG,EAAIA,GAAG,CAACtH,aAAa,EAAIsH,GAAG,CAACtH,aAAa,CAAC,CAAC,CAAC,EAAK,IAAI,CAC5D,GAAI0H,SAAS,CAAE,CACb,GAAIvF,cAAc,CAAE,CAClBgC,mBAAmB,CACjBuD,SAAS,CAACzH,iBAAiB,EACzByH,SAAS,CAAC3H,UAAU,EACpB+D,iBACJ,CAAC,CACH,CAAC,IAAM,CACL;AACAK,mBAAmB,CAACgC,UAAU,CAACrC,iBAAiB,CAAC,CAAC,CACpD,CACF,CAEA;AACA,KAAM,CAAA6D,YAAY,CAAGP,GAAG,CAACxG,QAAQ,CAC7BwG,GAAG,CAACxG,QAAQ,CAAC4B,MAAM,CAAErC,CAAC,EAAKA,CAAC,CAACW,IAAI,GAAK,MAAM,CAAC,CAAC8G,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAC1D,IAAI,CAER;AACA,KAAM,CAAAC,WAAW,CAAGF,YAAY,CAC5BA,YAAY,CAACvG,YAAY,EACzBuG,YAAY,CAACG,cAAc,IAAAhB,qBAAA,CAC3Ba,YAAY,CAACzG,QAAQ,UAAA4F,qBAAA,iBAArBA,qBAAA,CAAuB7I,GAAG,GAC1B,EAAE,CACF,EAAE,CAEN;AACA,KAAM,CAAA8J,WAAW,CACdT,GAAG,EAAIA,GAAG,CAACtH,aAAa,EAAIsH,GAAG,CAACtH,aAAa,CAAC4H,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAK,IAAI,CACtE,GAAIG,WAAW,CAAE,CACf,GAAI3F,WAAW,CAAE,CACfiC,cAAc,CACZ0D,WAAW,CAACrH,mBAAmB,EAC7BqH,WAAW,CAAC5G,WAAW,EACvB0G,WACJ,CAAC,CACH,CAAC,IAAM,CACL;AACAxD,cAAc,CAACwD,WAAW,EAAI1B,UAAU,CAACnC,gBAAgB,CAAC,EAAI,EAAE,CAAC,CACnE,CACF,CAAC,IAAM,CACLK,cAAc,CAACwD,WAAW,EAAI1B,UAAU,CAACnC,gBAAgB,CAAC,EAAI,EAAE,CAAC,CACnE,CAEA4B,OAAO,CAAC,mCAAmC,CAAC,CAC9C,CAEA;AACAvI,SAAS,CAAC,IAAM,KAAA2K,sBAAA,CACd,GAAI,CAAC9F,MAAM,CAAE,OACb,KAAM,CAAAoF,GAAG,CAAGrF,mBAAmB,CAC7BC,MAAM,CACNC,cAAc,CACdC,WAAW,CACXC,WACF,CAAC,CACDqD,iBAAiB,CAAC4B,GAAG,CAAC,CAEtB;AACA,KAAM,CAAAI,SAAS,CACZJ,GAAG,EAAIA,GAAG,CAACtH,aAAa,EAAIsH,GAAG,CAACtH,aAAa,CAAC,CAAC,CAAC,EAAK,IAAI,CAC5D,GAAI0H,SAAS,CAAE,CACb,GAAIvF,cAAc,CAChBgC,mBAAmB,CACjBuD,SAAS,CAACzH,iBAAiB,EAAIyH,SAAS,CAAC3H,UAC3C,CAAC,CAAC,IACC,CAAAoE,mBAAmB,CAACgC,UAAU,CAACrC,iBAAiB,CAAC,CAAC,CACzD,CACA,KAAM,CAAAiE,WAAW,CACdT,GAAG,EAAIA,GAAG,CAACtH,aAAa,EAAIsH,GAAG,CAACtH,aAAa,CAAC4H,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAK,IAAI,CACtE,KAAM,CAAAD,YAAY,CAAGzF,MAAM,CAACtB,QAAQ,CAChCsB,MAAM,CAACtB,QAAQ,CAAC4B,MAAM,CAAErC,CAAC,EAAKA,CAAC,CAACW,IAAI,GAAK,MAAM,CAAC,CAAC8G,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAC7D,IAAI,CAER;AACA,KAAM,CAAAC,WAAW,CAAGF,YAAY,CAC5BA,YAAY,CAACvG,YAAY,EACzBuG,YAAY,CAACG,cAAc,IAAAE,sBAAA,CAC3BL,YAAY,CAACzG,QAAQ,UAAA8G,sBAAA,iBAArBA,sBAAA,CAAuB/J,GAAG,GAC1B,EAAE,CACF,EAAE,CAEN,GAAI8J,WAAW,CAAE,CACf,GAAI3F,WAAW,CACbiC,cAAc,CACZ0D,WAAW,CAACrH,mBAAmB,EAC7BqH,WAAW,CAAC5G,WAAW,EACvB0G,WACJ,CAAC,CAAC,IACC,CAAAxD,cAAc,CAACwD,WAAW,EAAI1B,UAAU,CAACnC,gBAAgB,CAAC,EAAI,EAAE,CAAC,CACxE,CAAC,IAAM,CACLK,cAAc,CAACwD,WAAW,EAAI1B,UAAU,CAACnC,gBAAgB,CAAC,EAAI,EAAE,CAAC,CACnE,CACA;AACF,CAAC,CAAE,CAAC7B,cAAc,CAAEC,WAAW,CAAEC,WAAW,CAAEH,MAAM,CAAC,CAAC,CAAE;AAExD,QAAS,CAAA+F,cAAcA,CAACC,SAAS,CAAEC,KAAK,CAAE,KAAAC,qBAAA,CACxC,GAAI,CAAC7I,WAAW,EAAI,CAACD,cAAc,CAAE,OAErC,KAAM,CAAEiD,KAAK,CAAE8F,aAAa,CAAEC,cAAe,CAAC,CAAG7K,mBAAmB,CAClE8B,WAAW,CACX2I,SAAS,CACTC,KACF,CAAC,CAEDtC,cAAc,CAACtD,KAAK,CAAC,CACrBwD,sBAAsB,CAACsC,aAAa,CAAC,CAErC,GAAIC,cAAc,CAAE,OAEpB;AACA;AACA;AACA;AACA,KAAM,CAAAC,WAAW,CAAG5I,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACP,cAAc,CAAC,CAAC,CAE9D,GAAI,CAAAQ,MAAM,CACRyC,KAAK,CAAC,CAAC,CAAC,CAACxC,UAAU,IAAAqI,qBAAA,CAAIG,WAAW,CAACvI,aAAa,CAAC,CAAC,CAAC,UAAAoI,qBAAA,iBAA5BA,qBAAA,CAA8BnI,iBAAiB,EAExEsI,WAAW,CAACvI,aAAa,CAACE,OAAO,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAK,CAC1C,KAAM,CAAAoI,MAAM,CAAGjG,KAAK,CAACnC,CAAC,CAAC,CACvB,KAAM,CAAAE,MAAM,CAAGkI,MAAM,CAACjI,WAAW,CAEjCJ,CAAC,CAACK,WAAW,CAAGF,MAAM,CACtBH,CAAC,CAACF,iBAAiB,CAAGH,MAAM,CAE5B;AACA,KAAM,CAAAW,SAAS,CAAGxB,UAAU,CAACa,MAAM,CAAEQ,MAAM,CAAG,CAAC,CAAC,CAChDH,CAAC,CAACO,mBAAmB,CAAGD,SAAS,CAEjC;AACA,GAAI,CAAAa,YAAY,CAAG,EAAE,CAErB,GAAIe,WAAW,CAAE,CACf,GAAI,CAAA1D,CAAC,CAAGX,SAAS,CAACmC,CAAC,CAACF,iBAAiB,CAAC,CACtC,KAAM,CAAAwI,GAAG,CAAGzK,SAAS,CAACmC,CAAC,CAACO,mBAAmB,CAAC,CAE5C,MAAO/B,CAAC,EAAI8J,GAAG,EAAI9J,CAAC,EAAI8J,GAAG,CAAE,CAC3B,KAAM,CAAArF,GAAG,CAAGzE,CAAC,CAACoD,MAAM,CAAC,CAAC,CAAE;AACxB,GAAIqB,GAAG,GAAK,CAAC,EAAIA,GAAG,GAAK,CAAC,CAAE,CAC1B9B,YAAY,CAACT,IAAI,CAACnC,SAAS,CAACC,CAAC,CAAC,CAAC,CACjC,CACAA,CAAC,CAACS,OAAO,CAACT,CAAC,CAACI,OAAO,CAAC,CAAC,CAAG,CAAC,CAAC,CAC5B,CACF,CAEAoB,CAAC,CAACmB,YAAY,CAAGA,YAAY,CAE7B;AACAxB,MAAM,CAAGb,UAAU,CAACwB,SAAS,CAAE,CAAC,CAAC,CACnC,CAAC,CAAC,CAEF;AACA,KAAM,CAAAiI,YAAY,CAAGrJ,wBAAwB,CAACkJ,WAAW,CAAEhG,KAAK,CAAC,CACjE,KAAM,CAAAoG,YAAY,CAAGhI,wBAAwB,CAAC+H,YAAY,CAAC,CAE3DhD,iBAAiB,CAACiD,YAAY,CAAC,CACjC,CAEA;AAEA,QAAS,CAAAC,QAAQA,CAAA,CAAG,CAClB,GAAI,CACF,KAAM,CAAAC,MAAM,CACVvJ,cAAc,EAAIA,cAAc,CAAC0C,gBAAgB,CAAAqB,aAAA,CAAAA,aAAA,IAExC/D,cAAc,MAEjB;AACAsB,QAAQ,CAAEtB,cAAc,CAAC0C,gBAAgB,CAACS,GAAG,CAAEtC,CAAC,EAAK,CACnD,GAAIA,CAAC,CAACW,IAAI,GAAK,MAAM,CAAE,MAAO,CAAAX,CAAC,CAE/B,KAAM,CAAA2I,UAAU,CAAG3I,CAAC,CAACF,iBAAiB,CACtC,KAAM,CAAA8I,WAAW,CAAG5I,CAAC,CAACO,mBAAmB,CACrCzB,UAAU,CAACkB,CAAC,CAACO,mBAAmB,CAAE,CAAC,CAAC,CACpCP,CAAC,CAACgB,WAAW,CAEjB,OAAAkC,aAAA,CAAAA,aAAA,IACKlD,CAAC,MAEJ;AACAJ,UAAU,CAAE+I,UAAU,CACtB3H,WAAW,CAAE4H,WAAW,CAExB9H,OAAO,CAAAoC,aAAA,CAAAA,aAAA,IACDlD,CAAC,CAACc,OAAO,EAAI,CAAC,CAAC,MACnBhD,GAAG,CAAE6K,UAAU,EAChB,CACD5H,QAAQ,CAAAmC,aAAA,CAAAA,aAAA,IACFlD,CAAC,CAACe,QAAQ,EAAI,CAAC,CAAC,MACpBjD,GAAG,CAAE8K,WAAW,EACjB,GAEL,CAAC,CAAC,GAEJ7G,MAAM,CAEZ,GAAI,CAAC2G,MAAM,CAAE,CACXjD,OAAO,CAAC,uBAAuB,CAAC,CAChC,OACF,CAEA;AACAoD,YAAY,CAACC,OAAO,CAAC,iBAAiB,CAAEtJ,IAAI,CAACE,SAAS,CAACgJ,MAAM,CAAC,CAAC,CAE/D;AACA,GAAI,CAAAK,SAAS,CAAG,EAAE,CAElB,GACEC,KAAK,CAACC,OAAO,CAACP,MAAM,CAAC7I,aAAa,CAAC,EACnC6I,MAAM,CAAC7I,aAAa,CAACuB,MAAM,CAAG,CAAC,CAC/B,CACA2H,SAAS,CAAGL,MAAM,CAAC7I,aAAa,CAClC,CAAC,IAAM,IACLmJ,KAAK,CAACC,OAAO,CAACP,MAAM,CAAC7G,gBAAgB,CAAC,EACtC6G,MAAM,CAAC7G,gBAAgB,CAACT,MAAM,CAAG,CAAC,CAClC,CACA2H,SAAS,CAAGL,MAAM,CAAC7G,gBAAgB,CAACQ,MAAM,CAAErC,CAAC,EAAKA,CAAC,CAACW,IAAI,GAAK,MAAM,CAAC,CACtE,CAAC,IAAM,CACLoI,SAAS,CAAG,CAACL,MAAM,CAACjI,QAAQ,EAAI,EAAE,EAAE4B,MAAM,CAAErC,CAAC,EAAKA,CAAC,CAACW,IAAI,GAAK,MAAM,CAAC,CACtE,CAEA;AACA,KAAM,CAAAuI,WAAW,CAAGH,SAAS,CAC1B1G,MAAM,CAAErC,CAAC,EAAKhC,MAAM,CAACgC,CAAC,CAACY,IAAI,CAAC,CAACuI,WAAW,CAAC,CAAC,GAAK,QAAQ,CAAC,CACxDC,MAAM,CACL,CAACC,GAAG,CAAErJ,CAAC,QAAAsJ,KAAA,CAAAC,KAAA,CAAAC,eAAA,OACL,CAAAH,GAAG,CAAGlL,MAAM,EAAAmL,KAAA,EAAAC,KAAA,EAAAC,eAAA,CAACxJ,CAAC,CAACK,WAAW,UAAAmJ,eAAA,UAAAA,eAAA,CAAIxJ,CAAC,CAACI,WAAW,UAAAmJ,KAAA,UAAAA,KAAA,CAAIvJ,CAAC,CAACwB,IAAI,UAAA8H,KAAA,UAAAA,KAAA,CAAI,CAAC,CAAC,GAC7D,CACF,CAAC,CAEH,KAAM,CAAAG,YAAY,CAAGV,SAAS,CAC3B1G,MAAM,CAAErC,CAAC,EAAKhC,MAAM,CAACgC,CAAC,CAACY,IAAI,CAAC,CAACuI,WAAW,CAAC,CAAC,GAAK,SAAS,CAAC,CACzDC,MAAM,CACL,CAACC,GAAG,CAAErJ,CAAC,QAAA0J,KAAA,CAAAC,KAAA,CAAAC,eAAA,OACL,CAAAP,GAAG,CAAGlL,MAAM,EAAAuL,KAAA,EAAAC,KAAA,EAAAC,eAAA,CAAC5J,CAAC,CAACK,WAAW,UAAAuJ,eAAA,UAAAA,eAAA,CAAI5J,CAAC,CAACI,WAAW,UAAAuJ,KAAA,UAAAA,KAAA,CAAI3J,CAAC,CAACwB,IAAI,UAAAkI,KAAA,UAAAA,KAAA,CAAI,CAAC,CAAC,GAC7D,CACF,CAAC,CAEH;AACAb,YAAY,CAACC,OAAO,CAAC,qBAAqB,CAAE9K,MAAM,CAACkL,WAAW,CAAC,CAAC,CAChEL,YAAY,CAACC,OAAO,CAAC,sBAAsB,CAAE9K,MAAM,CAACyL,YAAY,CAAC,CAAC,CAElE;AACA,KAAM,CAAAI,WAAW,CAAGd,SAAS,CAAC1G,MAAM,CACjCrC,CAAC,EAAKhC,MAAM,CAACgC,CAAC,CAACY,IAAI,CAAC,CAACuI,WAAW,CAAC,CAAC,GAAK,QAC1C,CAAC,CACD,KAAM,CAAAW,YAAY,CAAGf,SAAS,CAAC1G,MAAM,CAClCrC,CAAC,EAAKhC,MAAM,CAACgC,CAAC,CAACY,IAAI,CAAC,CAACuI,WAAW,CAAC,CAAC,GAAK,SAC1C,CAAC,CAED;AACA,KAAM,CAAAY,aAAa,CAAIC,GAAG,EAAK,CAC7B,GAAI,CAAAC,WAAW,CAAG,CAAC,CACnB,GAAI,CAAAC,aAAa,CAAG,CAAC,CACrBF,GAAG,CAACjK,OAAO,CAAEC,CAAC,EAAK,KAAAmK,KAAA,CAAAC,KAAA,CAAAC,eAAA,CACjB;AACA,KAAM,CAAAC,CAAC,CAAGtB,KAAK,CAACC,OAAO,CAACjJ,CAAC,CAACkB,aAAa,CAAC,CACpClB,CAAC,CAACkB,aAAa,CAACE,MAAM,CACtBjD,MAAM,EAAAgM,KAAA,EAAAC,KAAA,EAAAC,eAAA,CAACrK,CAAC,CAACK,WAAW,UAAAgK,eAAA,UAAAA,eAAA,CAAIrK,CAAC,CAACI,WAAW,UAAAgK,KAAA,UAAAA,KAAA,CAAIpK,CAAC,CAACwB,IAAI,UAAA2I,KAAA,UAAAA,KAAA,CAAI,CAAC,CAAC,CACzD,KAAM,CAAAI,CAAC,CAAGvB,KAAK,CAACC,OAAO,CAACjJ,CAAC,CAACmB,YAAY,CAAC,CAAGnB,CAAC,CAACmB,YAAY,CAACC,MAAM,CAAG,CAAC,CACnE6I,WAAW,EAAI9L,MAAM,CAACmM,CAAC,EAAI,CAAC,CAAC,CAC7BJ,aAAa,EAAI/L,MAAM,CAACoM,CAAC,EAAI,CAAC,CAAC,CACjC,CAAC,CAAC,CACF,MAAO,CAAEN,WAAW,CAAEC,aAAc,CAAC,CACvC,CAAC,CAED,KAAM,CAAAM,YAAY,CAAGT,aAAa,CAACF,WAAW,CAAC,CAC/C,KAAM,CAAAY,aAAa,CAAGV,aAAa,CAACD,YAAY,CAAC,CAEjD;AACA;AACA;AACA,KAAM,CAAAY,cAAc,CAAGA,CAACC,MAAM,CAAEC,MAAM,GAAK,CACzC,KAAM,CAAAC,MAAM,CAAGD,MAAM,CAACX,WAAW,EAAI,CAAC,CACtC,KAAM,CAAAa,QAAQ,CAAGF,MAAM,CAACV,aAAa,EAAI,CAAC,CAC1C,KAAM,CAAAa,KAAK,CAAGlI,IAAI,CAACC,GAAG,CAAC,CAAC,CAAE+H,MAAM,CAAGC,QAAQ,CAAC,CAE5CjC,YAAY,CAACC,OAAO,IAAAjK,MAAA,CAAI8L,MAAM,YAAW3M,MAAM,CAAC+M,KAAK,CAAC,CAAC,CACvDlC,YAAY,CAACC,OAAO,IAAAjK,MAAA,CAAI8L,MAAM,oBAAmB3M,MAAM,CAAC8M,QAAQ,CAAC,CAAC,CACpE,CAAC,CAEDJ,cAAc,CAAC,cAAc,CAAEF,YAAY,CAAC,CAC5CE,cAAc,CAAC,eAAe,CAAED,aAAa,CAAC,CAE9C;AACA,KAAM,CAAAO,SAAS,CAAIhB,GAAG,EAAK,CACzB,IAAK,GAAI,CAAAhK,CAAC,GAAI,CAAAgK,GAAG,CAAE,CACjB,GAAIhK,CAAC,CAACiL,aAAa,GAAKC,SAAS,EAAIlL,CAAC,CAACiL,aAAa,GAAK,EAAE,CACzD,MAAO,CAAAjL,CAAC,CAACiL,aAAa,CACxB,GAAIjL,CAAC,CAACmL,YAAY,GAAKD,SAAS,EAAIlL,CAAC,CAACmL,YAAY,GAAK,EAAE,CACvD,MAAO,CAAAnL,CAAC,CAACmL,YAAY,CACzB,CACA,MAAO,KAAI,CACb,CAAC,CACD,KAAM,CAAAC,gBAAgB,CAAIpB,GAAG,EAAK,CAChC,IAAK,GAAI,CAAAhK,CAAC,GAAI,CAAAgK,GAAG,CAAE,CACjB,GAAIhK,CAAC,CAACqL,YAAY,GAAKH,SAAS,EAAIlL,CAAC,CAACqL,YAAY,GAAK,EAAE,CACvD,MAAO,CAAArL,CAAC,CAACqL,YAAY,CACzB,CACA,MAAO,KAAI,CACb,CAAC,CAED,KAAM,CAAAC,MAAM,CAAGN,SAAS,CAACnB,WAAW,CAAC,CACrC,KAAM,CAAA0B,aAAa,CAAGH,gBAAgB,CAACvB,WAAW,CAAC,CACnD,GAAIyB,MAAM,GAAK,IAAI,CACjBzC,YAAY,CAACC,OAAO,CAAC,oBAAoB,CAAE9K,MAAM,CAACsN,MAAM,CAAC,CAAC,CAC5D,GAAIC,aAAa,GAAK,IAAI,CACxB1C,YAAY,CAACC,OAAO,CAClB,4BAA4B,CAC5B9K,MAAM,CAACuN,aAAa,CACtB,CAAC,CAEH,KAAM,CAAAC,MAAM,CAAGR,SAAS,CAAClB,YAAY,CAAC,CACtC,KAAM,CAAA2B,aAAa,CAAGL,gBAAgB,CAACtB,YAAY,CAAC,CACpD,GAAI0B,MAAM,GAAK,IAAI,CACjB3C,YAAY,CAACC,OAAO,CAAC,qBAAqB,CAAE9K,MAAM,CAACwN,MAAM,CAAC,CAAC,CAC7D,GAAIC,aAAa,GAAK,IAAI,CACxB5C,YAAY,CAACC,OAAO,CAClB,6BAA6B,CAC7B9K,MAAM,CAACyN,aAAa,CACtB,CAAC,CAEH;AACA,GAAI5B,WAAW,CAACzI,MAAM,CAAG,CAAC,CAAE,KAAAsK,WAAA,CAAAC,YAAA,CAC1B,KAAM,CAAA3L,CAAC,CAAG6J,WAAW,CAAC,CAAC,CAAC,CACxB,KAAM,CAAA+B,KAAK,CAAG5L,CAAC,CAACF,iBAAiB,EAAIE,CAAC,CAACJ,UAAU,IAAA8L,WAAA,CAAI1L,CAAC,CAACc,OAAO,UAAA4K,WAAA,iBAATA,WAAA,CAAW5N,GAAG,EACnE,KAAM,CAAA+N,MAAM,CAAG7L,CAAC,CAACO,mBAAmB,CAChCzB,UAAU,CAACkB,CAAC,CAACO,mBAAmB,CAAE,CAAC,CAAC,CACpCP,CAAC,CAACgB,WAAW,IAAA2K,YAAA,CAAI3L,CAAC,CAACe,QAAQ,UAAA4K,YAAA,iBAAVA,YAAA,CAAY7N,GAAG,EACpC,GAAI8N,KAAK,CAAE/C,YAAY,CAACC,OAAO,CAAC,sBAAsB,CAAE8C,KAAK,CAAC,CAC9D,GAAIC,MAAM,CAAEhD,YAAY,CAACC,OAAO,CAAC,uBAAuB,CAAE+C,MAAM,CAAC,CACnE,CAAC,IAAM,CACL;AACAhD,YAAY,CAACiD,UAAU,CAAC,sBAAsB,CAAC,CAC/CjD,YAAY,CAACiD,UAAU,CAAC,uBAAuB,CAAC,CAClD,CAEA,GAAIhC,YAAY,CAAC1I,MAAM,CAAG,CAAC,CAAE,KAAA2K,WAAA,CAAAC,YAAA,CAC3B,KAAM,CAAAhM,CAAC,CAAG8J,YAAY,CAAC,CAAC,CAAC,CACzB,KAAM,CAAA8B,KAAK,CAAG5L,CAAC,CAACF,iBAAiB,EAAIE,CAAC,CAACJ,UAAU,IAAAmM,WAAA,CAAI/L,CAAC,CAACc,OAAO,UAAAiL,WAAA,iBAATA,WAAA,CAAWjO,GAAG,EACnE,KAAM,CAAA+N,MAAM,CAAG7L,CAAC,CAACO,mBAAmB,CAChCzB,UAAU,CAACkB,CAAC,CAACO,mBAAmB,CAAE,CAAC,CAAC,CACpCP,CAAC,CAACgB,WAAW,IAAAgL,YAAA,CAAIhM,CAAC,CAACe,QAAQ,UAAAiL,YAAA,iBAAVA,YAAA,CAAYlO,GAAG,EACpC,GAAI8N,KAAK,CAAE/C,YAAY,CAACC,OAAO,CAAC,uBAAuB,CAAE8C,KAAK,CAAC,CAC/D,GAAIC,MAAM,CAAEhD,YAAY,CAACC,OAAO,CAAC,wBAAwB,CAAE+C,MAAM,CAAC,CACpE,CAAC,IAAM,CACLhD,YAAY,CAACiD,UAAU,CAAC,uBAAuB,CAAC,CAChDjD,YAAY,CAACiD,UAAU,CAAC,wBAAwB,CAAC,CACnD,CAEA;AACA/F,QAAQ,CAAC,mBAAmB,CAAC,CAC/B,CAAE,MAAOkG,GAAG,CAAE,CACZC,OAAO,CAAChF,KAAK,CAAC,mBAAmB,CAAE+E,GAAG,CAAC,CACvCxG,OAAO,CAAC,gDAAgD,CAAC,CAC3D,CACF,CAEA;AACAvI,SAAS,CAAC,IAAM,CACd;AACA8G,mBAAmB,CAACL,iBAAiB,CAAC,CACxC,CAAC,CAAE,CAACA,iBAAiB,CAAC,CAAC,CAAE;AAEzB,mBACEjG,KAAA,QAAKyO,SAAS,CAAC,yDAAyD,CAAAC,QAAA,eAEtE5O,IAAA,WACE6O,OAAO,CAAEA,CAAA,GAAMtG,QAAQ,CAAC,CAAC,CAAC,CAAE,CAC5BoG,SAAS,CAAC,gGAAgG,CAAAC,QAAA,CAC3G,aAED,CAAQ,CAAC,cAET1O,KAAA,QAAKyO,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAEhC1O,KAAA,QAAKyO,SAAS,CAAC,wCAAwC,CAAAC,QAAA,eACrD1O,KAAA,QAAA0O,QAAA,eACE5O,IAAA,OAAI2O,SAAS,CAAC,oGAAoG,CAAAC,QAAA,CAAC,cAEnH,CAAI,CAAC,cACL5O,IAAA,MAAG2O,SAAS,CAAC,0CAA0C,CAAAC,QAAA,CAAC,iDAExD,CAAG,CAAC,EACD,CAAC,cAEN5O,IAAA,QAAK2O,SAAS,CAAC,yBAAyB,CAAAC,QAAA,cACtC5O,IAAA,QAAK2O,SAAS,CAAC,6FAA6F,CAAAC,QAAA,CAAC,oBAE7G,CAAK,CAAC,CACH,CAAC,EACH,CAAC,cAGN5O,IAAA,QAAK2O,SAAS,CAAC,6BAA6B,CAAAC,QAAA,cAC1C1O,KAAA,SAAM4O,QAAQ,CAAE9F,UAAW,CAAC2F,SAAS,CAAC,WAAW,CAAAC,QAAA,eAE/C1O,KAAA,QAAA0O,QAAA,eACE5O,IAAA,UAAO2O,SAAS,CAAC,2CAA2C,CAAAC,QAAA,CAAC,gBAE7D,CAAO,CAAC,cACR5O,IAAA,UACEmD,IAAI,CAAC,MAAM,CACX4L,KAAK,CAAExI,gBAAiB,CACxByI,QAAQ,CAAG/F,CAAC,EAAK,CACf;AACAJ,iBAAiB,CAACI,CAAC,CAACgG,MAAM,CAACF,KAAK,CAAC,CACnC,CAAE,CACFJ,SAAS,CAAC,sCAAsC,CACjD,CAAC,CAEDnK,cAAc,EACb2B,iBAAiB,EACjBA,iBAAiB,GAAKI,gBAAgB,eACpCrG,KAAA,QAAKyO,SAAS,CAAC,2FAA2F,CAAAC,QAAA,EAAC,sCACrE,CAAC,GAAG,cACxC5O,IAAA,WAAA4O,QAAA,CAASzI,iBAAiB,CAAS,CAAC,8EACW,CAAC,GAAG,cACnDnG,IAAA,WAAA4O,QAAA,CAASrI,gBAAgB,CAAS,CAAC,EAChC,CACN,EACA,CAAC,cAGNrG,KAAA,QAAKyO,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrC1O,KAAA,QAAA0O,QAAA,eACE5O,IAAA,UAAO2O,SAAS,CAAC,2CAA2C,CAAAC,QAAA,CAAC,aAE7D,CAAO,CAAC,cACR1O,KAAA,WACE6O,KAAK,CAAEpI,SAAU,CACjBqI,QAAQ,CAAG/F,CAAC,EAAKrC,YAAY,CAACqC,CAAC,CAACgG,MAAM,CAACF,KAAK,CAAE,CAC9CG,QAAQ,CAAErI,cAAc,EAAII,WAAY,CACxC0H,SAAS,CAAC,sCAAsC,CAAAC,QAAA,eAEhD5O,IAAA,WAAQ+O,KAAK,CAAE,EAAG,CAAAH,QAAA,CAAC,SAAO,CAAQ,CAAC,cACnC5O,IAAA,WAAQ+O,KAAK,CAAE,EAAG,CAAAH,QAAA,CAAC,SAAO,CAAQ,CAAC,cACnC5O,IAAA,WAAQ+O,KAAK,CAAE,EAAG,CAAAH,QAAA,CAAC,SAAO,CAAQ,CAAC,EAC7B,CAAC,EACN,CAAC,cAGN1O,KAAA,QAAA0O,QAAA,eACE5O,IAAA,UAAO2O,SAAS,CAAC,2CAA2C,CAAAC,QAAA,CAAC,mBAE7D,CAAO,CAAC,cACR1O,KAAA,QAAKyO,SAAS,CAAC,8BAA8B,CAAAC,QAAA,eAC3C5O,IAAA,UACEmD,IAAI,CAAC,UAAU,CACfgM,OAAO,CAAEtI,cAAe,CACxBmI,QAAQ,CAAG/F,CAAC,EAAK,CACfnC,iBAAiB,CAACmC,CAAC,CAACgG,MAAM,CAACE,OAAO,CAAC,CACnC,GAAIlG,CAAC,CAACgG,MAAM,CAACE,OAAO,CAAEjI,cAAc,CAAC,KAAK,CAAC,CAC7C,CAAE,CACH,CAAC,cACFlH,IAAA,UACEmD,IAAI,CAAC,QAAQ,CACbiM,GAAG,CAAE,CAAE,CACPL,KAAK,CAAEhI,WAAY,CACnBiI,QAAQ,CAAG/F,CAAC,EAAKjC,cAAc,CAACiC,CAAC,CAACgG,MAAM,CAACF,KAAK,CAAE,CAChDG,QAAQ,CAAE,CAACrI,cAAe,CAC1B8H,SAAS,CAAC,2BAA2B,CACtC,CAAC,EACC,CAAC,EACH,CAAC,cAGNzO,KAAA,QAAA0O,QAAA,eACE5O,IAAA,UAAO2O,SAAS,CAAC,2CAA2C,CAAAC,QAAA,CAAC,eAE7D,CAAO,CAAC,cACR1O,KAAA,QAAKyO,SAAS,CAAC,8BAA8B,CAAAC,QAAA,eAC3C5O,IAAA,UACEmD,IAAI,CAAC,UAAU,CACfgM,OAAO,CAAElI,WAAY,CACrB+H,QAAQ,CAAG/F,CAAC,EAAK,CACf/B,cAAc,CAAC+B,CAAC,CAACgG,MAAM,CAACE,OAAO,CAAC,CAChC,GAAIlG,CAAC,CAACgG,MAAM,CAACE,OAAO,CAAErI,iBAAiB,CAAC,KAAK,CAAC,CAChD,CAAE,CACH,CAAC,cACF9G,IAAA,UACEmD,IAAI,CAAC,MAAM,CACX4L,KAAK,CAAEtI,WAAW,EAAIU,aAAc,CACpC6H,QAAQ,CAAG/F,CAAC,EAAK,CACf7B,gBAAgB,CAAC6B,CAAC,CAACgG,MAAM,CAACF,KAAK,CAAC,CAChChG,YAAY,CAACE,CAAC,CAACgG,MAAM,CAACF,KAAK,CAAC,CAC9B,CAAE,CACFG,QAAQ,CAAE,CAACjI,WAAY,CACvB0H,SAAS,CAAC,2BAA2B,CACtC,CAAC,EACC,CAAC,CAELlK,WAAW,EACVgC,WAAW,EACXJ,gBAAgB,EAChBI,WAAW,GAAKJ,gBAAgB,eAC9BnG,KAAA,QAAKyO,SAAS,CAAC,2FAA2F,CAAAC,QAAA,EAAC,uCACpE,CAAC,GAAG,cACzC5O,IAAA,WAAA4O,QAAA,CAASvI,gBAAgB,EAAII,WAAW,CAAS,CAAC,0DACP,CAAC,GAAG,cAC/CzG,IAAA,WAAA4O,QAAA,CAASnI,WAAW,CAAS,CAAC,EAC3B,CACN,EACA,CAAC,EACH,CAAC,cAGNvG,KAAA,QAAKyO,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrC1O,KAAA,QAAA0O,QAAA,eACE5O,IAAA,UAAO2O,SAAS,CAAC,2CAA2C,CAAAC,QAAA,CAAC,YAE7D,CAAO,CAAC,cACR1O,KAAA,WACE6O,KAAK,CAAE1H,SAAU,CACjB2H,QAAQ,CAAG/F,CAAC,EAAK3B,YAAY,CAAC2B,CAAC,CAACgG,MAAM,CAACF,KAAK,CAAE,CAC9CJ,SAAS,CAAC,sCAAsC,CAAAC,QAAA,eAEhD5O,IAAA,WAAQ+O,KAAK,CAAC,QAAQ,CAAAH,QAAA,CAAC,QAAM,CAAQ,CAAC,cACtC5O,IAAA,WAAQ+O,KAAK,CAAC,SAAS,CAAAH,QAAA,CAAC,SAAO,CAAQ,CAAC,EAClC,CAAC,EACN,CAAC,cAEN1O,KAAA,QAAA0O,QAAA,eACE5O,IAAA,UAAO2O,SAAS,CAAC,2CAA2C,CAAAC,QAAA,CAAC,WAE7D,CAAO,CAAC,cACR1O,KAAA,WACE6O,KAAK,CAAExH,QAAS,CAChByH,QAAQ,CAAG/F,CAAC,EAAKzB,WAAW,CAACyB,CAAC,CAACgG,MAAM,CAACF,KAAK,CAAE,CAC7CJ,SAAS,CAAC,sCAAsC,CAAAC,QAAA,eAEhD5O,IAAA,WAAQ+O,KAAK,CAAC,QAAQ,CAAAH,QAAA,CAAC,QAAM,CAAQ,CAAC,cACtC5O,IAAA,WAAQ+O,KAAK,CAAC,SAAS,CAAAH,QAAA,CAAC,SAAO,CAAQ,CAAC,EAClC,CAAC,EACN,CAAC,cAEN1O,KAAA,QAAA0O,QAAA,eACE5O,IAAA,UAAO2O,SAAS,CAAC,2CAA2C,CAAAC,QAAA,CAAC,gBAE7D,CAAO,CAAC,cACR5O,IAAA,UACEmD,IAAI,CAAC,UAAU,CACfgM,OAAO,CAAE1H,UAAW,CACpBuH,QAAQ,CAAG/F,CAAC,EAAKvB,aAAa,CAACuB,CAAC,CAACgG,MAAM,CAACE,OAAO,CAAE,CACjDR,SAAS,CAAC,MAAM,CACjB,CAAC,EACC,CAAC,EACH,CAAC,cAGNzO,KAAA,QACEyO,SAAS,CAAC,gFAMrB,CAAAC,QAAA,eAEW1O,KAAA,UAAOyO,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACxC5O,IAAA,UACEmD,IAAI,CAAC,UAAU,CACfgM,OAAO,CAAE3K,cAAe,CACxBwK,QAAQ,CAAG/F,CAAC,EAAKtB,iBAAiB,CAACsB,CAAC,CAACgG,MAAM,CAACE,OAAO,CAAE,CACtD,CAAC,wBAEJ,EAAO,CAAC,cAERjP,KAAA,UAAOyO,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACxC5O,IAAA,UACEmD,IAAI,CAAC,UAAU,CACfgM,OAAO,CAAE1K,WAAY,CACrBuK,QAAQ,CAAG/F,CAAC,EAAKrB,cAAc,CAACqB,CAAC,CAACgG,MAAM,CAACE,OAAO,CAAE,CACnD,CAAC,qBAEJ,EAAO,CAAC,cAERjP,KAAA,UAAOyO,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACxC5O,IAAA,UACEmD,IAAI,CAAC,UAAU,CACfgM,OAAO,CAAEzK,WAAY,CACrBsK,QAAQ,CAAG/F,CAAC,EAAKpB,cAAc,CAACoB,CAAC,CAACgG,MAAM,CAACE,OAAO,CAAE,CACnD,CAAC,sBAEJ,EAAO,CAAC,EACL,CAAC,cAGNjP,KAAA,QAAA0O,QAAA,eACE5O,IAAA,UAAO2O,SAAS,CAAC,2CAA2C,CAAAC,QAAA,CAAC,aAE7D,CAAO,CAAC,cACR1O,KAAA,QAAKyO,SAAS,CAAC,8BAA8B,CAAAC,QAAA,eAC3C5O,IAAA,WACEmD,IAAI,CAAC,QAAQ,CACb0L,OAAO,CAAEA,CAAA,GAAMvG,QAAQ,CAAC,aAAa,CAAE,CACvCqG,SAAS,CAAC,sCAAsC,CACjD,CAAC,cACF3O,IAAA,WACEmD,IAAI,CAAC,QAAQ,CACb0L,OAAO,CAAEA,CAAA,GAAMvG,QAAQ,CAAC,eAAe,CAAE,CACzCqG,SAAS,CAAC,wCAAwC,CACnD,CAAC,cACF3O,IAAA,WACEmD,IAAI,CAAC,QAAQ,CACb0L,OAAO,CAAEA,CAAA,GAAMvG,QAAQ,CAAC,aAAa,CAAE,CACvCqG,SAAS,CAAC,sCAAsC,CACjD,CAAC,cACF3O,IAAA,WACEmD,IAAI,CAAC,QAAQ,CACb0L,OAAO,CAAEA,CAAA,GAAMvG,QAAQ,CAAC,cAAc,CAAE,CACxCqG,SAAS,CAAC,uCAAuC,CAClD,CAAC,EACC,CAAC,EACH,CAAC,cAGNzO,KAAA,QAAKyO,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7B5O,IAAA,WACEmD,IAAI,CAAC,QAAQ,CACbwL,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CACvD,oBAED,CAAQ,CAAC,cAET5O,IAAA,WACEmD,IAAI,CAAC,QAAQ,CACb0L,OAAO,CAAEA,CAAA,GAAM,CACb/G,SAAS,CAAC,IAAI,CAAC,CACfC,iBAAiB,CAAC,IAAI,CAAC,CACvBE,OAAO,CAAC,EAAE,CAAC,CACXnB,iBAAiB,CAAC,KAAK,CAAC,CACxBI,cAAc,CAAC,KAAK,CAAC,CACrBd,oBAAoB,CAACF,UAAU,CAAC,CAChCM,mBAAmB,CAACN,UAAU,CAAC,CAC/BI,mBAAmB,CAAC,EAAE,CAAC,CACvBI,cAAc,CAAC,EAAE,CAAC,CAClBU,gBAAgB,CAAC,EAAE,CAAC,CACpBO,iBAAiB,CAAC,KAAK,CAAC,CACxBC,cAAc,CAAC,KAAK,CAAC,CACrBC,cAAc,CAAC,KAAK,CAAC,CACvB,CAAE,CACF8G,SAAS,CAAC,0BAA0B,CAAAC,QAAA,CACrC,OAED,CAAQ,CAAC,EACN,CAAC,CAEL5G,IAAI,eACHhI,IAAA,QAAK2O,SAAS,CAAC,qDAAqD,CAAAC,QAAA,CACjE5G,IAAI,CACF,CACN,EACG,CAAC,CACJ,CAAC,CACLpG,WAAW,eACV1B,KAAA,QAAKyO,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAC/C5O,IAAA,OAAI2O,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,wBAE3C,CAAI,CAAC,CAEJhN,WAAW,CAACkD,GAAG,CAAC,CAACtC,CAAC,CAAEC,CAAC,gBACpBvC,KAAA,QAEEyO,SAAS,CAAC,iDAAiD,CAAAC,QAAA,eAE3D1O,KAAA,QAAKyO,SAAS,CAAC,oCAAoC,CAAAC,QAAA,EAChDpM,CAAC,CAACY,IAAI,CAAC,QAAM,CAACX,CAAC,CAAG,CAAC,CACnBb,WAAW,CAACgC,MAAM,GAAK,CAAC,eACvB1D,KAAA,UAAOyO,SAAS,CAAC,iCAAiC,CAAAC,QAAA,eAChD5O,IAAA,UACEmD,IAAI,CAAC,UAAU,CACfgM,OAAO,CAAE3M,CAAC,CAACsH,MAAO,CAClBkF,QAAQ,CAAEA,CAAA,GAAM,CACd9G,cAAc,CAAEmH,IAAI,EAClBA,IAAI,CAACvK,GAAG,CAAC,CAACwK,CAAC,CAAEvK,GAAG,GACdA,GAAG,GAAKtC,CAAC,CAAAiD,aAAA,CAAAA,aAAA,IAAQ4J,CAAC,MAAExF,MAAM,CAAE,CAACwF,CAAC,CAACxF,MAAM,GAAKwF,CAC5C,CACF,CAAC,CACH,CAAE,CACH,CAAC,OAEJ,EAAO,CACR,EACE,CAAC,cAENpP,KAAA,QAAKyO,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC5O,IAAA,WACE6O,OAAO,CAAEA,CAAA,GAAMvE,cAAc,CAAC7H,CAAC,CAAE,CAAC,CAAC,CAAE,CACrCkM,SAAS,CAAC,0BAA0B,CAAAC,QAAA,CACrC,QAED,CAAQ,CAAC,cACT5O,IAAA,SAAM2O,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAAEpM,CAAC,CAACI,WAAW,CAAO,CAAC,cACxD5C,IAAA,WACE6O,OAAO,CAAEA,CAAA,GAAMvE,cAAc,CAAC7H,CAAC,CAAE,CAAC,CAAC,CAAE,CACrCkM,SAAS,CAAC,0BAA0B,CAAAC,QAAA,CACrC,GAED,CAAQ,CAAC,EACN,CAAC,GArCDnM,CAsCF,CACN,CAAC,CAED0F,mBAAmB,eAClBnI,IAAA,QAAK2O,SAAS,CAAC,kDAAkD,CAAAC,QAAA,CAAC,uHAGlE,CAAK,CACN,EACE,CACN,cAGD5O,IAAA,QAAK2O,SAAS,CAAC,MAAM,CAAAC,QAAA,CAClBrK,MAAM,cACLvE,IAAA,CAAAI,SAAA,EAAAwO,QAAA,cACE5O,IAAA,QAAK2O,SAAS,CAAC,MAAM,CAAAC,QAAA,cACnB5O,IAAA,CAACH,eAAe,EACd0P,IAAI,CAAE5N,cAAc,EAAI4C,MAAO,CAC/BiL,GAAG,CAAEjL,MAAO,CACZC,cAAc,CAAEA,cAAe,CAC/BC,WAAW,CAAEA,WAAY,CACzBC,WAAW,CAAEA,WAAY,CACzB+K,UAAU,CAAEpH,KAAM,CAClB4C,QAAQ,CAAEA,CAAA,GAAMA,QAAQ,CAAC,CAAE,CAC5B,CAAC,CACC,CAAC,CACN,CAAC,cAEHjL,IAAA,QAAK2O,SAAS,CAAC,iDAAiD,CAAAC,QAAA,CAAC,sCAEjE,CAAK,CACN,CACE,CAAC,EACH,CAAC,EACH,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}