{"ast":null,"code":"import _objectSpread from\"C:/Users/Taj Tech/Downloads/umrah-calculator/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/services/packageService.js\n// Ø³Ø§Ø¯Û package service: LocalStorage Ù…ÛŒÚº packages save / list / load / delete Ú©Ø±ØªØ§ ÛÛ’\n// Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±Ù†Û’ Ú©Ø§ Ø·Ø±ÛŒÙ‚Û (Ù…Ø«Ù„Ø§Ù‹): import { savePackage, listPackages } from \"../services/packageService\";\nimport{v4 as uuidv4}from\"uuid\";// LocalStorage key\nconst STORAGE_KEY=\"umrah_packages\";/**\r\n * helper: read packages array from localStorage (safe)\r\n */function _readAll(){try{const raw=localStorage.getItem(STORAGE_KEY);if(!raw)return[];const arr=JSON.parse(raw);if(!Array.isArray(arr))return[];return arr;}catch(err){console.error(\"packageService: read error\",err);return[];}}/**\r\n * helper: write packages array to localStorage\r\n */function _writeAll(arr){try{localStorage.setItem(STORAGE_KEY,JSON.stringify(arr||[]));return true;}catch(err){console.error(\"packageService: write error\",err);return false;}}/**\r\n * Save a consolidated package snapshot.\r\n * - If pkg.id present -> update existing\r\n * - If no id -> create new id + createdAt\r\n * Returns saved package object (with id and createdAt) or null on failure.\r\n *\r\n * Expect pkg to be a plain object with fields:\r\n * { agency, itinerary, hotelsSelected, flights, visa, transport, pax, profit, totals, ... }\r\n */export function savePackage(pkg){console.log(\"ðŸ”¥ savePackage CALLED\",pkg);try{const all=_readAll();const now=new Date().toISOString();let toSave=_objectSpread({},pkg||{});if(!toSave.id){toSave.id=\"pkg_\".concat(uuidv4());toSave.createdAt=now;}else if(!toSave.createdAt){toSave.createdAt=now;}toSave.updatedAt=now;// minimal normalization: ensure totals object\nif(!toSave.totals)toSave.totals={};// if itinerary not provided, try to grab umrah_last_plan from localStorage\nif(!toSave.itinerary){try{const last=localStorage.getItem(\"umrah_last_plan\");if(last)toSave.itinerary=JSON.parse(last);}catch(e){// ignore\n}}// update existing if present\nconst idx=all.findIndex(x=>x.id===toSave.id);if(idx>=0){all[idx]=toSave;}else{all.unshift(toSave);// newest first\n}const ok=_writeAll(all);return ok?toSave:null;}catch(err){console.error(\"packageService.savePackage error\",err);return null;}}/**\r\n * List all saved packages (most recent first)\r\n */export function listPackages(){return _readAll();}/**\r\n * Load a single package by id (returns object or null)\r\n */export function loadPackage(id){if(!id)return null;const all=_readAll();return all.find(p=>p.id===id)||null;}/**\r\n * Delete package by id. Returns true if deleted, false otherwise.\r\n */export function deletePackage(id){if(!id)return false;const all=_readAll();const next=all.filter(p=>p.id!==id);if(next.length===all.length)return false;// nothing removed\nreturn _writeAll(next);}/**\r\n * Replace (overwrite) a package fully (must contain id).\r\n * Returns saved package or null.\r\n */export function replacePackage(pkg){if(!pkg||!pkg.id)return null;return savePackage(pkg);}export default{savePackage,listPackages,loadPackage,deletePackage,replacePackage};","map":{"version":3,"names":["v4","uuidv4","STORAGE_KEY","_readAll","raw","localStorage","getItem","arr","JSON","parse","Array","isArray","err","console","error","_writeAll","setItem","stringify","savePackage","pkg","log","all","now","Date","toISOString","toSave","_objectSpread","id","concat","createdAt","updatedAt","totals","itinerary","last","e","idx","findIndex","x","unshift","ok","listPackages","loadPackage","find","p","deletePackage","next","filter","length","replacePackage"],"sources":["C:/Users/Taj Tech/Downloads/umrah-calculator/src/services/packageService.js"],"sourcesContent":["// src/services/packageService.js\r\n// Ø³Ø§Ø¯Û package service: LocalStorage Ù…ÛŒÚº packages save / list / load / delete Ú©Ø±ØªØ§ ÛÛ’\r\n// Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±Ù†Û’ Ú©Ø§ Ø·Ø±ÛŒÙ‚Û (Ù…Ø«Ù„Ø§Ù‹): import { savePackage, listPackages } from \"../services/packageService\";\r\n\r\nimport { v4 as uuidv4 } from \"uuid\";\r\n\r\n// LocalStorage key\r\nconst STORAGE_KEY = \"umrah_packages\";\r\n\r\n/**\r\n * helper: read packages array from localStorage (safe)\r\n */\r\nfunction _readAll() {\r\n  try {\r\n    const raw = localStorage.getItem(STORAGE_KEY);\r\n    if (!raw) return [];\r\n    const arr = JSON.parse(raw);\r\n    if (!Array.isArray(arr)) return [];\r\n    return arr;\r\n  } catch (err) {\r\n    console.error(\"packageService: read error\", err);\r\n    return [];\r\n  }\r\n}\r\n\r\n/**\r\n * helper: write packages array to localStorage\r\n */\r\nfunction _writeAll(arr) {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(arr || []));\r\n    return true;\r\n  } catch (err) {\r\n    console.error(\"packageService: write error\", err);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Save a consolidated package snapshot.\r\n * - If pkg.id present -> update existing\r\n * - If no id -> create new id + createdAt\r\n * Returns saved package object (with id and createdAt) or null on failure.\r\n *\r\n * Expect pkg to be a plain object with fields:\r\n * { agency, itinerary, hotelsSelected, flights, visa, transport, pax, profit, totals, ... }\r\n */\r\nexport function savePackage(pkg) {\r\n  console.log(\"ðŸ”¥ savePackage CALLED\", pkg);\r\n\r\n  try {\r\n    const all = _readAll();\r\n\r\n    const now = new Date().toISOString();\r\n    let toSave = { ...(pkg || {}) };\r\n\r\n    if (!toSave.id) {\r\n      toSave.id = `pkg_${uuidv4()}`;\r\n      toSave.createdAt = now;\r\n    } else if (!toSave.createdAt) {\r\n      toSave.createdAt = now;\r\n    }\r\n    toSave.updatedAt = now;\r\n\r\n    // minimal normalization: ensure totals object\r\n    if (!toSave.totals) toSave.totals = {};\r\n\r\n    // if itinerary not provided, try to grab umrah_last_plan from localStorage\r\n    if (!toSave.itinerary) {\r\n      try {\r\n        const last = localStorage.getItem(\"umrah_last_plan\");\r\n        if (last) toSave.itinerary = JSON.parse(last);\r\n      } catch (e) {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    // update existing if present\r\n    const idx = all.findIndex((x) => x.id === toSave.id);\r\n    if (idx >= 0) {\r\n      all[idx] = toSave;\r\n    } else {\r\n      all.unshift(toSave); // newest first\r\n    }\r\n\r\n    const ok = _writeAll(all);\r\n    return ok ? toSave : null;\r\n  } catch (err) {\r\n    console.error(\"packageService.savePackage error\", err);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * List all saved packages (most recent first)\r\n */\r\nexport function listPackages() {\r\n  return _readAll();\r\n}\r\n\r\n/**\r\n * Load a single package by id (returns object or null)\r\n */\r\nexport function loadPackage(id) {\r\n  if (!id) return null;\r\n  const all = _readAll();\r\n  return all.find((p) => p.id === id) || null;\r\n}\r\n\r\n/**\r\n * Delete package by id. Returns true if deleted, false otherwise.\r\n */\r\nexport function deletePackage(id) {\r\n  if (!id) return false;\r\n  const all = _readAll();\r\n  const next = all.filter((p) => p.id !== id);\r\n  if (next.length === all.length) return false; // nothing removed\r\n  return _writeAll(next);\r\n}\r\n\r\n/**\r\n * Replace (overwrite) a package fully (must contain id).\r\n * Returns saved package or null.\r\n */\r\nexport function replacePackage(pkg) {\r\n  if (!pkg || !pkg.id) return null;\r\n  return savePackage(pkg);\r\n}\r\n\r\nexport default {\r\n  savePackage,\r\n  listPackages,\r\n  loadPackage,\r\n  deletePackage,\r\n  replacePackage,\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}