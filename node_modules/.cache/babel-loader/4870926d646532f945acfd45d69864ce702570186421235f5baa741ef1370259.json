{"ast":null,"code":"import _objectSpread from\"C:/Users/Taj Tech/Downloads/umrah-calculator/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/utils/manualAdjuster.js\n// Manual adjustment helper for TripPlanner\n// Purpose:\n// - Adjust days (+ / -) for a specific stay\n// - Keep TOTAL DAYS FIXED (never allow overflow)\n// - Respect LOCKED stays (only when 3 stays)\n// - Recalculate dates chain (check-in / check-out)\n// - Detect Friday travel (WARNING only, no auto-fix)\n// - Emit WARNING when balance is NOT possible\nfunction parseIsoToDate(iso){if(!iso)return null;const[y,m,d]=iso.split(\"-\").map(Number);return new Date(y,m-1,d);}function formatDate(d){const yyyy=d.getFullYear();const mm=String(d.getMonth()+1).padStart(2,\"0\");const dd=String(d.getDate()).padStart(2,\"0\");return\"\".concat(yyyy,\"-\").concat(mm,\"-\").concat(dd);}function addDays(date,n){const d=new Date(date.getFullYear(),date.getMonth(),date.getDate());d.setDate(d.getDate()+n);return d;}function isFriday(date){return date.getDay()===5;}/**\r\n * adjustStaysManually\r\n *\r\n * @param {Array} stays\r\n *   Each stay must have:\r\n *   - city\r\n *   - displayDays\r\n *   - isoCheckIn\r\n *   - locked (boolean)\r\n *\r\n * @param {number} targetIndex\r\n * @param {number} delta (+1 / -1)\r\n *\r\n * @returns {Object}\r\n * {\r\n *   stays,\r\n *   fridayWarning,\r\n *   balanceWarning\r\n * }\r\n */export function adjustStaysManually(stays,targetIndex,delta){if(!Array.isArray(stays)){return{stays,fridayWarning:false,balanceWarning:false};}// Deep copy\nconst updated=stays.map(s=>_objectSpread({},s));const target=updated[targetIndex];if(!target){return{stays:updated,fridayWarning:false,balanceWarning:false};}const useLock=updated.length===3;// Locked target cannot be changed\nif(useLock&&target.locked){return{stays:updated,fridayWarning:false,balanceWarning:true};}// Minimum 1 day rule\nif(target.displayDays+delta<1){return{stays:updated,fridayWarning:false,balanceWarning:true};}// ------------------------------------\n// BALANCE CHECK (BEFORE APPLYING DELTA)\n// ------------------------------------\nlet balanceIndex=-1;if(delta>0){// Need some other stay to GIVE 1 day\nlet maxDays=0;updated.forEach((s,i)=>{if(i===targetIndex)return;if(useLock&&s.locked)return;if(s.displayDays>1&&s.displayDays>maxDays){maxDays=s.displayDays;balanceIndex=i;}});// ❌ No stay available to reduce → BLOCK\nif(balanceIndex===-1){return{stays:updated,fridayWarning:false,balanceWarning:true};}}if(delta<0){// Need some other stay to RECEIVE 1 day\nlet minDays=Infinity;updated.forEach((s,i)=>{if(i===targetIndex)return;if(useLock&&s.locked)return;if(s.displayDays<minDays){minDays=s.displayDays;balanceIndex=i;}});// ❌ No stay available to add → BLOCK\nif(balanceIndex===-1){return{stays:updated,fridayWarning:false,balanceWarning:true};}}// ------------------------------------\n// APPLY DELTA (SAFE NOW)\n// ------------------------------------\ntarget.displayDays+=delta;if(delta>0&&balanceIndex!==-1){updated[balanceIndex].displayDays-=1;}if(delta<0&&balanceIndex!==-1){updated[balanceIndex].displayDays+=1;}// ------------------------------------\n// REBUILD DATE CHAIN\n// ------------------------------------\nlet fridayWarning=false;let cursor=parseIsoToDate(updated[0].isoCheckIn);updated.forEach((s,i)=>{s.isoCheckIn=formatDate(cursor);const lastNight=addDays(cursor,s.displayDays-1);const checkOut=addDays(lastNight,1);if(i<updated.length-1&&isFriday(checkOut)){fridayWarning=true;}s.isoLastNight=formatDate(lastNight);s.isoCheckOutDay=formatDate(checkOut);cursor=checkOut;});return{stays:updated,fridayWarning,balanceWarning:false};}","map":{"version":3,"names":["parseIsoToDate","iso","y","m","d","split","map","Number","Date","formatDate","yyyy","getFullYear","mm","String","getMonth","padStart","dd","getDate","concat","addDays","date","n","setDate","isFriday","getDay","adjustStaysManually","stays","targetIndex","delta","Array","isArray","fridayWarning","balanceWarning","updated","s","_objectSpread","target","useLock","length","locked","displayDays","balanceIndex","maxDays","forEach","i","minDays","Infinity","cursor","isoCheckIn","lastNight","checkOut","isoLastNight","isoCheckOutDay"],"sources":["C:/Users/Taj Tech/Downloads/umrah-calculator/src/utils/manualAdjuster.js"],"sourcesContent":["// src/utils/manualAdjuster.js\r\n// Manual adjustment helper for TripPlanner\r\n// Purpose:\r\n// - Adjust days (+ / -) for a specific stay\r\n// - Keep TOTAL DAYS FIXED (never allow overflow)\r\n// - Respect LOCKED stays (only when 3 stays)\r\n// - Recalculate dates chain (check-in / check-out)\r\n// - Detect Friday travel (WARNING only, no auto-fix)\r\n// - Emit WARNING when balance is NOT possible\r\n\r\nfunction parseIsoToDate(iso) {\r\n  if (!iso) return null;\r\n  const [y, m, d] = iso.split(\"-\").map(Number);\r\n  return new Date(y, m - 1, d);\r\n}\r\n\r\nfunction formatDate(d) {\r\n  const yyyy = d.getFullYear();\r\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n  const dd = String(d.getDate()).padStart(2, \"0\");\r\n  return `${yyyy}-${mm}-${dd}`;\r\n}\r\n\r\nfunction addDays(date, n) {\r\n  const d = new Date(date.getFullYear(), date.getMonth(), date.getDate());\r\n  d.setDate(d.getDate() + n);\r\n  return d;\r\n}\r\n\r\nfunction isFriday(date) {\r\n  return date.getDay() === 5;\r\n}\r\n\r\n/**\r\n * adjustStaysManually\r\n *\r\n * @param {Array} stays\r\n *   Each stay must have:\r\n *   - city\r\n *   - displayDays\r\n *   - isoCheckIn\r\n *   - locked (boolean)\r\n *\r\n * @param {number} targetIndex\r\n * @param {number} delta (+1 / -1)\r\n *\r\n * @returns {Object}\r\n * {\r\n *   stays,\r\n *   fridayWarning,\r\n *   balanceWarning\r\n * }\r\n */\r\nexport function adjustStaysManually(stays, targetIndex, delta) {\r\n  if (!Array.isArray(stays)) {\r\n    return { stays, fridayWarning: false, balanceWarning: false };\r\n  }\r\n\r\n  // Deep copy\r\n  const updated = stays.map((s) => ({ ...s }));\r\n\r\n  const target = updated[targetIndex];\r\n  if (!target) {\r\n    return { stays: updated, fridayWarning: false, balanceWarning: false };\r\n  }\r\n\r\n  const useLock = updated.length === 3;\r\n\r\n  // Locked target cannot be changed\r\n  if (useLock && target.locked) {\r\n    return { stays: updated, fridayWarning: false, balanceWarning: true };\r\n  }\r\n\r\n  // Minimum 1 day rule\r\n  if (target.displayDays + delta < 1) {\r\n    return { stays: updated, fridayWarning: false, balanceWarning: true };\r\n  }\r\n\r\n  // ------------------------------------\r\n  // BALANCE CHECK (BEFORE APPLYING DELTA)\r\n  // ------------------------------------\r\n  let balanceIndex = -1;\r\n\r\n  if (delta > 0) {\r\n    // Need some other stay to GIVE 1 day\r\n    let maxDays = 0;\r\n    updated.forEach((s, i) => {\r\n      if (i === targetIndex) return;\r\n      if (useLock && s.locked) return;\r\n      if (s.displayDays > 1 && s.displayDays > maxDays) {\r\n        maxDays = s.displayDays;\r\n        balanceIndex = i;\r\n      }\r\n    });\r\n\r\n    // ❌ No stay available to reduce → BLOCK\r\n    if (balanceIndex === -1) {\r\n      return {\r\n        stays: updated,\r\n        fridayWarning: false,\r\n        balanceWarning: true,\r\n      };\r\n    }\r\n  }\r\n\r\n  if (delta < 0) {\r\n    // Need some other stay to RECEIVE 1 day\r\n    let minDays = Infinity;\r\n    updated.forEach((s, i) => {\r\n      if (i === targetIndex) return;\r\n      if (useLock && s.locked) return;\r\n      if (s.displayDays < minDays) {\r\n        minDays = s.displayDays;\r\n        balanceIndex = i;\r\n      }\r\n    });\r\n\r\n    // ❌ No stay available to add → BLOCK\r\n    if (balanceIndex === -1) {\r\n      return {\r\n        stays: updated,\r\n        fridayWarning: false,\r\n        balanceWarning: true,\r\n      };\r\n    }\r\n  }\r\n\r\n  // ------------------------------------\r\n  // APPLY DELTA (SAFE NOW)\r\n  // ------------------------------------\r\n  target.displayDays += delta;\r\n\r\n  if (delta > 0 && balanceIndex !== -1) {\r\n    updated[balanceIndex].displayDays -= 1;\r\n  }\r\n\r\n  if (delta < 0 && balanceIndex !== -1) {\r\n    updated[balanceIndex].displayDays += 1;\r\n  }\r\n\r\n  // ------------------------------------\r\n  // REBUILD DATE CHAIN\r\n  // ------------------------------------\r\n  let fridayWarning = false;\r\n\r\n  let cursor = parseIsoToDate(updated[0].isoCheckIn);\r\n\r\n  updated.forEach((s, i) => {\r\n    s.isoCheckIn = formatDate(cursor);\r\n\r\n    const lastNight = addDays(cursor, s.displayDays - 1);\r\n    const checkOut = addDays(lastNight, 1);\r\n\r\n    if (i < updated.length - 1 && isFriday(checkOut)) {\r\n      fridayWarning = true;\r\n    }\r\n\r\n    s.isoLastNight = formatDate(lastNight);\r\n    s.isoCheckOutDay = formatDate(checkOut);\r\n\r\n    cursor = checkOut;\r\n  });\r\n\r\n  return {\r\n    stays: updated,\r\n    fridayWarning,\r\n    balanceWarning: false,\r\n  };\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}