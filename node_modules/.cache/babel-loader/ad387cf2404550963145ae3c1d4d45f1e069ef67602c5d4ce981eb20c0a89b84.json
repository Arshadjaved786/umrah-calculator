{"ast":null,"code":"import _objectSpread from\"C:/Users/Taj Tech/Downloads/umrah-calculator/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/pages/UmrahCalculator.jsx\nimport React,{useState,useEffect,useMemo,useRef}from\"react\";import{v4 as uuidv4}from\"uuid\";import useLocalStorage from\"../hooks/useLocalStorage\";import{getMakkahHotels,getMadinahHotels,clearHotelCache}from\"../services/hotelService\";import{useApp}from\"../contexts/AppContext\";import AgencyForm from\"../components/AgencyForm\";import HotelCard from\"../components/HotelCard\";import HotelManager from\"../components/HotelManager\";import TicketsVisa from\"../components/TicketsVisa\";import Summary from\"../components/Summary\";import SavedPackages from\"../components/SavedPackages\";import Footer from\"../components/Footer\";import{savePackage as savePkgService,listPackages}from\"../services/packageService\";/**\r\n * UmrahCalculator page\r\n * - includes new filters UI for hotels (Makkah + Madinah)\r\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function UmrahCalculator(){const{agency}=useApp();const[showAgencyForm,setShowAgencyForm]=useState(!agency);useEffect(()=>{setShowAgencyForm(!agency);},[agency]);// MAIN hotel states\nconst[makkah,setMakkah]=useState({name:\"\",nights:3,pricePerNight:0,soldOut:false,weekendNights:0,weekendPrice:\"\"});const[madinah,setMadinah]=useState({name:\"\",nights:2,pricePerNight:0,soldOut:false,weekendNights:0,weekendPrice:\"\"});const[makkahList,setMakkahList]=useState([]);const[madinahList,setMadinahList]=useState([]);const[loadingHotels,setLoadingHotels]=useState(true);const[makkahQuery,setMakkahQuery]=useState(\"\");const[madinahQuery,setMadinahQuery]=useState(\"\");const[managerOpen,setManagerOpen]=useState(false);// --- NEW: filters state for each city (supports multi-filter) ---\nconst[makkahFilters,setMakkahFilters]=useState({star:\"all\",// all / 5 /4 /3 /2 /1\nmaxPrice:\"\",maxDistance:\"\",// in meters (user types number)\nsortBy:\"relevance\"// relevance / price / distance / stars\n});const[madinahFilters,setMadinahFilters]=useState({star:\"all\",maxPrice:\"\",maxDistance:\"\",sortBy:\"relevance\"});// custom dropdown UI state (for Makkah + Madinah search results)\nconst[makkahShowList,setMakkahShowList]=useState(false);const[madinahShowList,setMadinahShowList]=useState(false);const makkahRef=useRef(null);const madinahRef=useRef(null);// keyboard focus index for dropdown items\nconst[makkahFocus,setMakkahFocus]=useState(-1);const[madinahFocus,setMadinahFocus]=useState(-1);// --- close dropdowns when clicking outside ---\nuseEffect(()=>{function onDocClick(e){if(makkahRef.current&&!makkahRef.current.contains(e.target)){setMakkahShowList(false);}if(madinahRef.current&&!madinahRef.current.contains(e.target)){setMadinahShowList(false);}}document.addEventListener(\"click\",onDocClick);return()=>document.removeEventListener(\"click\",onDocClick);},[]);// ticket / pax / profit states\nconst[pax,setPax]=useState(1);const[ticketPrice,setTicketPrice]=useState(0);const[ticketCurrency,setTicketCurrency]=useState(\"SAR\");// selected airline and vehicle lifted to parent so we can save them in package snapshot\nconst[selectedAirline,setSelectedAirline]=useState(null);const[vehicle,setVehicle]=useState(\"CAR\");// NEW: profit amount + currency\nconst[profit,setProfit]=useState(0);const[profitCurrency,setProfitCurrency]=useState(\"SAR\");const[rates,setRates]=useLocalStorage(\"umrah_rates\",{SAR_to_PKR:75,USD_to_SAR:3.75});// keep default visa SAR (user can edit it)\nconst[defaultVisaSAR,setDefaultVisaSAR]=useLocalStorage(\"umrah_defaultVisaSAR\",300);// TRANSPORT total\nconst[transportTotal,setTransportTotal]=useState(0);const[packages,setPackages]=useLocalStorage(\"umrah_packages\",[]);// -------------------------\n// Load hotel lists\n// -------------------------\nconst loadLists=async()=>{setLoadingHotels(true);try{const mList=await getMakkahHotels();const mdList=await getMadinahHotels();// ðŸ”´ FINAL SOURCE OF TRUTH: TripPlanner COUNTED data\ntry{const rawPlan=localStorage.getItem(\"umrah_last_plan\");if(rawPlan){const plan=JSON.parse(rawPlan);const stays=plan.adjustedStays||(plan.segments||[]).filter(s=>s.type===\"stay\");const sum=arr=>arr.reduce((acc,s)=>acc+Number(s.countedDays||0),0);const makkahStays=stays.filter(s=>s.city===\"makkah\");const madinahStays=stays.filter(s=>s.city===\"madinah\");const sumWeekend=arr=>arr.reduce((acc,s)=>acc+(Array.isArray(s.weekendDates)?s.weekendDates.length:0),0);if(makkahStays.length){setMakkah(s=>_objectSpread(_objectSpread({},s),{},{nights:sum(makkahStays),weekendNights:sumWeekend(makkahStays)}));}if(madinahStays.length){setMadinah(s=>_objectSpread(_objectSpread({},s),{},{nights:sum(madinahStays),weekendNights:sumWeekend(madinahStays)}));}}}catch(e){console.warn(\"Failed to read counted nights from umrah_last_plan\",e);}setMakkahList(mList||[]);setMadinahList(mdList||[]);if((!makkah.name||makkah.name===\"\")&&mList.length>0){const first=mList[0];setMakkah(s=>_objectSpread(_objectSpread({},s),{},{name:first.name,pricePerNight:first.pricePerNight}));}if((!madinah.name||madinah.name===\"\")&&mdList.length>0){const first=mdList[0];setMadinah(s=>_objectSpread(_objectSpread({},s),{},{name:first.name,pricePerNight:first.pricePerNight}));}}finally{setLoadingHotels(false);}};useEffect(()=>{loadLists();},[]);// ---------------------------------------------------\n// Filters function (now accepts filters object)\n// ---------------------------------------------------\nfunction parseDistanceToMeters(dist){// expected formats: \"350m\", \"1.2 km\", \"1200 m\", \"0.5km\"\nif(!dist)return null;const s=String(dist).trim().toLowerCase();const num=parseFloat(s.replace(\",\",\".\").replace(/[^\\d.]/g,\"\"));if(s.includes(\"km\"))return Math.round(num*1000);if(s.includes(\"m\"))return Math.round(num);// fallback treat as meters if numeric\nif(!Number.isNaN(num))return Math.round(num);return null;}const filterHotels=(list,query,filters)=>{const q=(query||\"\").trim().toLowerCase();// pre-calc numeric filters\nconst maxPrice=filters&&filters.maxPrice!==\"\"?Number(filters.maxPrice):null;const maxDistance=filters&&filters.maxDistance!==\"\"?Number(filters.maxDistance):null;const starFilter=filters&&filters.star?filters.star:\"all\";let out=(list||[]).filter(h=>{// star filter\nif(starFilter!==\"all\"){if(String(h.stars)!==String(starFilter))return false;}// price filter (if hotel has pricePerNight field)\nif(maxPrice!==null&&h.pricePerNight!==undefined&&h.pricePerNight!==\"\"){if(Number(h.pricePerNight)>maxPrice)return false;}// distance filter\nif(maxDistance!==null&&h.distance){const d=parseDistanceToMeters(h.distance);if(d!==null&&d>maxDistance)return false;}// query matching (name or distance)\nif(!q)return true;if(h.name&&h.name.toLowerCase().includes(q))return true;if(h.distance&&String(h.distance).toLowerCase().includes(q))return true;return false;});// sorting\nif(filters&&filters.sortBy&&filters.sortBy!==\"relevance\"){if(filters.sortBy===\"price\"){out=out.sort((a,b)=>Number(a.pricePerNight||0)-Number(b.pricePerNight||0));}else if(filters.sortBy===\"distance\"){out=out.sort((a,b)=>{const da=parseDistanceToMeters(a.distance)||0;const db=parseDistanceToMeters(b.distance)||0;return da-db;});}else if(filters.sortBy===\"stars\"){out=out.sort((a,b)=>Number(b.stars||0)-Number(a.stars||0));}}return out;};const filteredMakkah=useMemo(()=>filterHotels(makkahList,makkahQuery,makkahFilters),[makkahList,makkahQuery,makkahFilters]);const filteredMadinah=useMemo(()=>filterHotels(madinahList,madinahQuery,madinahFilters),[madinahList,madinahQuery,madinahFilters]);// --- Keyboard + dropdown helpers (same as before) ---\nuseEffect(()=>{if(!makkahShowList)setMakkahFocus(-1);},[makkahShowList,filteredMakkah]);useEffect(()=>{if(!madinahShowList)setMadinahFocus(-1);},[madinahShowList,filteredMadinah]);function selectMakkahByIndex(i){const h=filteredMakkah[i];if(!h)return;setMakkah(s=>_objectSpread(_objectSpread({},s),{},{name:h.name,pricePerNight:h.pricePerNight}));setMakkahQuery(\"\".concat(h.name,\" \\u2014 \").concat(h.stars,\"\\u2605 \\u2014 \").concat(h.distance,\" \\u2014 SAR \").concat(h.pricePerNight));setMakkahShowList(false);setMakkahFocus(-1);}function selectMadinahByIndex(i){const h=filteredMadinah[i];if(!h)return;setMadinah(s=>_objectSpread(_objectSpread({},s),{},{name:h.name,pricePerNight:h.pricePerNight}));setMadinahQuery(\"\".concat(h.name,\" \\u2014 \").concat(h.stars,\"\\u2605 \\u2014 \").concat(h.distance,\" \\u2014 SAR \").concat(h.pricePerNight));setMadinahShowList(false);setMadinahFocus(-1);}function handleMakkahKeyDown(e){if(e.key===\"ArrowDown\"){e.preventDefault();setMakkahShowList(true);setMakkahFocus(prev=>{if(filteredMakkah.length===0)return-1;if(prev===-1)return 0;return Math.min(prev+1,filteredMakkah.length-1);});return;}if(e.key===\"ArrowUp\"){e.preventDefault();setMakkahFocus(prev=>{if(filteredMakkah.length===0)return-1;if(prev<=0)return 0;return prev-1;});return;}if(e.key===\"Enter\"){if(makkahFocus>=0){e.preventDefault();selectMakkahByIndex(makkahFocus);}return;}if(e.key===\"Escape\"){setMakkahShowList(false);setMakkahFocus(-1);return;}}function handleMadinahKeyDown(e){if(e.key===\"ArrowDown\"){e.preventDefault();setMadinahShowList(true);setMadinahFocus(prev=>{if(filteredMadinah.length===0)return-1;if(prev===-1)return 0;return Math.min(prev+1,filteredMadinah.length-1);});return;}if(e.key===\"ArrowUp\"){e.preventDefault();setMadinahFocus(prev=>{if(filteredMadinah.length===0)return-1;if(prev<=0)return 0;return prev-1;});return;}if(e.key===\"Enter\"){if(madinahFocus>=0){e.preventDefault();selectMadinahByIndex(madinahFocus);}return;}if(e.key===\"Escape\"){setMadinahShowList(false);setMadinahFocus(-1);return;}}useEffect(()=>{if(makkahFocus>=0){const el=document.getElementById(\"makkah-item-\".concat(makkahFocus));if(el)el.scrollIntoView({block:\"nearest\"});}},[makkahFocus]);useEffect(()=>{if(madinahFocus>=0){const el=document.getElementById(\"madinah-item-\".concat(madinahFocus));if(el)el.scrollIntoView({block:\"nearest\"});}},[madinahFocus]);// price calculation\nconst makkahNights=Number(makkah.nights)||0;const makkahPrice=Number(makkah.pricePerNight)||0;const madinahNights=Number(madinah.nights)||0;const madinahPrice=Number(madinah.pricePerNight)||0;const makTotal=makkahNights*makkahPrice;const madTotal=madinahNights*madinahPrice;const ticketPriceInSAR=ticketCurrency===\"USD\"?ticketPrice*rates.USD_to_SAR:ticketCurrency===\"PKR\"?ticketPrice/rates.SAR_to_PKR:ticketPrice;const visaSAR=Number(defaultVisaSAR)||0;const _profit=Number(profit)||0;let profitInSAR=0;if(_profit>0){if(profitCurrency===\"SAR\"){profitInSAR=_profit;}else if(profitCurrency===\"USD\"){profitInSAR=_profit*Number(rates.USD_to_SAR||3.75);}else if(profitCurrency===\"PKR\"){profitInSAR=_profit/Number(rates.SAR_to_PKR||75);}}const perPersonTotalSAR=(Number(makTotal)||0)+(Number(madTotal)||0)+(Number(ticketPriceInSAR)||0)+(Number(visaSAR)||0)+(Number(transportTotal)||0)+(Number(profitInSAR)||0);const totalSAR=perPersonTotalSAR*Math.max(1,Number(pax||1));const totalPKR=totalSAR*Number(rates.SAR_to_PKR||75);const totalUSD=totalSAR/Number(rates.USD_to_SAR||3.75);// ---------------------------------------------------\n// When user selects a hotel from dropdown (not used by new filters)\n// ---------------------------------------------------\nconst handleSelectMakkah=e=>{const id=e.target.value;const h=makkahList.find(x=>x.id===id);if(h){setMakkah(s=>_objectSpread(_objectSpread({},s),{},{name:h.name,pricePerNight:h.pricePerNight}));}};const handleSelectMadinah=e=>{const id=e.target.value;const h=madinahList.find(x=>x.id===id);if(h){setMadinah(s=>_objectSpread(_objectSpread({},s),{},{name:h.name,pricePerNight:h.pricePerNight}));}};// ---------------------------------------------------\n// SAVE PACKAGE (upgraded -> consolidated snapshot)\n// ---------------------------------------------------\nconst savePackage=()=>{try{// Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚº Ù¾ÛÙ„Û’ TripPlanner Ú©ÛŒ saved itinerary Ù„ÛŒÚº (Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ ÛÙˆ)\nlet itinerary=null;try{const raw=localStorage.getItem(\"umrah_last_plan\");if(raw)itinerary=JSON.parse(raw);}catch(e){itinerary=null;}// build consolidated snapshot\nconst snapshot={// meta will be filled by packageService (id, createdAt)\nagency:agency||null,itinerary:itinerary||null,hotelsSelected:{makkah:_objectSpread({},makkah),madinah:_objectSpread({},madinah)},flights:{ticketPrice:ticketPrice||0,ticketCurrency:ticketCurrency||\"SAR\",selectedAirline:selectedAirline||null// â­ FIXED: airline saving\n},visa:{visaSAR:Number(defaultVisaSAR||0),type:\"e-visa\"// â­ FIXED: always show e-visa\n},transport:{transportTotal:Number(transportTotal||0),vehicle:vehicle||\"\"// â­ FIXED: vehicle saving\n},pax:Number(pax||1),profit:Number(profit||0),profitCurrency:profitCurrency||\"SAR\",totals:{SAR:Number(totalSAR||0),PKR:Number(totalPKR||0),USD:Number(totalUSD||0)}};// call packageService to save (it will add id + createdAt)\nconst saved=savePkgService(snapshot);if(saved){// update local state (packages) so UI reflects saved package\nsetPackages(prev=>[saved,...(prev||[])]);alert(\"Package saved!\");}else{alert(\"Failed to save package. Check browser storage.\");}}catch(err){console.error(\"savePackage error\",err);alert(\"Saving failed. See console for error.\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full min-h-screen bg-gray-100\",children:[/*#__PURE__*/_jsx(\"main\",{className:\"w-full px-3 md:px-6 py-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-12 gap-4\",children:[/*#__PURE__*/_jsxs(\"aside\",{className:\"lg:col-span-6 space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-4 shadow-sm border-l-4 border-pink-500\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-lg mb-3\",children:\"Makkah Hotels\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 bg-gray-50 border rounded mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex flex-col gap-2 md:flex-row md:items-center\",ref:makkahRef,children:[/*#__PURE__*/_jsx(\"input\",{value:makkahQuery,onChange:e=>{const q=e.target.value||\"\";setMakkahQuery(q);setMakkahShowList(true);const match=filteredMakkah.find(h=>\"\".concat(h.name,\" \\u2014 \").concat(h.stars,\"\\u2605 \\u2014 \").concat(h.distance,\" \\u2014 SAR \").concat(h.pricePerNight)===q.trim())||null;if(match){setMakkah(s=>_objectSpread(_objectSpread({},s),{},{name:match.name,pricePerNight:match.pricePerNight}));setMakkahShowList(false);}},onKeyDown:e=>{handleMakkahKeyDown(e);if(e.key===\"Enter\"&&makkahFocus<0){const q=(makkahQuery||\"\").trim();const match=filteredMakkah.find(h=>\"\".concat(h.name,\" \\u2014 \").concat(h.stars,\"\\u2605 \\u2014 \").concat(h.distance,\" \\u2014 SAR \").concat(h.pricePerNight)===q)||filteredMakkah[0]||null;if(match){setMakkah(s=>_objectSpread(_objectSpread({},s),{},{name:match.name,pricePerNight:match.pricePerNight}));setMakkahShowList(false);}}},placeholder:\"Search & select hotel...\",className:\"w-full p-2 border rounded text-sm\",onFocus:()=>setMakkahShowList(true)}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 w-full md:w-auto\",children:[/*#__PURE__*/_jsxs(\"select\",{value:makkahFilters.star,onChange:e=>setMakkahFilters(s=>_objectSpread(_objectSpread({},s),{},{star:e.target.value})),className:\"p-2 border rounded text-sm bg-white\",title:\"Filter by stars\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All \\u2605\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5\",children:\"5\\u2605\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"4\\u2605\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"3\\u2605\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"2\\u2605\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"1\\u2605\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Max price\",value:makkahFilters.maxPrice,onChange:e=>setMakkahFilters(s=>_objectSpread(_objectSpread({},s),{},{maxPrice:e.target.value})),className:\"p-2 border rounded w-full md:w-24 text-sm\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Max m\",value:makkahFilters.maxDistance,onChange:e=>setMakkahFilters(s=>_objectSpread(_objectSpread({},s),{},{maxDistance:e.target.value})),className:\"p-2 border rounded w-full md:w-20 text-sm\"}),/*#__PURE__*/_jsxs(\"select\",{value:makkahFilters.sortBy,onChange:e=>setMakkahFilters(s=>_objectSpread(_objectSpread({},s),{},{sortBy:e.target.value})),className:\"p-2 border rounded text-sm bg-white\",title:\"Sort by\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"relevance\",children:\"Relevance\"}),/*#__PURE__*/_jsx(\"option\",{value:\"price\",children:\"Price \\u2191\"}),/*#__PURE__*/_jsx(\"option\",{value:\"distance\",children:\"Distance \\u2191\"}),/*#__PURE__*/_jsx(\"option\",{value:\"stars\",children:\"Stars \\u2193\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setManagerOpen(true),className:\"px-3 py-2 border rounded text-sm bg-white w-full md:w-auto md:ml-2\",type:\"button\",children:\"Add\"})]}),makkahShowList&&filteredMakkah.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute left-0 right-0 mt-2 bg-white border rounded max-h-64 overflow-auto shadow z-30 md:left-0 md:right-auto md:min-w-[450px]\",children:filteredMakkah.map((h,index)=>/*#__PURE__*/_jsx(\"button\",{id:\"makkah-item-\".concat(index),type:\"button\",onClick:()=>{setMakkah(s=>_objectSpread(_objectSpread({},s),{},{name:h.name,pricePerNight:h.pricePerNight}));setMakkahQuery(\"\".concat(h.name,\" \\u2014 \").concat(h.stars,\"\\u2605 \\u2014 \").concat(h.distance,\" \\u2014 SAR \").concat(h.pricePerNight));setMakkahShowList(false);setMakkahFocus(-1);},onMouseEnter:()=>setMakkahFocus(index),className:\"w-full text-left px-3 py-2 flex items-start gap-3 \".concat(index===makkahFocus?\"bg-indigo-50\":\"hover:bg-gray-50\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-sm\",children:h.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[h.stars,\"\\u2605 \\u2014 \",h.distance,\" \\u2014 SAR \",h.pricePerNight]})]})},h.id||index))})]}),/*#__PURE__*/_jsx(HotelCard,{title:\"\",hotel:makkah,setHotel:setMakkah})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-4 shadow-sm border-l-4 border-emerald-500\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-lg mb-3\",children:\"Madinah Hotels\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 bg-gray-50 border rounded mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex flex-col gap-2 md:flex-row md:items-center\",ref:madinahRef,children:[/*#__PURE__*/_jsx(\"input\",{value:madinahQuery,onChange:e=>{const q=e.target.value||\"\";setMadinahQuery(q);setMadinahShowList(true);const match=filteredMadinah.find(h=>\"\".concat(h.name,\" \\u2014 \").concat(h.stars,\"\\u2605 \\u2014 \").concat(h.distance,\" \\u2014 SAR \").concat(h.pricePerNight)===q.trim())||null;if(match){setMadinah(s=>_objectSpread(_objectSpread({},s),{},{name:match.name,pricePerNight:match.pricePerNight}));setMadinahShowList(false);}},onKeyDown:e=>{handleMadinahKeyDown(e);if(e.key===\"Enter\"&&madinahFocus<0){const q=(madinahQuery||\"\").trim();const match=filteredMadinah.find(h=>\"\".concat(h.name,\" \\u2014 \").concat(h.stars,\"\\u2605 \\u2014 \").concat(h.distance,\" \\u2014 SAR \").concat(h.pricePerNight)===q)||filteredMadinah[0]||null;if(match){setMadinah(s=>_objectSpread(_objectSpread({},s),{},{name:match.name,pricePerNight:match.pricePerNight}));setMadinahShowList(false);}}},placeholder:\"Search & select hotel...\",className:\"w-full p-2 border rounded text-sm\",onFocus:()=>setMadinahShowList(true)}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 w-full md:w-auto\",children:[/*#__PURE__*/_jsxs(\"select\",{value:madinahFilters.star,onChange:e=>setMadinahFilters(s=>_objectSpread(_objectSpread({},s),{},{star:e.target.value})),className:\"p-2 border rounded text-sm bg-white\",title:\"Filter by stars\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All \\u2605\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5\",children:\"5\\u2605\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"4\\u2605\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"3\\u2605\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"2\\u2605\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"1\\u2605\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Max price\",value:madinahFilters.maxPrice,onChange:e=>setMadinahFilters(s=>_objectSpread(_objectSpread({},s),{},{maxPrice:e.target.value})),className:\"p-2 border rounded w-24 text-sm\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Max m\",value:madinahFilters.maxDistance,onChange:e=>setMadinahFilters(s=>_objectSpread(_objectSpread({},s),{},{maxDistance:e.target.value})),className:\"p-2 border rounded w-20 text-sm\"}),/*#__PURE__*/_jsxs(\"select\",{value:madinahFilters.sortBy,onChange:e=>setMadinahFilters(s=>_objectSpread(_objectSpread({},s),{},{sortBy:e.target.value})),className:\"p-2 border rounded text-sm bg-white\",title:\"Sort by\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"relevance\",children:\"Relevance\"}),/*#__PURE__*/_jsx(\"option\",{value:\"price\",children:\"Price \\u2191\"}),/*#__PURE__*/_jsx(\"option\",{value:\"distance\",children:\"Distance \\u2191\"}),/*#__PURE__*/_jsx(\"option\",{value:\"stars\",children:\"Stars \\u2193\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setManagerOpen(true),className:\"ml-2 px-2 py-1 border rounded text-sm bg-white\",type:\"button\",children:\"Add\"})]}),madinahShowList&&filteredMadinah.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute left-4 right-4 mt-16 bg-white border rounded max-h-64 overflow-auto shadow z-30 md:left-0 md:right-auto md:min-w-[450px]\",children:filteredMadinah.map((h,index)=>/*#__PURE__*/_jsx(\"button\",{id:\"madinah-item-\".concat(index),type:\"button\",onClick:()=>{setMadinah(s=>_objectSpread(_objectSpread({},s),{},{name:h.name,pricePerNight:h.pricePerNight}));setMadinahQuery(\"\".concat(h.name,\" \\u2014 \").concat(h.stars,\"\\u2605 \\u2014 \").concat(h.distance,\" \\u2014 SAR \").concat(h.pricePerNight));setMadinahShowList(false);setMadinahFocus(-1);},onMouseEnter:()=>setMadinahFocus(index),className:\"w-full text-left px-3 py-2 flex items-start gap-3 \".concat(index===madinahFocus?\"bg-indigo-50\":\"hover:bg-gray-50\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-sm\",children:h.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[h.stars,\"\\u2605 \\u2014 \",h.distance,\" \\u2014 SAR \",h.pricePerNight]})]})},h.id||index))})]}),/*#__PURE__*/_jsx(HotelCard,{title:\"\",hotel:madinah,setHotel:setMadinah})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-6 space-y-4\",children:[/*#__PURE__*/_jsx(TicketsVisa,{pax:pax,setPax:setPax,ticketPrice:ticketPrice,setTicketPrice:setTicketPrice,ticketCurrency:ticketCurrency,setTicketCurrency:setTicketCurrency,defaultVisaSAR:defaultVisaSAR,setDefaultVisaSAR:setDefaultVisaSAR,transportTotal:transportTotal,setTransportTotal:setTransportTotal,rates:rates,setRates:setRates,profit:profit,setProfit:setProfit,profitCurrency:profitCurrency,setProfitCurrency:setProfitCurrency,selectedAirline:selectedAirline,setSelectedAirline:setSelectedAirline,vehicle:vehicle,setVehicle:setVehicle}),/*#__PURE__*/_jsx(Summary,{perPersonTotalSAR:perPersonTotalSAR,totalSAR:totalSAR,totalPKR:totalPKR,totalUSD:totalUSD,pax:pax,savePackage:savePackage}),/*#__PURE__*/_jsx(SavedPackages,{packages:packages,setPackages:setPackages})]})]})}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(HotelManager,{open:managerOpen,setOpen:setManagerOpen,makkahList:makkahList,madinahList:madinahList,refreshMakkah:loadLists,refreshMadinah:loadLists})]});}","map":{"version":3,"names":["React","useState","useEffect","useMemo","useRef","v4","uuidv4","useLocalStorage","getMakkahHotels","getMadinahHotels","clearHotelCache","useApp","AgencyForm","HotelCard","HotelManager","TicketsVisa","Summary","SavedPackages","Footer","savePackage","savePkgService","listPackages","jsx","_jsx","jsxs","_jsxs","UmrahCalculator","agency","showAgencyForm","setShowAgencyForm","makkah","setMakkah","name","nights","pricePerNight","soldOut","weekendNights","weekendPrice","madinah","setMadinah","makkahList","setMakkahList","madinahList","setMadinahList","loadingHotels","setLoadingHotels","makkahQuery","setMakkahQuery","madinahQuery","setMadinahQuery","managerOpen","setManagerOpen","makkahFilters","setMakkahFilters","star","maxPrice","maxDistance","sortBy","madinahFilters","setMadinahFilters","makkahShowList","setMakkahShowList","madinahShowList","setMadinahShowList","makkahRef","madinahRef","makkahFocus","setMakkahFocus","madinahFocus","setMadinahFocus","onDocClick","e","current","contains","target","document","addEventListener","removeEventListener","pax","setPax","ticketPrice","setTicketPrice","ticketCurrency","setTicketCurrency","selectedAirline","setSelectedAirline","vehicle","setVehicle","profit","setProfit","profitCurrency","setProfitCurrency","rates","setRates","SAR_to_PKR","USD_to_SAR","defaultVisaSAR","setDefaultVisaSAR","transportTotal","setTransportTotal","packages","setPackages","loadLists","mList","mdList","rawPlan","localStorage","getItem","plan","JSON","parse","stays","adjustedStays","segments","filter","s","type","sum","arr","reduce","acc","Number","countedDays","makkahStays","city","madinahStays","sumWeekend","Array","isArray","weekendDates","length","_objectSpread","console","warn","first","parseDistanceToMeters","dist","String","trim","toLowerCase","num","parseFloat","replace","includes","Math","round","isNaN","filterHotels","list","query","filters","q","starFilter","out","h","stars","undefined","distance","d","sort","a","b","da","db","filteredMakkah","filteredMadinah","selectMakkahByIndex","i","concat","selectMadinahByIndex","handleMakkahKeyDown","key","preventDefault","prev","min","handleMadinahKeyDown","el","getElementById","scrollIntoView","block","makkahNights","makkahPrice","madinahNights","madinahPrice","makTotal","madTotal","ticketPriceInSAR","visaSAR","_profit","profitInSAR","perPersonTotalSAR","totalSAR","max","totalPKR","totalUSD","handleSelectMakkah","id","value","find","x","handleSelectMadinah","itinerary","raw","snapshot","hotelsSelected","flights","visa","transport","totals","SAR","PKR","USD","saved","alert","err","error","className","children","ref","onChange","match","onKeyDown","placeholder","onFocus","title","onClick","map","index","onMouseEnter","hotel","setHotel","open","setOpen","refreshMakkah","refreshMadinah"],"sources":["C:/Users/Taj Tech/Downloads/umrah-calculator/src/pages/UmrahCalculator.jsx"],"sourcesContent":["// src/pages/UmrahCalculator.jsx\r\nimport React, { useState, useEffect, useMemo, useRef } from \"react\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\n\r\nimport useLocalStorage from \"../hooks/useLocalStorage\";\r\nimport {\r\n  getMakkahHotels,\r\n  getMadinahHotels,\r\n  clearHotelCache,\r\n} from \"../services/hotelService\";\r\n\r\nimport { useApp } from \"../contexts/AppContext\";\r\n\r\nimport AgencyForm from \"../components/AgencyForm\";\r\nimport HotelCard from \"../components/HotelCard\";\r\nimport HotelManager from \"../components/HotelManager\";\r\nimport TicketsVisa from \"../components/TicketsVisa\";\r\nimport Summary from \"../components/Summary\";\r\nimport SavedPackages from \"../components/SavedPackages\";\r\nimport Footer from \"../components/Footer\";\r\nimport {\r\n  savePackage as savePkgService,\r\n  listPackages,\r\n} from \"../services/packageService\";\r\n\r\n/**\r\n * UmrahCalculator page\r\n * - includes new filters UI for hotels (Makkah + Madinah)\r\n */\r\n\r\nexport default function UmrahCalculator() {\r\n  const { agency } = useApp();\r\n  const [showAgencyForm, setShowAgencyForm] = useState(!agency);\r\n\r\n  useEffect(() => {\r\n    setShowAgencyForm(!agency);\r\n  }, [agency]);\r\n\r\n  // MAIN hotel states\r\n  const [makkah, setMakkah] = useState({\r\n    name: \"\",\r\n    nights: 3,\r\n    pricePerNight: 0,\r\n    soldOut: false,\r\n    weekendNights: 0,\r\n    weekendPrice: \"\",\r\n  });\r\n  const [madinah, setMadinah] = useState({\r\n    name: \"\",\r\n    nights: 2,\r\n    pricePerNight: 0,\r\n    soldOut: false,\r\n    weekendNights: 0,\r\n    weekendPrice: \"\",\r\n  });\r\n\r\n  const [makkahList, setMakkahList] = useState([]);\r\n  const [madinahList, setMadinahList] = useState([]);\r\n  const [loadingHotels, setLoadingHotels] = useState(true);\r\n\r\n  const [makkahQuery, setMakkahQuery] = useState(\"\");\r\n  const [madinahQuery, setMadinahQuery] = useState(\"\");\r\n\r\n  const [managerOpen, setManagerOpen] = useState(false);\r\n\r\n  // --- NEW: filters state for each city (supports multi-filter) ---\r\n  const [makkahFilters, setMakkahFilters] = useState({\r\n    star: \"all\", // all / 5 /4 /3 /2 /1\r\n    maxPrice: \"\",\r\n    maxDistance: \"\", // in meters (user types number)\r\n    sortBy: \"relevance\", // relevance / price / distance / stars\r\n  });\r\n\r\n  const [madinahFilters, setMadinahFilters] = useState({\r\n    star: \"all\",\r\n    maxPrice: \"\",\r\n    maxDistance: \"\",\r\n    sortBy: \"relevance\",\r\n  });\r\n\r\n  // custom dropdown UI state (for Makkah + Madinah search results)\r\n  const [makkahShowList, setMakkahShowList] = useState(false);\r\n  const [madinahShowList, setMadinahShowList] = useState(false);\r\n  const makkahRef = useRef(null);\r\n  const madinahRef = useRef(null);\r\n\r\n  // keyboard focus index for dropdown items\r\n  const [makkahFocus, setMakkahFocus] = useState(-1);\r\n  const [madinahFocus, setMadinahFocus] = useState(-1);\r\n\r\n  // --- close dropdowns when clicking outside ---\r\n  useEffect(() => {\r\n    function onDocClick(e) {\r\n      if (makkahRef.current && !makkahRef.current.contains(e.target)) {\r\n        setMakkahShowList(false);\r\n      }\r\n      if (madinahRef.current && !madinahRef.current.contains(e.target)) {\r\n        setMadinahShowList(false);\r\n      }\r\n    }\r\n    document.addEventListener(\"click\", onDocClick);\r\n    return () => document.removeEventListener(\"click\", onDocClick);\r\n  }, []);\r\n\r\n  // ticket / pax / profit states\r\n  const [pax, setPax] = useState(1);\r\n  const [ticketPrice, setTicketPrice] = useState(0);\r\n  const [ticketCurrency, setTicketCurrency] = useState(\"SAR\");\r\n  // selected airline and vehicle lifted to parent so we can save them in package snapshot\r\n  const [selectedAirline, setSelectedAirline] = useState(null);\r\n  const [vehicle, setVehicle] = useState(\"CAR\");\r\n\r\n  // NEW: profit amount + currency\r\n  const [profit, setProfit] = useState(0);\r\n  const [profitCurrency, setProfitCurrency] = useState(\"SAR\");\r\n\r\n  const [rates, setRates] = useLocalStorage(\"umrah_rates\", {\r\n    SAR_to_PKR: 75,\r\n    USD_to_SAR: 3.75,\r\n  });\r\n\r\n  // keep default visa SAR (user can edit it)\r\n  const [defaultVisaSAR, setDefaultVisaSAR] = useLocalStorage(\r\n    \"umrah_defaultVisaSAR\",\r\n    300\r\n  );\r\n\r\n  // TRANSPORT total\r\n  const [transportTotal, setTransportTotal] = useState(0);\r\n\r\n  const [packages, setPackages] = useLocalStorage(\"umrah_packages\", []);\r\n\r\n  // -------------------------\r\n  // Load hotel lists\r\n  // -------------------------\r\n  const loadLists = async () => {\r\n    setLoadingHotels(true);\r\n    try {\r\n      const mList = await getMakkahHotels();\r\n      const mdList = await getMadinahHotels();\r\n      // ðŸ”´ FINAL SOURCE OF TRUTH: TripPlanner COUNTED data\r\n      try {\r\n        const rawPlan = localStorage.getItem(\"umrah_last_plan\");\r\n        if (rawPlan) {\r\n          const plan = JSON.parse(rawPlan);\r\n\r\n          const stays =\r\n            plan.adjustedStays ||\r\n            (plan.segments || []).filter((s) => s.type === \"stay\");\r\n\r\n          const sum = (arr) =>\r\n            arr.reduce((acc, s) => acc + Number(s.countedDays || 0), 0);\r\n\r\n          const makkahStays = stays.filter((s) => s.city === \"makkah\");\r\n          const madinahStays = stays.filter((s) => s.city === \"madinah\");\r\n\r\n          const sumWeekend = (arr) =>\r\n            arr.reduce(\r\n              (acc, s) =>\r\n                acc +\r\n                (Array.isArray(s.weekendDates) ? s.weekendDates.length : 0),\r\n              0\r\n            );\r\n\r\n          if (makkahStays.length) {\r\n            setMakkah((s) => ({\r\n              ...s,\r\n              nights: sum(makkahStays),\r\n              weekendNights: sumWeekend(makkahStays),\r\n            }));\r\n          }\r\n\r\n          if (madinahStays.length) {\r\n            setMadinah((s) => ({\r\n              ...s,\r\n              nights: sum(madinahStays),\r\n              weekendNights: sumWeekend(madinahStays),\r\n            }));\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.warn(\"Failed to read counted nights from umrah_last_plan\", e);\r\n      }\r\n\r\n      setMakkahList(mList || []);\r\n      setMadinahList(mdList || []);\r\n\r\n      if ((!makkah.name || makkah.name === \"\") && mList.length > 0) {\r\n        const first = mList[0];\r\n        setMakkah((s) => ({\r\n          ...s,\r\n          name: first.name,\r\n          pricePerNight: first.pricePerNight,\r\n        }));\r\n      }\r\n      if ((!madinah.name || madinah.name === \"\") && mdList.length > 0) {\r\n        const first = mdList[0];\r\n        setMadinah((s) => ({\r\n          ...s,\r\n          name: first.name,\r\n          pricePerNight: first.pricePerNight,\r\n        }));\r\n      }\r\n    } finally {\r\n      setLoadingHotels(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadLists();\r\n  }, []);\r\n\r\n  // ---------------------------------------------------\r\n  // Filters function (now accepts filters object)\r\n  // ---------------------------------------------------\r\n  function parseDistanceToMeters(dist) {\r\n    // expected formats: \"350m\", \"1.2 km\", \"1200 m\", \"0.5km\"\r\n    if (!dist) return null;\r\n    const s = String(dist).trim().toLowerCase();\r\n    const num = parseFloat(s.replace(\",\", \".\").replace(/[^\\d.]/g, \"\"));\r\n    if (s.includes(\"km\")) return Math.round(num * 1000);\r\n    if (s.includes(\"m\")) return Math.round(num);\r\n    // fallback treat as meters if numeric\r\n    if (!Number.isNaN(num)) return Math.round(num);\r\n    return null;\r\n  }\r\n\r\n  const filterHotels = (list, query, filters) => {\r\n    const q = (query || \"\").trim().toLowerCase();\r\n\r\n    // pre-calc numeric filters\r\n    const maxPrice =\r\n      filters && filters.maxPrice !== \"\" ? Number(filters.maxPrice) : null;\r\n    const maxDistance =\r\n      filters && filters.maxDistance !== \"\"\r\n        ? Number(filters.maxDistance)\r\n        : null;\r\n    const starFilter = filters && filters.star ? filters.star : \"all\";\r\n\r\n    let out = (list || []).filter((h) => {\r\n      // star filter\r\n      if (starFilter !== \"all\") {\r\n        if (String(h.stars) !== String(starFilter)) return false;\r\n      }\r\n\r\n      // price filter (if hotel has pricePerNight field)\r\n      if (\r\n        maxPrice !== null &&\r\n        h.pricePerNight !== undefined &&\r\n        h.pricePerNight !== \"\"\r\n      ) {\r\n        if (Number(h.pricePerNight) > maxPrice) return false;\r\n      }\r\n\r\n      // distance filter\r\n      if (maxDistance !== null && h.distance) {\r\n        const d = parseDistanceToMeters(h.distance);\r\n        if (d !== null && d > maxDistance) return false;\r\n      }\r\n\r\n      // query matching (name or distance)\r\n      if (!q) return true;\r\n      if (h.name && h.name.toLowerCase().includes(q)) return true;\r\n      if (h.distance && String(h.distance).toLowerCase().includes(q))\r\n        return true;\r\n      return false;\r\n    });\r\n\r\n    // sorting\r\n    if (filters && filters.sortBy && filters.sortBy !== \"relevance\") {\r\n      if (filters.sortBy === \"price\") {\r\n        out = out.sort(\r\n          (a, b) => Number(a.pricePerNight || 0) - Number(b.pricePerNight || 0)\r\n        );\r\n      } else if (filters.sortBy === \"distance\") {\r\n        out = out.sort((a, b) => {\r\n          const da = parseDistanceToMeters(a.distance) || 0;\r\n          const db = parseDistanceToMeters(b.distance) || 0;\r\n          return da - db;\r\n        });\r\n      } else if (filters.sortBy === \"stars\") {\r\n        out = out.sort((a, b) => Number(b.stars || 0) - Number(a.stars || 0));\r\n      }\r\n    }\r\n\r\n    return out;\r\n  };\r\n\r\n  const filteredMakkah = useMemo(\r\n    () => filterHotels(makkahList, makkahQuery, makkahFilters),\r\n    [makkahList, makkahQuery, makkahFilters]\r\n  );\r\n\r\n  const filteredMadinah = useMemo(\r\n    () => filterHotels(madinahList, madinahQuery, madinahFilters),\r\n    [madinahList, madinahQuery, madinahFilters]\r\n  );\r\n\r\n  // --- Keyboard + dropdown helpers (same as before) ---\r\n  useEffect(() => {\r\n    if (!makkahShowList) setMakkahFocus(-1);\r\n  }, [makkahShowList, filteredMakkah]);\r\n\r\n  useEffect(() => {\r\n    if (!madinahShowList) setMadinahFocus(-1);\r\n  }, [madinahShowList, filteredMadinah]);\r\n\r\n  function selectMakkahByIndex(i) {\r\n    const h = filteredMakkah[i];\r\n    if (!h) return;\r\n    setMakkah((s) => ({ ...s, name: h.name, pricePerNight: h.pricePerNight }));\r\n    setMakkahQuery(\r\n      `${h.name} â€” ${h.stars}â˜… â€” ${h.distance} â€” SAR ${h.pricePerNight}`\r\n    );\r\n    setMakkahShowList(false);\r\n    setMakkahFocus(-1);\r\n  }\r\n\r\n  function selectMadinahByIndex(i) {\r\n    const h = filteredMadinah[i];\r\n    if (!h) return;\r\n    setMadinah((s) => ({ ...s, name: h.name, pricePerNight: h.pricePerNight }));\r\n    setMadinahQuery(\r\n      `${h.name} â€” ${h.stars}â˜… â€” ${h.distance} â€” SAR ${h.pricePerNight}`\r\n    );\r\n    setMadinahShowList(false);\r\n    setMadinahFocus(-1);\r\n  }\r\n\r\n  function handleMakkahKeyDown(e) {\r\n    if (e.key === \"ArrowDown\") {\r\n      e.preventDefault();\r\n      setMakkahShowList(true);\r\n      setMakkahFocus((prev) => {\r\n        if (filteredMakkah.length === 0) return -1;\r\n        if (prev === -1) return 0;\r\n        return Math.min(prev + 1, filteredMakkah.length - 1);\r\n      });\r\n      return;\r\n    }\r\n    if (e.key === \"ArrowUp\") {\r\n      e.preventDefault();\r\n      setMakkahFocus((prev) => {\r\n        if (filteredMakkah.length === 0) return -1;\r\n        if (prev <= 0) return 0;\r\n        return prev - 1;\r\n      });\r\n      return;\r\n    }\r\n    if (e.key === \"Enter\") {\r\n      if (makkahFocus >= 0) {\r\n        e.preventDefault();\r\n        selectMakkahByIndex(makkahFocus);\r\n      }\r\n      return;\r\n    }\r\n    if (e.key === \"Escape\") {\r\n      setMakkahShowList(false);\r\n      setMakkahFocus(-1);\r\n      return;\r\n    }\r\n  }\r\n\r\n  function handleMadinahKeyDown(e) {\r\n    if (e.key === \"ArrowDown\") {\r\n      e.preventDefault();\r\n      setMadinahShowList(true);\r\n      setMadinahFocus((prev) => {\r\n        if (filteredMadinah.length === 0) return -1;\r\n        if (prev === -1) return 0;\r\n        return Math.min(prev + 1, filteredMadinah.length - 1);\r\n      });\r\n      return;\r\n    }\r\n    if (e.key === \"ArrowUp\") {\r\n      e.preventDefault();\r\n      setMadinahFocus((prev) => {\r\n        if (filteredMadinah.length === 0) return -1;\r\n        if (prev <= 0) return 0;\r\n        return prev - 1;\r\n      });\r\n      return;\r\n    }\r\n    if (e.key === \"Enter\") {\r\n      if (madinahFocus >= 0) {\r\n        e.preventDefault();\r\n        selectMadinahByIndex(madinahFocus);\r\n      }\r\n      return;\r\n    }\r\n    if (e.key === \"Escape\") {\r\n      setMadinahShowList(false);\r\n      setMadinahFocus(-1);\r\n      return;\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (makkahFocus >= 0) {\r\n      const el = document.getElementById(`makkah-item-${makkahFocus}`);\r\n      if (el) el.scrollIntoView({ block: \"nearest\" });\r\n    }\r\n  }, [makkahFocus]);\r\n\r\n  useEffect(() => {\r\n    if (madinahFocus >= 0) {\r\n      const el = document.getElementById(`madinah-item-${madinahFocus}`);\r\n      if (el) el.scrollIntoView({ block: \"nearest\" });\r\n    }\r\n  }, [madinahFocus]);\r\n\r\n  // price calculation\r\n  const makkahNights = Number(makkah.nights) || 0;\r\n  const makkahPrice = Number(makkah.pricePerNight) || 0;\r\n\r\n  const madinahNights = Number(madinah.nights) || 0;\r\n  const madinahPrice = Number(madinah.pricePerNight) || 0;\r\n\r\n  const makTotal = makkahNights * makkahPrice;\r\n  const madTotal = madinahNights * madinahPrice;\r\n\r\n  const ticketPriceInSAR =\r\n    ticketCurrency === \"USD\"\r\n      ? ticketPrice * rates.USD_to_SAR\r\n      : ticketCurrency === \"PKR\"\r\n      ? ticketPrice / rates.SAR_to_PKR\r\n      : ticketPrice;\r\n\r\n  const visaSAR = Number(defaultVisaSAR) || 0;\r\n\r\n  const _profit = Number(profit) || 0;\r\n  let profitInSAR = 0;\r\n  if (_profit > 0) {\r\n    if (profitCurrency === \"SAR\") {\r\n      profitInSAR = _profit;\r\n    } else if (profitCurrency === \"USD\") {\r\n      profitInSAR = _profit * Number(rates.USD_to_SAR || 3.75);\r\n    } else if (profitCurrency === \"PKR\") {\r\n      profitInSAR = _profit / Number(rates.SAR_to_PKR || 75);\r\n    }\r\n  }\r\n\r\n  const perPersonTotalSAR =\r\n    (Number(makTotal) || 0) +\r\n    (Number(madTotal) || 0) +\r\n    (Number(ticketPriceInSAR) || 0) +\r\n    (Number(visaSAR) || 0) +\r\n    (Number(transportTotal) || 0) +\r\n    (Number(profitInSAR) || 0);\r\n\r\n  const totalSAR = perPersonTotalSAR * Math.max(1, Number(pax || 1));\r\n  const totalPKR = totalSAR * Number(rates.SAR_to_PKR || 75);\r\n  const totalUSD = totalSAR / Number(rates.USD_to_SAR || 3.75);\r\n\r\n  // ---------------------------------------------------\r\n  // When user selects a hotel from dropdown (not used by new filters)\r\n  // ---------------------------------------------------\r\n  const handleSelectMakkah = (e) => {\r\n    const id = e.target.value;\r\n    const h = makkahList.find((x) => x.id === id);\r\n    if (h) {\r\n      setMakkah((s) => ({\r\n        ...s,\r\n        name: h.name,\r\n        pricePerNight: h.pricePerNight,\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleSelectMadinah = (e) => {\r\n    const id = e.target.value;\r\n    const h = madinahList.find((x) => x.id === id);\r\n    if (h) {\r\n      setMadinah((s) => ({\r\n        ...s,\r\n        name: h.name,\r\n        pricePerNight: h.pricePerNight,\r\n      }));\r\n    }\r\n  };\r\n\r\n  // ---------------------------------------------------\r\n  // SAVE PACKAGE (upgraded -> consolidated snapshot)\r\n  // ---------------------------------------------------\r\n  const savePackage = () => {\r\n    try {\r\n      // Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚº Ù¾ÛÙ„Û’ TripPlanner Ú©ÛŒ saved itinerary Ù„ÛŒÚº (Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ ÛÙˆ)\r\n      let itinerary = null;\r\n      try {\r\n        const raw = localStorage.getItem(\"umrah_last_plan\");\r\n        if (raw) itinerary = JSON.parse(raw);\r\n      } catch (e) {\r\n        itinerary = null;\r\n      }\r\n\r\n      // build consolidated snapshot\r\n      const snapshot = {\r\n        // meta will be filled by packageService (id, createdAt)\r\n        agency: agency || null,\r\n        itinerary: itinerary || null,\r\n\r\n        hotelsSelected: {\r\n          makkah: { ...makkah },\r\n          madinah: { ...madinah },\r\n        },\r\n\r\n        flights: {\r\n          ticketPrice: ticketPrice || 0,\r\n          ticketCurrency: ticketCurrency || \"SAR\",\r\n          selectedAirline: selectedAirline || null, // â­ FIXED: airline saving\r\n        },\r\n\r\n        visa: {\r\n          visaSAR: Number(defaultVisaSAR || 0),\r\n          type: \"e-visa\", // â­ FIXED: always show e-visa\r\n        },\r\n\r\n        transport: {\r\n          transportTotal: Number(transportTotal || 0),\r\n          vehicle: vehicle || \"\", // â­ FIXED: vehicle saving\r\n        },\r\n\r\n        pax: Number(pax || 1),\r\n        profit: Number(profit || 0),\r\n        profitCurrency: profitCurrency || \"SAR\",\r\n\r\n        totals: {\r\n          SAR: Number(totalSAR || 0),\r\n          PKR: Number(totalPKR || 0),\r\n          USD: Number(totalUSD || 0),\r\n        },\r\n      };\r\n\r\n      // call packageService to save (it will add id + createdAt)\r\n      const saved = savePkgService(snapshot);\r\n      if (saved) {\r\n        // update local state (packages) so UI reflects saved package\r\n        setPackages((prev) => [saved, ...(prev || [])]);\r\n        alert(\"Package saved!\");\r\n      } else {\r\n        alert(\"Failed to save package. Check browser storage.\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"savePackage error\", err);\r\n      alert(\"Saving failed. See console for error.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-full min-h-screen bg-gray-100\">\r\n      <main className=\"w-full px-3 md:px-6 py-2\">\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-4\">\r\n          {/* LEFT PANEL */}\r\n          <aside className=\"lg:col-span-6 space-y-4\">\r\n            {/* Makkah Hotels */}\r\n            <div className=\"bg-white rounded-xl p-4 shadow-sm border-l-4 border-pink-500\">\r\n              <h3 className=\"font-semibold text-lg mb-3\">Makkah Hotels</h3>\r\n\r\n              {/* Compact combined search + filters + Add */}\r\n              <div className=\"p-3 bg-gray-50 border rounded mb-3\">\r\n                <div\r\n                  className=\"relative flex flex-col gap-2 md:flex-row md:items-center\"\r\n                  ref={makkahRef}\r\n                >\r\n                  <input\r\n                    value={makkahQuery}\r\n                    onChange={(e) => {\r\n                      const q = e.target.value || \"\";\r\n                      setMakkahQuery(q);\r\n                      setMakkahShowList(true);\r\n                      const match =\r\n                        filteredMakkah.find(\r\n                          (h) =>\r\n                            `${h.name} â€” ${h.stars}â˜… â€” ${h.distance} â€” SAR ${h.pricePerNight}` ===\r\n                            q.trim()\r\n                        ) || null;\r\n                      if (match) {\r\n                        setMakkah((s) => ({\r\n                          ...s,\r\n                          name: match.name,\r\n                          pricePerNight: match.pricePerNight,\r\n                        }));\r\n                        setMakkahShowList(false);\r\n                      }\r\n                    }}\r\n                    onKeyDown={(e) => {\r\n                      handleMakkahKeyDown(e);\r\n                      if (e.key === \"Enter\" && makkahFocus < 0) {\r\n                        const q = (makkahQuery || \"\").trim();\r\n                        const match =\r\n                          filteredMakkah.find(\r\n                            (h) =>\r\n                              `${h.name} â€” ${h.stars}â˜… â€” ${h.distance} â€” SAR ${h.pricePerNight}` ===\r\n                              q\r\n                          ) ||\r\n                          filteredMakkah[0] ||\r\n                          null;\r\n                        if (match) {\r\n                          setMakkah((s) => ({\r\n                            ...s,\r\n                            name: match.name,\r\n                            pricePerNight: match.pricePerNight,\r\n                          }));\r\n                          setMakkahShowList(false);\r\n                        }\r\n                      }\r\n                    }}\r\n                    placeholder=\"Search & select hotel...\"\r\n                    className=\"w-full p-2 border rounded text-sm\"\r\n                    onFocus={() => setMakkahShowList(true)}\r\n                  />\r\n\r\n                  {/* Filters compact UI (before Add) */}\r\n                  <div className=\"flex flex-wrap gap-2 w-full md:w-auto\">\r\n                    <select\r\n                      value={makkahFilters.star}\r\n                      onChange={(e) =>\r\n                        setMakkahFilters((s) => ({\r\n                          ...s,\r\n                          star: e.target.value,\r\n                        }))\r\n                      }\r\n                      className=\"p-2 border rounded text-sm bg-white\"\r\n                      title=\"Filter by stars\"\r\n                    >\r\n                      <option value=\"all\">All â˜…</option>\r\n                      <option value=\"5\">5â˜…</option>\r\n                      <option value=\"4\">4â˜…</option>\r\n                      <option value=\"3\">3â˜…</option>\r\n                      <option value=\"2\">2â˜…</option>\r\n                      <option value=\"1\">1â˜…</option>\r\n                    </select>\r\n\r\n                    <input\r\n                      type=\"number\"\r\n                      placeholder=\"Max price\"\r\n                      value={makkahFilters.maxPrice}\r\n                      onChange={(e) =>\r\n                        setMakkahFilters((s) => ({\r\n                          ...s,\r\n                          maxPrice: e.target.value,\r\n                        }))\r\n                      }\r\n                      className=\"p-2 border rounded w-full md:w-24 text-sm\"\r\n                    />\r\n\r\n                    <input\r\n                      type=\"number\"\r\n                      placeholder=\"Max m\"\r\n                      value={makkahFilters.maxDistance}\r\n                      onChange={(e) =>\r\n                        setMakkahFilters((s) => ({\r\n                          ...s,\r\n                          maxDistance: e.target.value,\r\n                        }))\r\n                      }\r\n                      className=\"p-2 border rounded w-full md:w-20 text-sm\"\r\n                    />\r\n\r\n                    <select\r\n                      value={makkahFilters.sortBy}\r\n                      onChange={(e) =>\r\n                        setMakkahFilters((s) => ({\r\n                          ...s,\r\n                          sortBy: e.target.value,\r\n                        }))\r\n                      }\r\n                      className=\"p-2 border rounded text-sm bg-white\"\r\n                      title=\"Sort by\"\r\n                    >\r\n                      <option value=\"relevance\">Relevance</option>\r\n                      <option value=\"price\">Price â†‘</option>\r\n                      <option value=\"distance\">Distance â†‘</option>\r\n                      <option value=\"stars\">Stars â†“</option>\r\n                    </select>\r\n                  </div>\r\n\r\n                  <button\r\n                    onClick={() => setManagerOpen(true)}\r\n                    className=\"px-3 py-2 border rounded text-sm bg-white w-full md:w-auto md:ml-2\"\r\n                    type=\"button\"\r\n                  >\r\n                    Add\r\n                  </button>\r\n                </div>\r\n\r\n                {/* dropdown results */}\r\n                {makkahShowList && filteredMakkah.length > 0 && (\r\n                  <div className=\"absolute left-0 right-0 mt-2 bg-white border rounded max-h-64 overflow-auto shadow z-30 md:left-0 md:right-auto md:min-w-[450px]\">\r\n                    {filteredMakkah.map((h, index) => (\r\n                      <button\r\n                        key={h.id || index}\r\n                        id={`makkah-item-${index}`}\r\n                        type=\"button\"\r\n                        onClick={() => {\r\n                          setMakkah((s) => ({\r\n                            ...s,\r\n                            name: h.name,\r\n                            pricePerNight: h.pricePerNight,\r\n                          }));\r\n                          setMakkahQuery(\r\n                            `${h.name} â€” ${h.stars}â˜… â€” ${h.distance} â€” SAR ${h.pricePerNight}`\r\n                          );\r\n                          setMakkahShowList(false);\r\n                          setMakkahFocus(-1);\r\n                        }}\r\n                        onMouseEnter={() => setMakkahFocus(index)}\r\n                        className={`w-full text-left px-3 py-2 flex items-start gap-3 ${\r\n                          index === makkahFocus\r\n                            ? \"bg-indigo-50\"\r\n                            : \"hover:bg-gray-50\"\r\n                        }`}\r\n                      >\r\n                        <div className=\"flex-1\">\r\n                          <div className=\"font-medium text-sm\">{h.name}</div>\r\n                          <div className=\"text-xs text-gray-500\">\r\n                            {h.stars}â˜… â€” {h.distance} â€” SAR {h.pricePerNight}\r\n                          </div>\r\n                        </div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <HotelCard title=\"\" hotel={makkah} setHotel={setMakkah} />\r\n            </div>\r\n\r\n            {/* Madinah Hotels */}\r\n            <div className=\"bg-white rounded-xl p-4 shadow-sm border-l-4 border-emerald-500\">\r\n              <h3 className=\"font-semibold text-lg mb-3\">Madinah Hotels</h3>\r\n\r\n              {/* Compact combined search + filters + Add */}\r\n              <div className=\"p-3 bg-gray-50 border rounded mb-3\">\r\n                <div\r\n                  className=\"relative flex flex-col gap-2 md:flex-row md:items-center\"\r\n                  ref={madinahRef}\r\n                >\r\n                  <input\r\n                    value={madinahQuery}\r\n                    onChange={(e) => {\r\n                      const q = e.target.value || \"\";\r\n                      setMadinahQuery(q);\r\n                      setMadinahShowList(true);\r\n                      const match =\r\n                        filteredMadinah.find(\r\n                          (h) =>\r\n                            `${h.name} â€” ${h.stars}â˜… â€” ${h.distance} â€” SAR ${h.pricePerNight}` ===\r\n                            q.trim()\r\n                        ) || null;\r\n                      if (match) {\r\n                        setMadinah((s) => ({\r\n                          ...s,\r\n                          name: match.name,\r\n                          pricePerNight: match.pricePerNight,\r\n                        }));\r\n                        setMadinahShowList(false);\r\n                      }\r\n                    }}\r\n                    onKeyDown={(e) => {\r\n                      handleMadinahKeyDown(e);\r\n                      if (e.key === \"Enter\" && madinahFocus < 0) {\r\n                        const q = (madinahQuery || \"\").trim();\r\n                        const match =\r\n                          filteredMadinah.find(\r\n                            (h) =>\r\n                              `${h.name} â€” ${h.stars}â˜… â€” ${h.distance} â€” SAR ${h.pricePerNight}` ===\r\n                              q\r\n                          ) ||\r\n                          filteredMadinah[0] ||\r\n                          null;\r\n                        if (match) {\r\n                          setMadinah((s) => ({\r\n                            ...s,\r\n                            name: match.name,\r\n                            pricePerNight: match.pricePerNight,\r\n                          }));\r\n                          setMadinahShowList(false);\r\n                        }\r\n                      }\r\n                    }}\r\n                    placeholder=\"Search & select hotel...\"\r\n                    className=\"w-full p-2 border rounded text-sm\"\r\n                    onFocus={() => setMadinahShowList(true)}\r\n                  />\r\n\r\n                  {/* Filters UI */}\r\n                  <div className=\"flex flex-wrap gap-2 w-full md:w-auto\">\r\n                    <select\r\n                      value={madinahFilters.star}\r\n                      onChange={(e) =>\r\n                        setMadinahFilters((s) => ({\r\n                          ...s,\r\n                          star: e.target.value,\r\n                        }))\r\n                      }\r\n                      className=\"p-2 border rounded text-sm bg-white\"\r\n                      title=\"Filter by stars\"\r\n                    >\r\n                      <option value=\"all\">All â˜…</option>\r\n                      <option value=\"5\">5â˜…</option>\r\n                      <option value=\"4\">4â˜…</option>\r\n                      <option value=\"3\">3â˜…</option>\r\n                      <option value=\"2\">2â˜…</option>\r\n                      <option value=\"1\">1â˜…</option>\r\n                    </select>\r\n\r\n                    <input\r\n                      type=\"number\"\r\n                      placeholder=\"Max price\"\r\n                      value={madinahFilters.maxPrice}\r\n                      onChange={(e) =>\r\n                        setMadinahFilters((s) => ({\r\n                          ...s,\r\n                          maxPrice: e.target.value,\r\n                        }))\r\n                      }\r\n                      className=\"p-2 border rounded w-24 text-sm\"\r\n                    />\r\n\r\n                    <input\r\n                      type=\"number\"\r\n                      placeholder=\"Max m\"\r\n                      value={madinahFilters.maxDistance}\r\n                      onChange={(e) =>\r\n                        setMadinahFilters((s) => ({\r\n                          ...s,\r\n                          maxDistance: e.target.value,\r\n                        }))\r\n                      }\r\n                      className=\"p-2 border rounded w-20 text-sm\"\r\n                    />\r\n\r\n                    <select\r\n                      value={madinahFilters.sortBy}\r\n                      onChange={(e) =>\r\n                        setMadinahFilters((s) => ({\r\n                          ...s,\r\n                          sortBy: e.target.value,\r\n                        }))\r\n                      }\r\n                      className=\"p-2 border rounded text-sm bg-white\"\r\n                      title=\"Sort by\"\r\n                    >\r\n                      <option value=\"relevance\">Relevance</option>\r\n                      <option value=\"price\">Price â†‘</option>\r\n                      <option value=\"distance\">Distance â†‘</option>\r\n                      <option value=\"stars\">Stars â†“</option>\r\n                    </select>\r\n                  </div>\r\n\r\n                  <button\r\n                    onClick={() => setManagerOpen(true)}\r\n                    className=\"ml-2 px-2 py-1 border rounded text-sm bg-white\"\r\n                    type=\"button\"\r\n                  >\r\n                    Add\r\n                  </button>\r\n                </div>\r\n\r\n                {/* dropdown results */}\r\n                {madinahShowList && filteredMadinah.length > 0 && (\r\n                  <div className=\"absolute left-4 right-4 mt-16 bg-white border rounded max-h-64 overflow-auto shadow z-30 md:left-0 md:right-auto md:min-w-[450px]\">\r\n                    {filteredMadinah.map((h, index) => (\r\n                      <button\r\n                        key={h.id || index}\r\n                        id={`madinah-item-${index}`}\r\n                        type=\"button\"\r\n                        onClick={() => {\r\n                          setMadinah((s) => ({\r\n                            ...s,\r\n                            name: h.name,\r\n                            pricePerNight: h.pricePerNight,\r\n                          }));\r\n                          setMadinahQuery(\r\n                            `${h.name} â€” ${h.stars}â˜… â€” ${h.distance} â€” SAR ${h.pricePerNight}`\r\n                          );\r\n                          setMadinahShowList(false);\r\n                          setMadinahFocus(-1);\r\n                        }}\r\n                        onMouseEnter={() => setMadinahFocus(index)}\r\n                        className={`w-full text-left px-3 py-2 flex items-start gap-3 ${\r\n                          index === madinahFocus\r\n                            ? \"bg-indigo-50\"\r\n                            : \"hover:bg-gray-50\"\r\n                        }`}\r\n                      >\r\n                        <div className=\"flex-1\">\r\n                          <div className=\"font-medium text-sm\">{h.name}</div>\r\n                          <div className=\"text-xs text-gray-500\">\r\n                            {h.stars}â˜… â€” {h.distance} â€” SAR {h.pricePerNight}\r\n                          </div>\r\n                        </div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <HotelCard title=\"\" hotel={madinah} setHotel={setMadinah} />\r\n            </div>\r\n          </aside>\r\n\r\n          {/* RIGHT PANEL */}\r\n          <div className=\"lg:col-span-6 space-y-4\">\r\n            <TicketsVisa\r\n              pax={pax}\r\n              setPax={setPax}\r\n              ticketPrice={ticketPrice}\r\n              setTicketPrice={setTicketPrice}\r\n              ticketCurrency={ticketCurrency}\r\n              setTicketCurrency={setTicketCurrency}\r\n              defaultVisaSAR={defaultVisaSAR}\r\n              setDefaultVisaSAR={setDefaultVisaSAR}\r\n              transportTotal={transportTotal}\r\n              setTransportTotal={setTransportTotal}\r\n              rates={rates}\r\n              setRates={setRates}\r\n              profit={profit}\r\n              setProfit={setProfit}\r\n              profitCurrency={profitCurrency}\r\n              setProfitCurrency={setProfitCurrency}\r\n              selectedAirline={selectedAirline}\r\n              setSelectedAirline={setSelectedAirline}\r\n              vehicle={vehicle}\r\n              setVehicle={setVehicle}\r\n            />\r\n\r\n            <Summary\r\n              perPersonTotalSAR={perPersonTotalSAR}\r\n              totalSAR={totalSAR}\r\n              totalPKR={totalPKR}\r\n              totalUSD={totalUSD}\r\n              pax={pax}\r\n              savePackage={savePackage}\r\n            />\r\n\r\n            <SavedPackages packages={packages} setPackages={setPackages} />\r\n          </div>\r\n        </div>\r\n      </main>\r\n\r\n      <Footer />\r\n\r\n      {/* HOTEL MANAGER MODAL */}\r\n      <HotelManager\r\n        open={managerOpen}\r\n        setOpen={setManagerOpen}\r\n        makkahList={makkahList}\r\n        madinahList={madinahList}\r\n        refreshMakkah={loadLists}\r\n        refreshMadinah={loadLists}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}