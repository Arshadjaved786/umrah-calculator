{"ast":null,"code":"// src/services/pdfService.js\n// High-quality single-page A4 PDF exporter using html2canvas + jsPDF.\n// Produces PNG (lossless) image embed and can return Blob instead of auto-save.\n\nimport jsPDF from \"jspdf\";\nimport html2canvas from \"html2canvas\";\n\n/**\r\n * exportPdf\r\n * Renders element to a single A4 page, high quality.\r\n *\r\n * options:\r\n *  - format: 'a4' (default)\r\n *  - unit: 'mm' (default)\r\n *  - orientation: 'portrait'|'landscape' (default 'portrait')\r\n *  - margin: number mm (default 8)\r\n *  - scale: html2canvas scale (default 3) — increase for sharper images (costs memory/time)\r\n *  - backgroundColor: canvas background (default '#ffffff')\r\n *  - imageType: 'png'|'jpeg' (default 'png')\r\n *  - imageQuality: number 0..1 (jpeg only)\r\n *  - skipSave: boolean (if true, don't call pdf.save; return Blob)\r\n *  - returnBlob: boolean (alias for skipSave)\r\n *\r\n * Returns:\r\n *  - If skipSave/returnBlob true => resolves to PDF Blob\r\n *  - Otherwise resolves to true (after saving file)\r\n */\nexport async function exportPdf(element, fileName = \"document.pdf\", options = {}) {\n  if (!element) throw new Error(\"exportPdf: element is required\");\n  const {\n    format = \"a4\",\n    unit = \"mm\",\n    orientation = \"portrait\",\n    margin = 8,\n    scale = 3,\n    backgroundColor = \"#ffffff\",\n    imageType = \"png\",\n    imageQuality = 0.95,\n    skipSave = false,\n    returnBlob = false\n  } = options || {};\n\n  // Create PDF\n  const pdf = new jsPDF({\n    unit,\n    format,\n    orientation\n  });\n\n  // Page size in mm\n  const pageWidthMm = pdf.internal.pageSize.getWidth();\n  const pageHeightMm = pdf.internal.pageSize.getHeight();\n\n  // Render element with html2canvas\n  const canvas = await html2canvas(element, {\n    scale: scale,\n    backgroundColor: backgroundColor,\n    useCORS: true,\n    logging: false,\n    // ⭐⭐ ROOT FIX ⭐⭐\n    onclone: clonedDoc => {\n      // PDF ke liye gradient-text ko normal text bana do\n      clonedDoc.querySelectorAll(\".bg-clip-text\").forEach(el => {\n        el.classList.remove(\"bg-clip-text\", \"text-transparent\");\n        el.style.color = \"#6d28d9\"; // purple-700\n\n        el.style.background = \"none\";\n      });\n    }\n  });\n\n  // Prefer PNG for lossless quality; JPEG only if explicitly requested\n  const outType = (imageType || \"png\").toLowerCase();\n  const mime = outType === \"jpeg\" || outType === \"jpg\" ? \"image/jpeg\" : \"image/png\";\n  const dataUrl = mime === \"image/png\" ? canvas.toDataURL(\"image/png\") : canvas.toDataURL(\"image/jpeg\", imageQuality);\n  const imgWidthPx = canvas.width;\n  const imgHeightPx = canvas.height;\n\n  // Convert page inner area (minus margins) to px (approx 96 DPI)\n  const innerWidthMm = pageWidthMm - 2 * margin;\n  const innerHeightMm = pageHeightMm - 2 * margin;\n  const pageWidthPx = Math.round(innerWidthMm * 96 / 25.4);\n  const pageHeightPx = Math.round(innerHeightMm * 96 / 25.4);\n\n  // Compute scale to fit entire canvas into one page\n  const finalScale = Math.min(pageWidthPx / imgWidthPx, 1);\n\n  // Calculate final dimensions in mm for pdf.addImage\n  const finalWidthMm = imgWidthPx * finalScale * 25.4 / 96;\n  const finalHeightMm = imgHeightPx * finalScale * 25.4 / 96;\n\n  // center horizontally, top margin for vertical centering optional (we keep top margin)\n  const x = margin;\n  const y = margin + Math.max(0, (innerHeightMm - finalHeightMm) / 6); // small top offset for balance\n\n  // Add image to PDF\n  // jsPDF supports 'PNG' and 'JPEG'\n  pdf.addImage(dataUrl, mime === \"image/png\" ? \"PNG\" : \"JPEG\", x, y, finalWidthMm, finalHeightMm);\n\n  // If user requested Blob back (for opening in new tab / print), return Blob\n  if (skipSave || returnBlob) {\n    // return Blob for further handling\n    const blob = pdf.output(\"blob\");\n    return blob;\n  }\n\n  // Otherwise save file and return true\n  pdf.save(fileName);\n  return true;\n}\nexport default {\n  exportPdf\n};","map":{"version":3,"names":["jsPDF","html2canvas","exportPdf","element","fileName","options","Error","format","unit","orientation","margin","scale","backgroundColor","imageType","imageQuality","skipSave","returnBlob","pdf","pageWidthMm","internal","pageSize","getWidth","pageHeightMm","getHeight","canvas","useCORS","logging","onclone","clonedDoc","querySelectorAll","forEach","el","classList","remove","style","color","background","outType","toLowerCase","mime","dataUrl","toDataURL","imgWidthPx","width","imgHeightPx","height","innerWidthMm","innerHeightMm","pageWidthPx","Math","round","pageHeightPx","finalScale","min","finalWidthMm","finalHeightMm","x","y","max","addImage","blob","output","save"],"sources":["C:/Users/Taj Tech/Downloads/umrah-calculator/src/services/pdfService.js"],"sourcesContent":["// src/services/pdfService.js\r\n// High-quality single-page A4 PDF exporter using html2canvas + jsPDF.\r\n// Produces PNG (lossless) image embed and can return Blob instead of auto-save.\r\n\r\nimport jsPDF from \"jspdf\";\r\nimport html2canvas from \"html2canvas\";\r\n\r\n/**\r\n * exportPdf\r\n * Renders element to a single A4 page, high quality.\r\n *\r\n * options:\r\n *  - format: 'a4' (default)\r\n *  - unit: 'mm' (default)\r\n *  - orientation: 'portrait'|'landscape' (default 'portrait')\r\n *  - margin: number mm (default 8)\r\n *  - scale: html2canvas scale (default 3) — increase for sharper images (costs memory/time)\r\n *  - backgroundColor: canvas background (default '#ffffff')\r\n *  - imageType: 'png'|'jpeg' (default 'png')\r\n *  - imageQuality: number 0..1 (jpeg only)\r\n *  - skipSave: boolean (if true, don't call pdf.save; return Blob)\r\n *  - returnBlob: boolean (alias for skipSave)\r\n *\r\n * Returns:\r\n *  - If skipSave/returnBlob true => resolves to PDF Blob\r\n *  - Otherwise resolves to true (after saving file)\r\n */\r\nexport async function exportPdf(\r\n  element,\r\n  fileName = \"document.pdf\",\r\n  options = {}\r\n) {\r\n  if (!element) throw new Error(\"exportPdf: element is required\");\r\n\r\n  const {\r\n    format = \"a4\",\r\n    unit = \"mm\",\r\n    orientation = \"portrait\",\r\n    margin = 8,\r\n    scale = 3,\r\n    backgroundColor = \"#ffffff\",\r\n    imageType = \"png\",\r\n    imageQuality = 0.95,\r\n    skipSave = false,\r\n    returnBlob = false,\r\n  } = options || {};\r\n\r\n  // Create PDF\r\n  const pdf = new jsPDF({ unit, format, orientation });\r\n\r\n  // Page size in mm\r\n  const pageWidthMm = pdf.internal.pageSize.getWidth();\r\n  const pageHeightMm = pdf.internal.pageSize.getHeight();\r\n\r\n  // Render element with html2canvas\r\n  const canvas = await html2canvas(element, {\r\n    scale: scale,\r\n    backgroundColor: backgroundColor,\r\n    useCORS: true,\r\n    logging: false,\r\n\r\n    // ⭐⭐ ROOT FIX ⭐⭐\r\n    onclone: (clonedDoc) => {\r\n      // PDF ke liye gradient-text ko normal text bana do\r\n      clonedDoc.querySelectorAll(\".bg-clip-text\").forEach((el) => {\r\n        el.classList.remove(\"bg-clip-text\", \"text-transparent\");\r\n        el.style.color = \"#6d28d9\"; // purple-700\r\n\r\n        el.style.background = \"none\";\r\n      });\r\n    },\r\n  });\r\n\r\n  // Prefer PNG for lossless quality; JPEG only if explicitly requested\r\n  const outType = (imageType || \"png\").toLowerCase();\r\n  const mime =\r\n    outType === \"jpeg\" || outType === \"jpg\" ? \"image/jpeg\" : \"image/png\";\r\n  const dataUrl =\r\n    mime === \"image/png\"\r\n      ? canvas.toDataURL(\"image/png\")\r\n      : canvas.toDataURL(\"image/jpeg\", imageQuality);\r\n\r\n  const imgWidthPx = canvas.width;\r\n  const imgHeightPx = canvas.height;\r\n\r\n  // Convert page inner area (minus margins) to px (approx 96 DPI)\r\n  const innerWidthMm = pageWidthMm - 2 * margin;\r\n  const innerHeightMm = pageHeightMm - 2 * margin;\r\n  const pageWidthPx = Math.round((innerWidthMm * 96) / 25.4);\r\n  const pageHeightPx = Math.round((innerHeightMm * 96) / 25.4);\r\n\r\n  // Compute scale to fit entire canvas into one page\r\n  const finalScale = Math.min(pageWidthPx / imgWidthPx, 1);\r\n\r\n  // Calculate final dimensions in mm for pdf.addImage\r\n  const finalWidthMm = (imgWidthPx * finalScale * 25.4) / 96;\r\n  const finalHeightMm = (imgHeightPx * finalScale * 25.4) / 96;\r\n\r\n  // center horizontally, top margin for vertical centering optional (we keep top margin)\r\n  const x = margin;\r\n\r\n  const y = margin + Math.max(0, (innerHeightMm - finalHeightMm) / 6); // small top offset for balance\r\n\r\n  // Add image to PDF\r\n  // jsPDF supports 'PNG' and 'JPEG'\r\n  pdf.addImage(\r\n    dataUrl,\r\n    mime === \"image/png\" ? \"PNG\" : \"JPEG\",\r\n    x,\r\n    y,\r\n    finalWidthMm,\r\n    finalHeightMm\r\n  );\r\n\r\n  // If user requested Blob back (for opening in new tab / print), return Blob\r\n  if (skipSave || returnBlob) {\r\n    // return Blob for further handling\r\n    const blob = pdf.output(\"blob\");\r\n    return blob;\r\n  }\r\n\r\n  // Otherwise save file and return true\r\n  pdf.save(fileName);\r\n  return true;\r\n}\r\n\r\nexport default {\r\n  exportPdf,\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}